<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Basics of Linear Algebra for Machine Learning学习记录, JackHCC">
    <meta name="description" content="机器学习数学基础学习记录">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Basics of Linear Algebra for Machine Learning学习记录 | JackHCC</title>
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/favicon.png">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/css/matery.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/css/my.css">
    
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/jquery/jquery.min.js"></script>
    
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="JackHCC" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-hopscotch.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/me.jpg" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">JackHCC</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Tools</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="https://creativecc.cn/" target="_blank" rel="noopener">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Creative工具导航</span>
        </a>
      </li>
      
      <li>
        <a href="https://blog.creativecc.cn/Arxiv-NLP-Reporter/" target="_blank" rel="noopener">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>NLP每日论文</span>
        </a>
      </li>
      
      <li>
        <a href="http://chat.creativecc.cn/" target="_blank" rel="noopener">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>RocketChat聊天室</span>
        </a>
      </li>
      
      <li>
        <a href="/contact">
          
          <i class="fas fa-comments" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Contact留言板</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/me.jpg" class="logo-img circle responsive-img">
        
        <div class="logo-name">JackHCC</div>
        <div class="logo-desc">
            
            Make the world betterrrr!!!
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			Tools
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="https://creativecc.cn/ " target="_blank" rel="noopener" style="margin-left:75px";>
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>Creative工具导航</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="https://blog.creativecc.cn/Arxiv-NLP-Reporter/ " target="_blank" rel="noopener" style="margin-left:75px";>
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>NLP每日论文</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="http://chat.creativecc.cn/ " target="_blank" rel="noopener" style="margin-left:75px";>
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>RocketChat聊天室</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/contact " style="margin-left:75px";>
				  
				   <i class="fa fas fa-comments" style="position: absolute;left:50px" ></i>
			      
		          <span>Contact留言板</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/JackHCC/JackHCC.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/JackHCC/JackHCC.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/featureimages/6.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Basics of Linear Algebra for Machine Learning学习记录</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 30px;
        bottom: 146px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Machine-Learning/">
                                <span class="chip bg-color">Machine Learning</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Machine-Learning/" class="post-category">
                                Machine Learning
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-03-04
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2022-04-22
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    7.5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    37 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>

        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="《Basics-of-Linear-Algebra-for-Machine-Learning》"><a href="#《Basics-of-Linear-Algebra-for-Machine-Learning》" class="headerlink" title="《Basics of Linear Algebra for Machine Learning》"></a>《Basics of Linear Algebra for Machine Learning》</h1><p>姓名：胡成成        学号：2101210578        题目：《Basics of Linear Algebra for Machine Learning》学习报告（笔记）</p>
<hr>
<p>本次学习内容为Jason Brownlee写的《Basics of Linear Algebra for Machine Learning》，主要包括机器学习底层的数学原理，线性代数在机器学习中的应用。全书共19个章节（不包括附录），每一节并不长。所有章节一共分为Foundations，Numpy，Matrices，Factorization，Statistic这五大板块展开介绍。</p>
<ul>
<li>第一部分：基础。了解线性代数以及它与机器学习领域的关系。它与机器学习领域的关系。</li>
<li>第二部分：NumPy。发现NumPy教程，告诉你如何创建、索引、切分。和重塑NumPy数组，这是机器学习中使用的主要数据结构，也是本文中线性代数例子的基础。本书中线性代数例子的基础。</li>
<li>第三部分：矩阵。发现在线性代数中保存和操作数据的关键结构。向量、矩阵和张量的线性代数的关键结构。</li>
<li>第四部分：因式分解。发现一套将矩阵分解成其组成元素，以使数字运算更有效和更稳定。</li>
<li>第五部分：统计学。通过线性代数及其在主成分分析和线性回归中的应用，发现统计学。</li>
</ul>
<p>本书主要对将老师推荐的数目中比较基础的一本进行深入学习，记录关键要点的笔记，旨在通过该书打好机器学习深度学习的基础。</p>
<h2 id="Foundations"><a href="#Foundations" class="headerlink" title="Foundations"></a>Foundations</h2><h3 id="1-Introduction-to-Linear-Algebra"><a href="#1-Introduction-to-Linear-Algebra" class="headerlink" title="1. Introduction to Linear Algebra"></a>1. Introduction to Linear Algebra</h3><p>线性代数是一个数学领域，被普遍认为是深入理解机器学习的前提条件。深入理解机器学习的前提。虽然线性代数是一个很大的领域，有许多深奥的理论和发现，但是从线性代数中获得的一些工具和符号是非常重要的，从这个领域中获得的核心工具和符号对机器学习从业者来说是很实用的。对机器学习从业者来说是很实用的。有了关于线性代数的坚实基础，就有可能把注意力集中在线性代数上。</p>
<h3 id="2-Linear-Algebra-and-Machine-Learning"><a href="#2-Linear-Algebra-and-Machine-Learning" class="headerlink" title="2. Linear Algebra and Machine Learning"></a>2. Linear Algebra and Machine Learning</h3><p>本章节作者主要分析了不学习线性代数和学习线性代数的原因。</p>
<h3 id="3-Examples-of-Linear-Algebra-in-Machine-Learning"><a href="#3-Examples-of-Linear-Algebra-in-Machine-Learning" class="headerlink" title="3. Examples of Linear Algebra in Machine Learning"></a>3. Examples of Linear Algebra in Machine Learning</h3><p>本章节主要是具体线性代数在机器学习领域内的具体应用，包括：</p>
<ul>
<li>Dataset and Data Files</li>
<li>Images and Photographs</li>
<li>One Hot Encoding</li>
<li>Linear Regression</li>
<li>Regularization</li>
<li>Principal Component Analysis</li>
<li>Singular-Value Decomposition</li>
<li>Latent Semantic Analysis</li>
<li>Recommender Systems</li>
<li>Deep Learning</li>
</ul>
<h2 id="Numpy"><a href="#Numpy" class="headerlink" title="Numpy"></a>Numpy</h2><h3 id="4-Introduction-to-NumPy-Arrays"><a href="#4-Introduction-to-NumPy-Arrays" class="headerlink" title="4. Introduction to NumPy Arrays"></a>4. Introduction to NumPy Arrays</h3><p>数组是机器学习中使用的主要数据结构。在Python中，来自NumPy库的数组，称为N维数组或ndarray，被作为主要的数据结构用于代表数据。</p>
<h4 id="NumPy-N-dimensional-Array"><a href="#NumPy-N-dimensional-Array" class="headerlink" title="NumPy N-dimensional Array"></a>NumPy N-dimensional Array</h4><ul>
<li>Numpy基本用法：</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># create array</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># create array</span>
l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">]</span>
a <span class="token operator">=</span> array<span class="token punctuation">(</span>l<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># display array</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># display array shape</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># display array data type</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>dtype<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[ 1. 2. 3.]
(3,)
float64</code></pre><h4 id="Functions-to-Create-Arrays"><a href="#Functions-to-Create-Arrays" class="headerlink" title="Functions to Create Arrays"></a>Functions to Create Arrays</h4><ul>
<li>empty()函数将创建一个指定形状的新数组。该函数的参数是一个数组或元组，指定要创建的数组的每个维度的长度。</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># create empty array</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> empty
a <span class="token operator">=</span> empty<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>zeros()创建指定大小的全0数组</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python">a <span class="token operator">=</span> zeros<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>ones()创建指定大小的全1数组</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python">a <span class="token operator">=</span> ones<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="Combining-Arrays"><a href="#Combining-Arrays" class="headerlink" title="Combining Arrays"></a>Combining Arrays</h4><ul>
<li>Vertical Stack：纵向堆叠数组</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># create array with vstack</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> vstack
<span class="token comment" spellcheck="true"># create first array</span>
a1 <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># create second array</span>
a2 <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a2<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># vertical stack</span>
a3 <span class="token operator">=</span> vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a3<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a3<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3]
[4 5 6]
[[1 2 3]
[4 5 6]]
(2, 3)</code></pre><ul>
<li>Horizontal Stack：横向堆叠数组</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># create array with hstack</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> hstack
<span class="token comment" spellcheck="true"># create first array</span>
a1 <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># create second array</span>
a2 <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a2<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># create horizontal stack</span>
a3 <span class="token operator">=</span> hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a3<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a3<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3]
[4 5 6]
[1 2 3 4 5 6]
(6,)</code></pre><h3 id="5-Index-Slice-and-Reshape-NumPy-Arrays"><a href="#5-Index-Slice-and-Reshape-NumPy-Arrays" class="headerlink" title="5. Index, Slice and Reshape NumPy Arrays"></a>5. Index, Slice and Reshape NumPy Arrays</h3><h4 id="From-List-to-Arrays"><a href="#From-List-to-Arrays" class="headerlink" title="From List to Arrays"></a>From List to Arrays</h4><ul>
<li>array() ：将list变成array数组</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># create two-dimensional array</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># list of data</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment" spellcheck="true"># array of data</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>type<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="Array-Indexing"><a href="#Array-Indexing" class="headerlink" title="Array Indexing"></a>Array Indexing</h4><ul>
<li>索引数组：</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># index two-dimensional array</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># define array</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># index data</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注：索引数组有两种方式：<code>data[0,0]</code>或<code>data[0][0]</code></p>
<h4 id="Array-Slicing"><a href="#Array-Slicing" class="headerlink" title="Array Slicing"></a>Array Slicing</h4><ul>
<li>data[from:to]：数组切片</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># split train and test data</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># define array</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># separate data</span>
split <span class="token operator">=</span> <span class="token number">2</span>
train<span class="token punctuation">,</span>test <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span>split<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span>split<span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>train<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="Array-Reshaping"><a href="#Array-Reshaping" class="headerlink" title="Array Reshaping"></a>Array Reshaping</h4><ul>
<li>shape属性</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># shape of a two-dimensional array</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># list of data</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment" spellcheck="true"># array of data</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>Reshape</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># reshape 2D array to 3D</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># list of data</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment" spellcheck="true"># array of data</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># reshape</span>
data <span class="token operator">=</span> data<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="6-NumPy-Array-Broadcasting"><a href="#6-NumPy-Array-Broadcasting" class="headerlink" title="6. NumPy Array Broadcasting"></a>6. NumPy Array Broadcasting</h3><p>不同大小的数组不能进行加减运算，一般也不能用于算术。解决这个问题的方法是复制较小的数组，使其具有与大数组相同的维度和大小。大小的数组。这被称为数组广播，在NumPy中执行数组运算时可以使用，这可以大大减少和简化你的代码。</p>
<h4 id="Scalar-and-One-Dimensional-Array"><a href="#Scalar-and-One-Dimensional-Array" class="headerlink" title="Scalar and One-Dimensional Array"></a>Scalar and One-Dimensional Array</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># broadcast scalar to one-dimensional array</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># define array</span>
a <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># define scalar</span>
b <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># broadcast</span>
c <span class="token operator">=</span> a <span class="token operator">+</span> b
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3]
2
[3 4 5]</code></pre><h4 id="One-Dimensional-and-Two-Dimensional-Arrays"><a href="#One-Dimensional-and-Two-Dimensional-Arrays" class="headerlink" title="One-Dimensional and Two-Dimensional Arrays"></a>One-Dimensional and Two-Dimensional Arrays</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># broadcast one-dimensional array to two-dimensional array</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># define two-dimensional array</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># define one-dimensional array</span>
b <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># broadcast</span>
C <span class="token operator">=</span> A <span class="token operator">+</span> b
<span class="token keyword">print</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3]
[1 2 3]]
[1 2 3]
[[2 4 6]
[2 4 6]]</code></pre><h2 id="Matrices"><a href="#Matrices" class="headerlink" title="Matrices"></a>Matrices</h2><h3 id="7-Vectors-and-Vector-Arithmetic"><a href="#7-Vectors-and-Vector-Arithmetic" class="headerlink" title="7. Vectors and Vector Arithmetic"></a>7. Vectors and Vector Arithmetic</h3><p>向量是线性代数的一个基础元素。在整个机器学习领域，矢量被用于描述算法和过程，如目标变量（y）。在描述算法和过程时使用，如训练算法时的目标变量（y）。当训练一个算法时。</p>
<h4 id="Defining-a-Vector"><a href="#Defining-a-Vector" class="headerlink" title="Defining a Vector"></a>Defining a Vector</h4><pre><code># create a vector
from numpy import array
# define vector
v = array([1, 2, 3])
print(v)</code></pre><h4 id="Vector-Arithmetic"><a href="#Vector-Arithmetic" class="headerlink" title="Vector Arithmetic"></a>Vector Arithmetic</h4><p>要求两个参与运算的矩阵维度一致或满足广播条件</p>
<ul>
<li>Addition</li>
<li>Subtraction</li>
<li>Multiplication：注意这里的乘法是对应位置元素相乘，注意区分内积</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># vector multiplication</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># define first vector</span>
a <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># define second vector</span>
b <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># multiply vectors</span>
c <span class="token operator">=</span> a <span class="token operator">*</span> b<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3]
[1 2 3]
[1 4 9]</code></pre><ul>
<li>Division</li>
</ul>
<h4 id="Vector-Dot-Product"><a href="#Vector-Dot-Product" class="headerlink" title="Vector Dot Product"></a>Vector Dot Product</h4><ul>
<li>矩阵点积，又称矩阵内积</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># vector dot product</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># define first vector</span>
a <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># define second vector</span>
b <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># multiply vectors</span>
c <span class="token operator">=</span> a<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3]
[1 2 3]
14</code></pre><h4 id="Vector-Scalar-Multiplication"><a href="#Vector-Scalar-Multiplication" class="headerlink" title="Vector-Scalar Multiplication"></a>Vector-Scalar Multiplication</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># vector-scalar multiplication</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># define vector</span>
a <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># define scalar</span>
s <span class="token operator">=</span> <span class="token number">0.5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># multiplication</span>
c <span class="token operator">=</span> s <span class="token operator">*</span> a
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="8-Vector-Norms"><a href="#8-Vector-Norms" class="headerlink" title="8. Vector Norms"></a>8. Vector Norms</h3><p>计算向量的长度或大小通常需要直接作为机器学习中的正则化方法，或者作为更广泛的向量或矩阵运算的一部分</p>
<ul>
<li>L1 Norm</li>
<li>L2 Norm</li>
<li>Max Norm</li>
</ul>
<h4 id="Vector-L1-Norm"><a href="#Vector-L1-Norm" class="headerlink" title="Vector L1 Norm"></a>Vector L1 Norm</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># vector L1 norm</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> norm
<span class="token comment" spellcheck="true"># define vector</span>
a <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate norm</span>
l1 <span class="token operator">=</span> norm<span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>l1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3]
6.0</code></pre><h4 id="Vector-L2-Norm"><a href="#Vector-L2-Norm" class="headerlink" title="Vector L2 Norm"></a>Vector L2 Norm</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># vector L2 norm</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> norm
<span class="token comment" spellcheck="true"># define vector</span>
a <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate norm</span>
l2 <span class="token operator">=</span> norm<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>l2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3]
3.74165738677</code></pre><h4 id="Vector-Max-Norm"><a href="#Vector-Max-Norm" class="headerlink" title="Vector Max Norm"></a>Vector Max Norm</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># vector max norm</span>
<span class="token keyword">from</span> math <span class="token keyword">import</span> inf
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> norm
<span class="token comment" spellcheck="true"># define vector</span>
a <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate norm</span>
maxnorm <span class="token operator">=</span> norm<span class="token punctuation">(</span>a<span class="token punctuation">,</span> inf<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>maxnorm<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3]
3.0</code></pre><ul>
<li>本章节主要是如何使用Numpy计算常见的矩阵范式</li>
</ul>
<h3 id="9-Matrices-and-Matrix-Arithmetic"><a href="#9-Matrices-and-Matrix-Arithmetic" class="headerlink" title="9. Matrices and Matrix Arithmetic"></a>9. Matrices and Matrix Arithmetic</h3><p>矩阵是线性代数的一个基础元素。矩阵在整个机器学习领域被用于描述算法和过程，如输入数据变量。在描述算法和过程时使用矩阵，如训练算法时的输入数据变量 (X)训练算法时。</p>
<h4 id="Defining-a-Matrix"><a href="#Defining-a-Matrix" class="headerlink" title="Defining a Matrix"></a>Defining a Matrix</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># create matrix</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="Matrix-Arithmetic"><a href="#Matrix-Arithmetic" class="headerlink" title="Matrix Arithmetic"></a>Matrix Arithmetic</h4><p>矩阵的算数运算和向量一样，只不过从一维上升到二维及以上</p>
<h4 id="Matrix-Matrix-Multiplication"><a href="#Matrix-Matrix-Multiplication" class="headerlink" title="Matrix-Matrix Multiplication"></a>Matrix-Matrix Multiplication</h4><ul>
<li>矩阵乘法</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># matrix dot product</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># define first matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># define second matrix</span>
B <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># multiply matrices</span>
C <span class="token operator">=</span> A<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>B<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># multiply matrices with @ operator</span>
D <span class="token operator">=</span> A @ B
<span class="token keyword">print</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>注：“@”符号也可以表示点乘</strong></p>
<h4 id="Matrix-Scalar-Multiplication"><a href="#Matrix-Scalar-Multiplication" class="headerlink" title="Matrix-Scalar Multiplication"></a>Matrix-Scalar Multiplication</h4><p>同向量一致</p>
<h3 id="10-Types-of-Matrices"><a href="#10-Types-of-Matrices" class="headerlink" title="10. Types of Matrices"></a>10. Types of Matrices</h3><ul>
<li>Square Matrix </li>
<li>Symmetric Matrix </li>
<li>Triangular Matrix </li>
<li>Diagonal Matrix </li>
<li>Identity Matrix </li>
<li>Orthogonal Matrix</li>
</ul>
<h4 id="Square-Matrix"><a href="#Square-Matrix" class="headerlink" title="Square Matrix"></a>Square Matrix</h4><ul>
<li>方阵：正方形矩阵是一个行数(n)与列数(m)相等的矩阵。</li>
</ul>
<h4 id="Symmetric-Matrix"><a href="#Symmetric-Matrix" class="headerlink" title="Symmetric Matrix"></a>Symmetric Matrix</h4><ul>
<li>对称矩阵：矩阵等于矩阵的转置</li>
</ul>
<h4 id="Triangular-Matrix"><a href="#Triangular-Matrix" class="headerlink" title="Triangular Matrix"></a>Triangular Matrix</h4><ul>
<li>三角矩阵</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># triangular matrices</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> tril
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> triu
<span class="token comment" spellcheck="true"># define square matrix</span>
M <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># lower triangular matrix</span>
lower <span class="token operator">=</span> tril<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>lower<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># upper triangular matrix</span>
upper <span class="token operator">=</span> triu<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>upper<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3]
[1 2 3]
[1 2 3]]

[[1 0 0]
[1 2 0]
[1 2 3]]

[[1 2 3]
[0 2 3]
[0 0 3]]</code></pre><h4 id="Diagonal-Matrix"><a href="#Diagonal-Matrix" class="headerlink" title="Diagonal Matrix"></a>Diagonal Matrix</h4><ul>
<li>对角阵</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># diagonal matrix</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> diag
<span class="token comment" spellcheck="true"># define square matrix</span>
M <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># extract diagonal vector</span>
d <span class="token operator">=</span> diag<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># create diagonal matrix from vector</span>
D <span class="token operator">=</span> diag<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3]
[1 2 3]
[1 2 3]]

[1 2 3]

[[1 0 0]
[0 2 0]
[0 0 3]]</code></pre><h4 id="Identity-Matrix"><a href="#Identity-Matrix" class="headerlink" title="Identity Matrix"></a>Identity Matrix</h4><ul>
<li>单位矩阵</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># identity matrix</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> identity
I <span class="token operator">=</span> identity<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[ 1. 0. 0.]
[ 0. 1. 0.]
[ 0. 0. 1.]]</code></pre><h4 id="Orthogonal-Matrix"><a href="#Orthogonal-Matrix" class="headerlink" title="Orthogonal Matrix"></a>Orthogonal Matrix</h4><ul>
<li>正交矩阵：当两个向量的点积等于零时，它们就是正交的。<strong>矩阵的转置等于矩阵的逆</strong></li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># orthogonal matrix</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> inv
<span class="token comment" spellcheck="true"># define orthogonal matrix</span>
Q <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># inverse equivalence</span>
V <span class="token operator">=</span> inv<span class="token punctuation">(</span>Q<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Q<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># identity equivalence</span>
I <span class="token operator">=</span> Q<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Q<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[ 1 0]
[ 0 -1]]

[[ 1 0]
[ 0 -1]]

[[ 1. 0.]
[-0. -1.]]

[[1 0]
[0 1]]</code></pre><h3 id="11-Matrix-Operations"><a href="#11-Matrix-Operations" class="headerlink" title="11. Matrix Operations"></a>11. Matrix Operations</h3><ul>
<li>转置Transpose</li>
<li>逆Inverse</li>
<li>迹Trace</li>
<li>行列式Determinant</li>
<li>秩Rank</li>
</ul>
<h4 id="Transpose"><a href="#Transpose" class="headerlink" title="Transpose"></a>Transpose</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># transpose matrix</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate transpose</span>
C <span class="token operator">=</span> A<span class="token punctuation">.</span>T
<span class="token keyword">print</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="Inverse"><a href="#Inverse" class="headerlink" title="Inverse"></a>Inverse</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># invert matrix</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> inv
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># invert matrix</span>
B <span class="token operator">=</span> inv<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># multiply A and B</span>
I <span class="token operator">=</span> A<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>B<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="Trace"><a href="#Trace" class="headerlink" title="Trace"></a>Trace</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># matrix trace</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> trace
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate trace</span>
B <span class="token operator">=</span> trace<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3]
[4 5 6]
[7 8 9]]

15</code></pre><h4 id="Determinant"><a href="#Determinant" class="headerlink" title="Determinant"></a>Determinant</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># matrix determinant</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> det
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate determinant</span>
B <span class="token operator">=</span> det<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3]
[4 5 6]
[7 8 9]]

-9.51619735393e-16</code></pre><h4 id="Rank"><a href="#Rank" class="headerlink" title="Rank"></a>Rank</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># vector rank</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> matrix_rank
<span class="token comment" spellcheck="true"># rank</span>
v1 <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
vr1 <span class="token operator">=</span> matrix_rank<span class="token punctuation">(</span>v1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>vr1<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># zero rank</span>
v2 <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
vr2 <span class="token operator">=</span> matrix_rank<span class="token punctuation">(</span>v2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>vr2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3]
1

[0 0 0 0 0]
0</code></pre><h3 id="12-Sparse-Matrices"><a href="#12-Sparse-Matrices" class="headerlink" title="12. Sparse Matrices"></a>12. Sparse Matrices</h3><p>主要包含零值的矩阵称为稀疏矩阵，与大多数值为非零值的矩阵（称为稠密矩阵）不同。大型稀疏矩阵在一般情况下很常见，尤其是在应用机器学习中，例如在包含计数的数据中，在将类别映射到计数的数据编码中，甚至在机器学习的整个子领域中，例如在自然语言处理中。将稀疏矩阵当作稠密矩阵来表示和使用，计算成本很高，通过使用专门处理矩阵稀疏性的表示和操作，可以大大提高性能。</p>
<h4 id="Sparse-Matrix"><a href="#Sparse-Matrix" class="headerlink" title="Sparse Matrix"></a>Sparse Matrix</h4><p>矩阵的稀疏性可以用分数来量化，分数是矩阵中零值的数量除以矩阵中元素的总数。</p>
<p>稀疏矩阵即非零元素占比较少。</p>
<h4 id="Problems-with-Sparsity"><a href="#Problems-with-Sparsity" class="headerlink" title="Problems with Sparsity"></a>Problems with Sparsity</h4><ul>
<li><p>Space Complexity：非常大的矩阵需要大量的内存，而我们想要处理的一些非常大的矩阵是稀疏的。</p>
</li>
<li><p>Time Complexity：假设一个非常大的稀疏矩阵可以放入内存中，我们将希望对这个矩阵执行操作。简单地说，如果矩阵主要包含零值，即没有数据，则在该矩阵上执行操作可能需要很长时间，其中执行的大部分计算将涉及将零值相加或相乘。</p>
</li>
</ul>
<h4 id="Sparse-Matrices-in-Machine-Learning"><a href="#Sparse-Matrices-in-Machine-Learning" class="headerlink" title="Sparse Matrices in Machine Learning"></a>Sparse Matrices in Machine Learning</h4><ul>
<li><p>Data：</p>
<ul>
<li>用户是否观看了电影目录中的电影。</li>
<li>用户是否在产品目录中购买过产品。</li>
<li>计算歌曲目录中某一首歌的收听次数。</li>
</ul>
</li>
<li><p>Data Preparation</p>
<ul>
<li>独热编码，用于表示分类数据为稀疏的二进制向量。</li>
<li>计数编码，用于表示一个文件的词汇中的词频</li>
<li>TF-IDF编码，用于表示词汇中的归一化词频分数。</li>
</ul>
</li>
<li><p>Areas of Study</p>
<ul>
<li>用于处理文本文件的自然语言处理。</li>
<li>推荐系统，用于处理目录中的产品使用情况。</li>
<li>处理含有大量黑色像素的图像时的计算机视觉。</li>
</ul>
</li>
</ul>
<h4 id="Working-with-Sparse-Matrices"><a href="#Working-with-Sparse-Matrices" class="headerlink" title="Working with Sparse Matrices"></a>Working with Sparse Matrices</h4><ul>
<li><p>系稀疏矩阵的存储方式:</p>
<ul>
<li><p>键的字典。一个字典用于将行和列的索引映射到一个值。</p>
</li>
<li><p>列表的列表。矩阵的每一行都被存储为一个列表，每个子列表都包含了列索引和值。</p>
</li>
<li><p>坐标列表。一个图元的列表被存储，每个图元包含行索引，列索引和值。</p>
</li>
<li><p>压缩的稀疏行。稀疏矩阵用三个一维的数组来表示非零值、行的范围和列的索引。</p>
</li>
<li><p>压缩稀疏列。与压缩稀疏行的方法相同，除了列索引被压缩并在行索引之前先读取。</p>
</li>
</ul>
</li>
</ul>
<h4 id="Sparse-Matrices-in-Python"><a href="#Sparse-Matrices-in-Python" class="headerlink" title="Sparse Matrices in Python"></a>Sparse Matrices in Python</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># sparse matrix</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>sparse <span class="token keyword">import</span> csr_matrix
<span class="token comment" spellcheck="true"># create dense matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># convert to sparse matrix (CSR method)</span>
S <span class="token operator">=</span> csr_matrix<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># reconstruct dense matrix</span>
B <span class="token operator">=</span> S<span class="token punctuation">.</span>todense<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 0 0 1 0 0]
[0 0 2 0 0 1]
[0 0 0 2 0 0]]

(0, 0) 1
(0, 3) 1
(1, 2) 2
(1, 5) 1
(2, 3) 2

[[1 0 0 1 0 0]
[0 0 2 0 0 1]
[0 0 0 2 0 0]]</code></pre><p>$$sparsity = 1.0 - count_nonzero(A) / A.size$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># sparsity calculation</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> count_nonzero
<span class="token comment" spellcheck="true"># create dense matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate sparsity</span>
sparsity <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">-</span> count_nonzero<span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">/</span> A<span class="token punctuation">.</span>size
<span class="token keyword">print</span><span class="token punctuation">(</span>sparsity<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 0 0 1 0 0]
[0 0 2 0 0 1]
[0 0 0 2 0 0]]

0.7222222222222222</code></pre><h3 id="13-Tensors-and-Tensor-Arithmetic"><a href="#13-Tensors-and-Tensor-Arithmetic" class="headerlink" title="13. Tensors and Tensor Arithmetic"></a>13. Tensors and Tensor Arithmetic</h3><p>在深度学习中，经常会看到围绕张量的大量讨论是基础数据结构。Tensor甚至以谷歌旗舰机器学习库的名义出现：TensorFlow。张量是线性代数中使用的一种数据结构，与向量和矩阵，你可以用张量计算算术运算。</p>
<h4 id="What-are-Tensors"><a href="#What-are-Tensors" class="headerlink" title="What are Tensors"></a>What are Tensors</h4><p>矢量是一个一维或一阶张量，矩阵是一个二维或二阶张量。</p>
<p>Tensor：即高维向量</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># create tensor</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
T <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>T<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="Tensor-Arithmetic"><a href="#Tensor-Arithmetic" class="headerlink" title="Tensor Arithmetic"></a>Tensor Arithmetic</h4><p>同向量与矩阵四则运算类似。</p>
<h4 id="Tensor-Product"><a href="#Tensor-Product" class="headerlink" title="Tensor Product"></a>Tensor Product</h4><p><img src="/images/loading.gif" data-original="../images/ML/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NkNjUx,size_16,color_FFFFFF,t_70.png" alt=""></p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># tensor product</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> tensordot
<span class="token comment" spellcheck="true"># define first vector</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># define second vector</span>
B <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate tensor product</span>
C <span class="token operator">=</span> tensordot<span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> axes<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Factorization"><a href="#Factorization" class="headerlink" title="Factorization"></a>Factorization</h2><h3 id="14-Matrix-Decompositions"><a href="#14-Matrix-Decompositions" class="headerlink" title="14. Matrix Decompositions"></a>14. Matrix Decompositions</h3><p>许多复杂的矩阵运算不能用有限的计算机精度有效或稳定地求解。矩阵分解是将矩阵简化为组成部分的方法，使计算更复杂的矩阵运算更容易。矩阵分解方法，也称矩阵分解法，是计算机中线性代数的基础，甚至是用于求解线性方程组、求逆、求矩阵行列式等基本运算的基础。</p>
<h4 id="What-is-a-Matrix-Decomposition"><a href="#What-is-a-Matrix-Decomposition" class="headerlink" title="What is a Matrix Decomposition"></a>What is a Matrix Decomposition</h4><p>矩阵分解是将矩阵简化为其组成部分的一种方法。可以简化可在计算机上执行的更复杂的矩阵运算。分解矩阵，而不是原始矩阵本身。矩阵的一个常见类比是数字的因式分解，例如将10分解为2×5。</p>
<h4 id="LU-Decomposition"><a href="#LU-Decomposition" class="headerlink" title="LU Decomposition"></a>LU Decomposition</h4><p>LU分解适用于<strong>正方形矩阵</strong>，将矩阵分解为L和U两部分。<br>$$<br>A = L · U<br>$$<br>LU分解是使用迭代数值过程发现的，对于那些不能分解或不容易分解的矩阵，LU分解可能会失败。这种分解的一种变体在数值上更稳定，在实践中可以求解，这种变体被称为LUP分解，或带有部分枢轴的LU分解。<br>$$<br>A = L · U · P<br>$$<br>关于LUP分解的详细介绍，参考博客：<a href="https://www.qiujiawei.com/linear-algebra-3/" target="_blank" rel="noopener">线性代数之PLU分解</a></p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># LU decomposition</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> lu
<span class="token comment" spellcheck="true"># define a square matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
P<span class="token punctuation">,</span> L<span class="token punctuation">,</span> U <span class="token operator">=</span> lu<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>U<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># reconstruct</span>
B <span class="token operator">=</span> P<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>U<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3]
[4 5 6]
[7 8 9]]

[[ 0. 1. 0.]
[ 0. 0. 1.]
[ 1. 0. 0.]]

[[ 1. 0. 0. ]
[ 0.14285714 1. 0. ]
[ 0.57142857 0.5 1. ]]

[[ 7.00000000e+00 8.00000000e+00 9.00000000e+00]
[ 0.00000000e+00 8.57142857e-01 1.71428571e+00]
[ 0.00000000e+00 0.00000000e+00 -1.58603289e-16]]

[[ 1. 2. 3.]
[ 4. 5. 6.]
[ 7. 8. 9.]]</code></pre><h4 id="QR-Decomposition"><a href="#QR-Decomposition" class="headerlink" title="QR Decomposition"></a>QR Decomposition</h4><p>QR分解适用于n×m矩阵（不限于正方形矩阵），并将矩阵分解为Q和R两部分。<br>$$<br>A = Q · R<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># QR decomposition</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> qr
<span class="token comment" spellcheck="true"># define rectangular matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
Q<span class="token punctuation">,</span> R <span class="token operator">=</span> qr<span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token string">'complete'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Q<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># reconstruct</span>
B <span class="token operator">=</span> Q<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>R<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2]
[3 4]
[5 6]]

[[-0.16903085 0.89708523 0.40824829]
[-0.50709255 0.27602622 -0.81649658]
[-0.84515425 -0.34503278 0.40824829]]

[[-5.91607978 -7.43735744]
[ 0. 0.82807867]
[ 0. 0. ]]

[[ 1. 2.]
[ 3. 4.]
[ 5. 6.]]</code></pre><h4 id="Cholesky-Decomposition"><a href="#Cholesky-Decomposition" class="headerlink" title="Cholesky Decomposition"></a>Cholesky Decomposition</h4><p>Cholesky分解适用于所有值都大于零的平方对称矩阵，即所谓的<strong>正定矩阵</strong>。<br>$$<br>A = L · L^T<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Cholesky decomposition</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> cholesky
<span class="token comment" spellcheck="true"># define symmetrical matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
L <span class="token operator">=</span> cholesky<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># reconstruct</span>
B <span class="token operator">=</span> L<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>L<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[2 1 1]
[1 2 1]
[1 1 2]]

[[ 1.41421356 0. 0. ]
[ 0.70710678 1.22474487 0. ]
[ 0.70710678 0.40824829 1.15470054]]

[[ 2. 1. 1.]
[ 1. 2. 1.]
[ 1. 1. 2.]]</code></pre><h3 id="15-Eigendecomposition"><a href="#15-Eigendecomposition" class="headerlink" title="15. Eigendecomposition"></a>15. Eigendecomposition</h3><p>矩阵分解是一种有用的工具，可以将矩阵简化为其组成部分，从而简化一系列更复杂的操作。也许最常用的矩阵分解类型是特征分解，它将矩阵分解为特征向量和特征值。这种分解也在机器学习中使用的方法中发挥作用，例如主成分分析方法或PCA。</p>
<h4 id="Eigendecomposition-of-a-Matrix"><a href="#Eigendecomposition-of-a-Matrix" class="headerlink" title="Eigendecomposition of a Matrix"></a>Eigendecomposition of a Matrix</h4><p>$$<br>Av = λv<br>$$</p>
<p>$$<br>A = QΛQ^T<br>$$</p>
<h4 id="Eigenvectors-and-Eigenvalues"><a href="#Eigenvectors-and-Eigenvalues" class="headerlink" title="Eigenvectors and Eigenvalues"></a>Eigenvectors and Eigenvalues</h4><p>特征向量是单位向量，这意味着它们的长度或大小等于1.0。它们通常被称为右向量，也就是列向量（与行向量或左向量相反）。右向量是我们理解的向量。特征值是应用于特征向量的系数，给出了向量的长度或大小。例如，负特征值可能会反转特征向量的方向，作为缩放的一部分。只有正特征值的矩阵称为正定矩阵，而如果特征值都为负，则称为负定矩阵。</p>
<h4 id="Calculation-of-Eigendecomposition"><a href="#Calculation-of-Eigendecomposition" class="headerlink" title="Calculation of Eigendecomposition"></a>Calculation of Eigendecomposition</h4><ul>
<li>eig()：特征值分解，获得特征值与特征向量矩阵</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># eigendecomposition</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> eig
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
values<span class="token punctuation">,</span> vectors <span class="token operator">=</span> eig<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>vectors<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3]
[4 5 6]
[7 8 9]]

[ 1.61168440e+01 -1.11684397e+00 -9.75918483e-16]

[[-0.23197069 -0.78583024 0.40824829]
[-0.52532209 -0.08675134 -0.81649658]
[-0.8186735 0.61232756 0.40824829]]</code></pre><h4 id="Confirm-an-Eigenvector-and-Eigenvalue"><a href="#Confirm-an-Eigenvector-and-Eigenvalue" class="headerlink" title="Confirm an Eigenvector and Eigenvalue"></a>Confirm an Eigenvector and Eigenvalue</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># confirm eigenvector</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> eig
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
values<span class="token punctuation">,</span> vectors <span class="token operator">=</span> eig<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># confirm first eigenvector</span>
B <span class="token operator">=</span> A<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>vectors<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span>
C <span class="token operator">=</span> vectors<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[ -3.73863537 -8.46653421 -13.19443305]
[ -3.73863537 -8.46653421 -13.19443305]</code></pre><h4 id="Reconstruct-Matrix"><a href="#Reconstruct-Matrix" class="headerlink" title="Reconstruct Matrix"></a>Reconstruct Matrix</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># reconstruct matrix</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> diag
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> inv
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> eig
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
values<span class="token punctuation">,</span> vectors <span class="token operator">=</span> eig<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># create matrix from eigenvectors</span>
Q <span class="token operator">=</span> vectors
<span class="token comment" spellcheck="true"># create inverse of eigenvectors matrix</span>
R <span class="token operator">=</span> inv<span class="token punctuation">(</span>Q<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># create diagonal matrix from eigenvalues</span>
L <span class="token operator">=</span> diag<span class="token punctuation">(</span>values<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># reconstruct the original matrix</span>
B <span class="token operator">=</span> Q<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>R<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3]
[4 5 6]
[7 8 9]]

[[ 1. 2. 3.]
[ 4. 5. 6.]
[ 7. 8. 9.]]</code></pre><h3 id="16-Singular-Value-Decomposition"><a href="#16-Singular-Value-Decomposition" class="headerlink" title="16. Singular Value Decomposition"></a>16. Singular Value Decomposition</h3><p>矩阵分解，也被称为矩阵分解，涉及到使用其组成元素描述给定矩阵。也许最广为人知、应用最广泛的矩阵分解方法是奇异值分解（SVD）。所有矩阵都有一个奇异值分解，这使得它比其他方法（如特征分解）更稳定。因此，它通常被广泛应用于压缩、去噪和数据缩减等领域。</p>
<p>SVD参考资料：<a href="https://zhuanlan.zhihu.com/p/122259109" target="_blank" rel="noopener">强大的矩阵奇异值分解(SVD)</a></p>
<h4 id="What-is-the-Singular-Value-Decomposition"><a href="#What-is-the-Singular-Value-Decomposition" class="headerlink" title="What is the Singular-Value Decomposition"></a>What is the Singular-Value Decomposition</h4><p>$$<br>A = U · Σ · V^T<br>$$</p>
<h4 id="Calculate-Singular-Value-Decomposition"><a href="#Calculate-Singular-Value-Decomposition" class="headerlink" title="Calculate Singular-Value Decomposition"></a>Calculate Singular-Value Decomposition</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># singular-value decomposition</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> svd
<span class="token comment" spellcheck="true"># define a matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
U<span class="token punctuation">,</span> s<span class="token punctuation">,</span> V <span class="token operator">=</span> svd<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>U<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2]
[3 4]
[5 6]]

[[-0.2298477 0.88346102 0.40824829]
[-0.52474482 0.24078249 -0.81649658]
[-0.81964194 -0.40189603 0.40824829]]

[ 9.52551809 0.51430058]

[[-0.61962948 -0.78489445]
[-0.78489445 0.61962948]]</code></pre><h4 id="Reconstruct-Matrix-1"><a href="#Reconstruct-Matrix-1" class="headerlink" title="Reconstruct Matrix"></a>Reconstruct Matrix</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># reconstruct rectangular matrix from svd</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> diag
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> zeros
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> svd
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
U<span class="token punctuation">,</span> s<span class="token punctuation">,</span> V <span class="token operator">=</span> svd<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># create m x n Sigma matrix</span>
Sigma <span class="token operator">=</span> zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># populate Sigma with n x n diagonal matrix</span>
Sigma<span class="token punctuation">[</span><span class="token punctuation">:</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">:</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> diag<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># reconstruct matrix</span>
B <span class="token operator">=</span> U<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Sigma<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3]
[4 5 6]
[7 8 9]]

[[ 1. 2. 3.]
[ 4. 5. 6.]
[ 7. 8. 9.]]</code></pre><h4 id="Pseudoinverse"><a href="#Pseudoinverse" class="headerlink" title="Pseudoinverse"></a>Pseudoinverse</h4><p>伪逆是将方阵的矩阵逆推广到行数和列数不相等的矩形矩阵。在两个独立的方法发现者或广义逆之后，它也被称为摩尔-彭罗斯逆。<br>$$<br>A^+ = V · D^+ · U^T<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># pseudoinverse</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> pinv
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate pseudoinverse</span>
B <span class="token operator">=</span> pinv<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[ 0.1 0.2]
[ 0.3 0.4]
[ 0.5 0.6]
[ 0.7 0.8]]

[[ -1.00000000e+01 -5.00000000e+00 9.04289323e-15 5.00000000e+00]
[ 8.50000000e+00 4.50000000e+00 5.00000000e-01 -3.50000000e+00]]</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># pseudoinverse via svd</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> svd
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> zeros
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> diag
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
U<span class="token punctuation">,</span> s<span class="token punctuation">,</span> V <span class="token operator">=</span> svd<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># reciprocals of s</span>
d <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">/</span> s
<span class="token comment" spellcheck="true"># create m x n D matrix</span>
D <span class="token operator">=</span> zeros<span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># populate D with n x n diagonal matrix</span>
D<span class="token punctuation">[</span><span class="token punctuation">:</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">:</span>A<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> diag<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate pseudoinverse</span>
B <span class="token operator">=</span> V<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>D<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>U<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[ 0.1 0.2]
[ 0.3 0.4]
[ 0.5 0.6]
[ 0.7 0.8]]

[[ -1.00000000e+01 -5.00000000e+00 9.04831765e-15 5.00000000e+00]
[ 8.50000000e+00 4.50000000e+00 5.00000000e-01 -3.50000000e+00]]</code></pre><h4 id="Dimensionality-Reduction"><a href="#Dimensionality-Reduction" class="headerlink" title="Dimensionality Reduction"></a>Dimensionality Reduction</h4><ul>
<li>TruncatedSVD：截断奇异值分解</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># svd data reduction in scikit-learn</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>decomposition <span class="token keyword">import</span> TruncatedSVD
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># create transform</span>
svd <span class="token operator">=</span> TruncatedSVD<span class="token punctuation">(</span>n_components<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># fit transform</span>
svd<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># apply transform</span>
result <span class="token operator">=</span> svd<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[ 1 2 3 4 5 6 7 8 9 10]
[11 12 13 14 15 16 17 18 19 20]
[21 22 23 24 25 26 27 28 29 30]]

[[ 18.52157747 6.47697214]
[ 49.81310011 1.91182038]
[ 81.10462276 -2.65333138]]</code></pre><h2 id="Statistics"><a href="#Statistics" class="headerlink" title="Statistics"></a>Statistics</h2><h3 id="17-Introduction-to-Multivariate-Statistics"><a href="#17-Introduction-to-Multivariate-Statistics" class="headerlink" title="17. Introduction to Multivariate Statistics"></a>17. Introduction to Multivariate Statistics</h3><p>基础统计学是应用机器学习中的有用工具，可以更好地理解数据。它们也是为更高级的线性代数运算和机器学习方法提供基础的工具，例如协方差矩阵和主成分分析。因此，在线性代数表示法的背景下，掌握基础统计学非常重要。</p>
<h4 id="Expected-Value-and-Mean"><a href="#Expected-Value-and-Mean" class="headerlink" title="Expected Value and Mean"></a>Expected Value and Mean</h4><p>$$<br>E[X]=\sum x_{1} \times p_{1}, x_{2} \times p_{2}, x_{3} \times p_{3}, \cdots, x_{n} \times p_{n}<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># matrix means</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> mean
<span class="token comment" spellcheck="true"># define matrix</span>
M <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># column means</span>
col_mean <span class="token operator">=</span> mean<span class="token punctuation">(</span>M<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>col_mean<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># row means</span>
row_mean <span class="token operator">=</span> mean<span class="token punctuation">(</span>M<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>row_mean<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3 4 5 6]
[1 2 3 4 5 6]]

[ 1. 2. 3. 4. 5. 6.]

[ 3.5 3.5]</code></pre><p>$$<br>\bar{x}=\frac{1}{n} \times \sum_{i=1}^{n} x_{i}<br>$$</p>
<h4 id="Variance-and-Standard-Deviation"><a href="#Variance-and-Standard-Deviation" class="headerlink" title="Variance and Standard Deviation"></a>Variance and Standard Deviation</h4><p>$$<br>\operatorname{Var}[X]=\sum p\left(x_{1}\right) \times\left(x_{1}-E[X]\right)^{2}, p\left(x_{2}\right) \times\left(x_{2}-E[X]\right)^{2}, \cdots, p\left(x_{n}\right) \times\left(x_{n}-E[X]\right)^{2}<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># matrix variances</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> var
<span class="token comment" spellcheck="true"># define matrix</span>
M <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># column variances</span>
col_var <span class="token operator">=</span> var<span class="token punctuation">(</span>M<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>col_var<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># row variances</span>
row_var <span class="token operator">=</span> var<span class="token punctuation">(</span>M<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>row_var<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2 3 4 5 6]
[1 2 3 4 5 6]]

[ 0. 0. 0. 0. 0. 0.]

[ 3.5 3.5]</code></pre><p>$$<br>s=\sqrt{\sigma^{2}}<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># matrix standard deviation</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> std
<span class="token comment" spellcheck="true"># define matrix</span>
M <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># column standard deviations</span>
col_std <span class="token operator">=</span> std<span class="token punctuation">(</span>M<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>col_std<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># row standard deviations</span>
row_std <span class="token operator">=</span> std<span class="token punctuation">(</span>M<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>row_std<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="Covariance-and-Correlation"><a href="#Covariance-and-Correlation" class="headerlink" title="Covariance and Correlation"></a>Covariance and Correlation</h4><ul>
<li>协方差</li>
</ul>
<p>$$<br>\operatorname{cov}(X, Y)=\frac{1}{n} \times \sum(x-E[X]) \times(y-E[Y])<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># vector covariance</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> cov
<span class="token comment" spellcheck="true"># define first vector</span>
x <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># define second covariance</span>
y <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate covariance</span>
Sigma <span class="token operator">=</span> cov<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Sigma<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3 4 5 6 7 8 9]
[9 8 7 6 5 4 3 2 1]

-7.5</code></pre><ul>
<li>相关系数</li>
</ul>
<p>$$<br>r=\frac{\operatorname{cov}(X, Y)}{s_{X} \times s_{Y}}<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># vector correlation</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> corrcoef
<span class="token comment" spellcheck="true"># define first vector</span>
x <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># define second vector</span>
y <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate correlation</span>
corr <span class="token operator">=</span> corrcoef<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>corr<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[1 2 3 4 5 6 7 8 9]
[9 8 7 6 5 4 3 2 1]

-1.0</code></pre><h4 id="Covariance-Matrix"><a href="#Covariance-Matrix" class="headerlink" title="Covariance Matrix"></a>Covariance Matrix</h4><p>$$<br>\begin{gathered}<br>\Sigma=E[(X-E[X] \times(Y-E[Y])] \<br>\Sigma_{i, j}=\operatorname{cov}\left(X_{i}, X_{j}\right)<br>\end{gathered}<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># covariance matrix</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> cov
<span class="token comment" spellcheck="true"># define matrix of observations</span>
X <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate covariance matrix</span>
Sigma <span class="token operator">=</span> cov<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Sigma<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[ 1 5 8]
[ 3 5 11]
[ 2 4 9]
[ 3 6 10]
[ 1 5 10]]

[[ 1. 0.25 0.75]
[ 0.25 0.5 0.25]
[ 0.75 0.25 1.3 ]]</code></pre><h3 id="18-Principal-Component-Analysis"><a href="#18-Principal-Component-Analysis" class="headerlink" title="18. Principal Component Analysis"></a>18. Principal Component Analysis</h3><p>一种重要的降维机器学习方法叫做主成分分析。它是一种使用线性代数和统计学中的简单矩阵运算来计算原始数据到相同数量或更少维度的投影的方法。</p>
<p>主成分分析法参考资料：<a href="https://zhuanlan.zhihu.com/p/37777074" target="_blank" rel="noopener">主成分分析（PCA）原理详解</a></p>
<h4 id="What-is-Principal-Component-Analysis"><a href="#What-is-Principal-Component-Analysis" class="headerlink" title="What is Principal Component Analysis"></a>What is Principal Component Analysis</h4><p>$$<br>M=\operatorname{mean}(A)<br>$$<br>$$<br>C=A-M<br>$$<br>$$<br>V=\operatorname{cov}(C)<br>$$<br>$$<br>\text { values, vectors }=e i g(V)<br>$$</p>
<p>$$<br>B=\operatorname{select}(\text { values }, \text { vectors })<br>$$<br>$$<br>P=B^{T} \cdot A<br>$$</p>
<h4 id="Calculate-Principal-Component-Analysis"><a href="#Calculate-Principal-Component-Analysis" class="headerlink" title="Calculate Principal Component Analysis"></a>Calculate Principal Component Analysis</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># principal component analysis</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> mean
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> cov
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> eig
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># column means</span>
M <span class="token operator">=</span> mean<span class="token punctuation">(</span>A<span class="token punctuation">.</span>T<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># center columns by subtracting column means</span>
C <span class="token operator">=</span> A <span class="token operator">-</span> M
<span class="token comment" spellcheck="true"># calculate covariance matrix of centered matrix</span>
V <span class="token operator">=</span> cov<span class="token punctuation">(</span>C<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize covariance matrix</span>
values<span class="token punctuation">,</span> vectors <span class="token operator">=</span> eig<span class="token punctuation">(</span>V<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>vectors<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># project data</span>
P <span class="token operator">=</span> vectors<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>C<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>P<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[[1 2]
[3 4]
[5 6]]

[[ 0.70710678 -0.70710678]
[ 0.70710678 0.70710678]]

[8. 0.]

[[-2.82842712 0. ]
[ 0. 0. ]
[ 2.82842712 0. ]]</code></pre><h4 id="Principal-Component-Analysis-in-scikit-learn"><a href="#Principal-Component-Analysis-in-scikit-learn" class="headerlink" title="Principal Component Analysis in scikit-learn"></a>Principal Component Analysis in scikit-learn</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># principal component analysis with scikit-learn</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>decomposition <span class="token keyword">import</span> PCA
<span class="token comment" spellcheck="true"># define matrix</span>
A <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># create the transform</span>
pca <span class="token operator">=</span> PCA<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># fit transform</span>
pca<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># access values and vectors</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pca<span class="token punctuation">.</span>components_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pca<span class="token punctuation">.</span>explained_variance_<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># transform data</span>
B <span class="token operator">=</span> pca<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="19-Linear-Regression"><a href="#19-Linear-Regression" class="headerlink" title="19. Linear Regression"></a>19. Linear Regression</h3><p>线性回归是一种建模一个或多个自变量和因变量之间关系的方法。它是统计学的一个重要组成部分，通常被认为是一种很好的机器学习入门方法。它也是一种可以用矩阵表示法重新表述并用矩阵运算求解的方法。</p>
<h4 id="What-is-Linear-Regression"><a href="#What-is-Linear-Regression" class="headerlink" title="What is Linear Regression"></a>What is Linear Regression</h4><p>$$<br>y=b_{0}+\left(b_{1} \times x_{1}\right)+\left(b_{2} \times x_{2}\right)+\cdots<br>$$</p>
<h4 id="Matrix-Formulation-of-Linear-Regression"><a href="#Matrix-Formulation-of-Linear-Regression" class="headerlink" title="Matrix Formulation of Linear Regression"></a>Matrix Formulation of Linear Regression</h4><p>$$<br>b=\left(X^{T} \cdot X\right)^{-1} \cdot X^{T} \cdot y<br>$$</p>
<h4 id="Linear-Regression-Dataset"><a href="#Linear-Regression-Dataset" class="headerlink" title="Linear Regression Dataset"></a>Linear Regression Dataset</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># linear regression dataset</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot
<span class="token comment" spellcheck="true"># define dataset</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.18</span><span class="token punctuation">,</span> <span class="token number">0.22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.31</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.42</span><span class="token punctuation">,</span> <span class="token number">0.38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.49</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># split into inputs and outputs</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
X <span class="token operator">=</span> X<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># scatter plot</span>
pyplot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/images/loading.gif" data-original="../images/ML/image-20220305100424302.png" alt=""></p>
<h4 id="Solve-via-Inverse"><a href="#Solve-via-Inverse" class="headerlink" title="Solve via Inverse"></a>Solve via Inverse</h4><p>$$<br>b=\left(X^{T} \cdot X\right)^{-1} \cdot X^{T} \cdot y<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python">b <span class="token operator">=</span> inv<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># direct solution to linear least squares</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> inv
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot
<span class="token comment" spellcheck="true"># define dataset</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.18</span><span class="token punctuation">,</span> <span class="token number">0.22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.31</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.42</span><span class="token punctuation">,</span> <span class="token number">0.38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.49</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># split into inputs and outputs</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
X <span class="token operator">=</span> X<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># linear least squares</span>
b <span class="token operator">=</span> inv<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># predict using coefficients</span>
yhat <span class="token operator">=</span> X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># plot data and predictions</span>
pyplot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> yhat<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/images/loading.gif" data-original="../images/ML/image-20220305100528986.png" alt=""></p>
<h4 id="Solve-via-QR-Decomposition"><a href="#Solve-via-QR-Decomposition" class="headerlink" title="Solve via QR Decomposition"></a>Solve via QR Decomposition</h4><p>$$<br>b=R^{-1} \cdot Q^{T} \cdot y<br>$$</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># QR decomposition</span>
Q<span class="token punctuation">,</span> R <span class="token operator">=</span> qr<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
b <span class="token operator">=</span> inv<span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Q<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># QR decomposition solution to linear least squares</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> inv
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> qr
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot
<span class="token comment" spellcheck="true"># define dataset</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.18</span><span class="token punctuation">,</span> <span class="token number">0.22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.31</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.42</span><span class="token punctuation">,</span> <span class="token number">0.38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.49</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># split into inputs and outputs</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
X <span class="token operator">=</span> X<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># factorize</span>
Q<span class="token punctuation">,</span> R <span class="token operator">=</span> qr<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
b <span class="token operator">=</span> inv<span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Q<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># predict using coefficients</span>
yhat <span class="token operator">=</span> X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># plot data and predictions</span>
pyplot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> yhat<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[ 1.00233226]</code></pre><p><img src="/images/loading.gif" data-original="../images/ML/image-20220305100703293.png" alt=""></p>
<h4 id="Solve-via-SVD-and-Pseudoinverse"><a href="#Solve-via-SVD-and-Pseudoinverse" class="headerlink" title="Solve via SVD and Pseudoinverse"></a>Solve via SVD and Pseudoinverse</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># SVD solution via pseudoinverse to linear least squares</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> pinv
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot
<span class="token comment" spellcheck="true"># define dataset</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.18</span><span class="token punctuation">,</span> <span class="token number">0.22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.31</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.42</span><span class="token punctuation">,</span> <span class="token number">0.38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.49</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># split into inputs and outputs</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
X <span class="token operator">=</span> X<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate coefficients</span>
b <span class="token operator">=</span> pinv<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># predict using coefficients</span>
yhat <span class="token operator">=</span> X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># plot data and predictions</span>
pyplot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> yhat<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="Solve-via-Convenience-Function"><a href="#Solve-via-Convenience-Function" class="headerlink" title="Solve via Convenience Function"></a>Solve via Convenience Function</h4><p>通过奇异值分解法求解线性最小二乘的伪逆是事实上的标准。这是因为它是稳定的，适用于大多数数据集。NumPy提供了一个名为lstsq（）的方便函数，该函数使用SVD方法求解线性最小二乘函数。该函数将X矩阵和y向量作为输入，并返回b系数、残差、提供的X矩阵的秩和奇异值。下面的示例演示了测试数据集上的lstsq（）函数。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># least squares via convenience function</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> array
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> lstsq
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot
<span class="token comment" spellcheck="true"># define dataset</span>
data <span class="token operator">=</span> array<span class="token punctuation">(</span><span class="token punctuation">[</span>
<span class="token punctuation">[</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token number">0.12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.18</span><span class="token punctuation">,</span> <span class="token number">0.22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.31</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.42</span><span class="token punctuation">,</span> <span class="token number">0.38</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.49</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># split into inputs and outputs</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
X <span class="token operator">=</span> X<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># calculate coefficients</span>
b<span class="token punctuation">,</span> residuals<span class="token punctuation">,</span> rank<span class="token punctuation">,</span> s <span class="token operator">=</span> lstsq<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># predict using coefficients</span>
yhat <span class="token operator">=</span> X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># plot data and predictions</span>
pyplot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> yhat<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>[ 1.00233226]</code></pre><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>本书主要针对机器学习的线性代数基础展开，深入理解机器学习底层用到的数学原理，针对Python语言的Numpy，Scipy和Scikit-Learn包展开编程教学，对机器学习基础有很好的认识，为后续理解机器学习实现有了更深层次的数学理解！</p>
<p>通过对该书的学习，让我对数学原理应用于机器学习基础有了很深的理解，如何将数学理论基础转变为实践应用，对个人未来的算法学习有很大的帮助！</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://jackhcc.github.io" rel="external nofollow noreferrer">杰克成</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://jackhcc.github.io/posts/Basics-of-Linear-Algebra-for-Machine-Learning.html">https://jackhcc.github.io/posts/Basics-of-Linear-Algebra-for-Machine-Learning.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://jackhcc.github.io" target="_blank">杰克成</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Machine-Learning/">
                                    <span class="chip bg-color">Machine Learning</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/reward/aliqr.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/reward/wxqr.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '3821a0bbb773038a51fc',
        clientSecret: '4b30b507d67ec5497ec0e77f43f80cb3e0d7dd3a',
        repo: 'JackHCC.github.io',
        owner: 'JackHCC',
        admin: "JackHCC",
        id: '2022-03-04T21-52-22',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/posts/Lesson-Natural-Language-Process.html">
                    <div class="card-image">
                        
                        
                        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/featureimages/18.jpg" class="responsive-img" alt="Natural Language Process Lesson">
                        
                        <span class="card-title">Natural Language Process Lesson</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            自然语言处理课程笔记
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-03-12
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Lesson/" class="post-category">
                                    Lesson
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/NLP/">
                        <span class="chip bg-color">NLP</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/Awesome-weapp.html">
                    <div class="card-image">
                        
                        
                        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/featureimages/4.jpg" class="responsive-img" alt="Awesome WeChat App">
                        
                        <span class="card-title">Awesome WeChat App</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            微信小程序开发资料汇总
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-02-08
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Awesome/" class="post-category">
                                    Awesome
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/WeChat/">
                        <span class="chip bg-color">WeChat</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('4'),
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <footer class="page-footer bg-color">
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2020</span>
            <a href="https://jackhcc.github.io" target="_blank">杰克成</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">3591.2k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2020";
                    var startMonth = "2";
                    var startDate = "27";
                    var startHour = "6";
                    var startMinute = "30";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/JackHCC" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:jackcc0701@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>



    <a href="https://www.facebook.com/profile.php?id=100046343443643" class="tooltipped" target="_blank" data-tooltip="关注我的Facebook: https://www.facebook.com/profile.php?id=100046343443643" data-position="top" data-delay="50">
        <i class="fab fa-facebook-f"></i>
    </a>



    <a href="https://twitter.com/JackChe66021834" class="tooltipped" target="_blank" data-tooltip="关注我的Twitter: https://twitter.com/JackChe66021834" data-position="top" data-delay="50">
        <i class="fab fa-twitter"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2508074836" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2508074836" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>



    <a href="https://weibo.com/u/6885584679" class="tooltipped" target="_blank" data-tooltip="关注我的微博: https://weibo.com/u/6885584679" data-position="top" data-delay="50">
        <i class="fab fa-weibo"></i>
    </a>



    <a href="https://www.zhihu.com/people/8f8482f01f0d6a04e844efe32e0f0710" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/8f8482f01f0d6a04e844efe32e0f0710" data-position="top" data-delay="50">
        <i class="fab fa-zhihu1">知</i>
    </a>



</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/js/matery.js"></script>

    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas>
    <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
    <script type="text/javascript" src="/js/fireworks.js"></script>

    <script type="text/javascript">
        //只在桌面版网页启用特效
        var windowWidth = $(window).width();
        if (windowWidth > 768) {
            document.write('<script type="text/javascript" src="/js/sakura.js"><\/script>'); }
    </script>

    <!-- weather -->
	<script type="text/javascript">
	WIDGET = {FID: 'TToslpmkVO'}
	</script>
	<script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"></script>


    <!-- Global site tag (gtag.js) - Google Analytics -->


    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

    
    
    <script async src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/others/busuanzi.pure.mini.js"></script>
    

    
        <script src="//code.tidio.co/kqhlkxviiccyoa0czpfpu4ijuey9hfre.js"></script>
        <script> 
            $(document).ready(function () {
                setInterval(change_Tidio, 50);  
                function change_Tidio() { 
                    var tidio=$("#tidio-chat iframe");
                    if(tidio.css("display")=="block"&& $(window).width()>977 ){
                        document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" &&$(window).width()>977)>0? "-40px" : ($("div.toc-title").length&&$(window).width()>977)>0?"85px":"20px";   
                        document.getElementById("tidio-chat-iframe").style.right="-15px";   
                        document.getElementById("tidio-chat-iframe").style.height=parseInt(tidio.css("height"))>=520?"520px":tidio.css("height");
                        document.getElementById("tidio-chat-iframe").style.zIndex="997";
                    } 
                    else if(tidio.css("display")=="block"&&$(window).width()>601 &&$(window).width()<992 ){
                        document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" && 601< $(window).width()<992)>0? "-40px":"20px" ;   
                        document.getElementById("tidio-chat-iframe").style.right="-15px"; 
                        document.getElementById("tidio-chat-iframe").style.zIndex="997";
                    }
                    else if(tidio.css("display")=="block"&&$(window).width()<601 && parseInt(tidio.css("height"))<230){
                        document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" && $(window).width()<601)>0? "-10px":"45px" ;   
                        document.getElementById("tidio-chat-iframe").style.zIndex="997";
                    }
                    if( tidio.css("display")=="block"&&$(window).width()<601 && parseInt(tidio.css("height"))>=230){
                        document.getElementById("tidio-chat-iframe").style.zIndex="998";
                    }
                } 
            }); 
        </script>
    

    

    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/background/canvas-nest.js"></script>
    

    

    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/background/ribbon-dynamic.js" async="async"></script>
    
    
    
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/instantpage/instantpage.js" type="module"></script>
    

        <script src="//cdn.jsdelivr.net/npm/js-base64/base64.min.js"></script>
        <script>
        $('a').each(function() {
          const $this = $(this);
          const href = $this.attr('href');
          if (href && href.match('^((http|https|thunder|qqdl|ed2k|Flashget|qbrowser|ftp|rtsp|mms)://)')) {
            const strs = href.split('/');
            if (strs.length >= 3) {
                const host = strs[2];
                if (host !== 'your_domain' || window.location.host) {
                    $this.attr('href', '/go.html?u='+Base64.encode(href)+'').attr('rel', 'external nofollow noopener noreferrer');
                    if (true) {
                        $this.attr('target', '_blank');
                    }
                }
            }
          }
        });
        </script><script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)t=c[r],0<=(n=t.getBoundingClientRect()).bottom&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this);</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script></body>

</html>

