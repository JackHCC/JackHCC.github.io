<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Python-Pandas详解, JackHCC">
    <meta name="description" content="Pandas库相关计算与使用指南">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Python-Pandas详解 | JackHCC</title>
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/favicon.png">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/css/matery.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/css/my.css">
    
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/jquery/jquery.min.js"></script>
    
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="JackHCC" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-hopscotch.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/me.jpg" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">JackHCC</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Tools</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="https://creativecc.cn/" target="_blank" rel="noopener">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Creative工具导航</span>
        </a>
      </li>
      
      <li>
        <a href="https://blog.creativecc.cn/Arxiv-NLP-Reporter/" target="_blank" rel="noopener">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>NLP每日论文</span>
        </a>
      </li>
      
      <li>
        <a href="http://chat.creativecc.cn/" target="_blank" rel="noopener">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>RocketChat聊天室</span>
        </a>
      </li>
      
      <li>
        <a href="/contact">
          
          <i class="fas fa-comments" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Contact留言板</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/me.jpg" class="logo-img circle responsive-img">
        
        <div class="logo-name">JackHCC</div>
        <div class="logo-desc">
            
            Make the world betterrrr!!!
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			Tools
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>   
				
                  <a href="https://creativecc.cn/ " target="_blank" rel="noopener" style="margin-left:75px";>
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>Creative工具导航</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="https://blog.creativecc.cn/Arxiv-NLP-Reporter/ " target="_blank" rel="noopener" style="margin-left:75px";>
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>NLP每日论文</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="http://chat.creativecc.cn/ " target="_blank" rel="noopener" style="margin-left:75px";>
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>RocketChat聊天室</span>
                  </a>
                </li>
              
                <li>   
				
                  <a href="/contact " style="margin-left:75px";>
				  
				   <i class="fa fas fa-comments" style="position: absolute;left:50px" ></i>
			      
		          <span>Contact留言板</span>
                  </a>
                </li>
               
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/JackHCC/JackHCC.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/JackHCC/JackHCC.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/featureimages/17.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Python-Pandas详解</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 30px;
        bottom: 146px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Pandas/">
                                <span class="chip bg-color">Pandas</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Python/" class="post-category">
                                Python
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-03-05
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2021-11-15
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    17.8k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    97 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>

        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Pandas-教程"><a href="#Pandas-教程" class="headerlink" title="Pandas 教程"></a>Pandas 教程</h1><p><img src="/images/loading.gif" data-original="../images/ML/pandas.png" alt=""></p>
<p><strong>Pandas 是 Python 语言的一个扩展程序库，用于数据分析。</strong></p>
<p>Pandas 是一个开放源码、BSD 许可的库，提供高性能、易于使用的数据结构和数据分析工具。</p>
<p>Pandas 名字衍生自术语 “panel data”（面板数据）和 “Python data analysis”（Python 数据分析）。</p>
<p>Pandas 一个强大的分析结构化数据的工具集，基础是 Numpy（提供高性能的矩阵运算）。</p>
<p>Pandas 可以从各种文件格式比如 CSV、JSON、SQL、Microsoft Excel 导入数据。</p>
<p>Pandas 可以对各种数据进行运算操作，比如归并、再成形、选择，还有数据清洗和数据加工特征。</p>
<p>Pandas 广泛应用在学术、金融、统计学等各个数据分析领域。</p>
<hr>
<h2 id="Pandas-应用"><a href="#Pandas-应用" class="headerlink" title="Pandas 应用"></a>Pandas 应用</h2><p>Pandas 的主要数据结构是 Series （一维数据）与 DataFrame（二维数据），这两种数据结构足以处理金融、统计、社会科学、工程等领域里的大多数典型用例。</p>
<hr>
<h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><p><strong>Series</strong> 是一种类似于一维数组的对象，它由一组数据（各种Numpy数据类型）以及一组与之相关的数据标签（即索引）组成。</p>
<p><strong>DataFrame</strong> 是一个表格型的数据结构，它含有一组有序的列，每列可以是不同的值类型（数值、字符串、布尔型值）。DataFrame 既有行索引也有列索引，它可以被看做由 Series 组成的字典（共同用一个索引）。</p>
<h1 id="Pandas-安装"><a href="#Pandas-安装" class="headerlink" title="Pandas 安装"></a>Pandas 安装</h1><p>安装 pandas 需要基础环境是 Python，开始前我们假定你已经安装了 Python 和 Pip。</p>
<p>使用 pip 安装 pandas:</p>
<pre class="line-numbers language-python"><code class="language-python">pip install pandas<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>安装成功后，我们就可以导入 pandas 包使用：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="实例-查看-pandas-版本"><a href="#实例-查看-pandas-版本" class="headerlink" title="实例 - 查看 pandas 版本"></a>实例 - 查看 pandas 版本</h2><pre><code>&gt;&gt;&gt; **import** pandas
&gt;&gt;&gt; pandas.__version__  # 查看版本
'1.1.5'</code></pre><p>导入 pandas 一般使用别名 <strong>pd</strong> 来代替：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="实例-查看-pandas-版本-1"><a href="#实例-查看-pandas-版本-1" class="headerlink" title="实例 - 查看 pandas 版本"></a>实例 - 查看 pandas 版本</h2><pre><code>&gt;&gt;&gt; **import** pandas **as** pd
&gt;&gt;&gt; pd.__version__  # 查看版本
'1.1.5'</code></pre><p>一个简单等 pandas 实例：</p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

mydataset <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token string">'sites'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Runoob"</span><span class="token punctuation">,</span> <span class="token string">"Wiki"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token string">'number'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

myvar <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>mydataset<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myvar<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>执行以上代码，输出结果为：</p>
<p><img src="/images/loading.gif" data-original="../images/language/0332CA88-50C3-4BF6-BACC-D9963BE0F724.jpg" alt=""></p>
<h1 id="Pandas-数据结构-Series"><a href="#Pandas-数据结构-Series" class="headerlink" title="Pandas 数据结构 - Series"></a>Pandas 数据结构 - Series</h1><p>Pandas Series 类似表格中的一个列（column），类似于一维数组，可以保存任何数据类型。</p>
<p>Series 由索引（index）和列组成，函数如下：</p>
<pre class="line-numbers language-python"><code class="language-python">pandas<span class="token punctuation">.</span>Series<span class="token punctuation">(</span> data<span class="token punctuation">,</span> index<span class="token punctuation">,</span> dtype<span class="token punctuation">,</span> name<span class="token punctuation">,</span> copy<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>参数说明：</p>
<ul>
<li><strong>data</strong>：一组数据(ndarray 类型)。</li>
<li><strong>index</strong>：数据索引标签，如果不指定，默认从 0 开始。</li>
<li><strong>dtype</strong>：数据类型，默认会自己判断。</li>
<li><strong>name</strong>：设置名称。</li>
<li><strong>copy</strong>：拷贝数据，默认为 False。</li>
</ul>
<p>创建一个简单的 Series 实例：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

myvar <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>a<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myvar<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果如下：</p>
<p><img src="/images/loading.gif" data-original="../images/language/FD659034-1715-4020-A6BF-400FAC9CE849.jpg" alt=""></p>
<p>从上图可知，如果没有指定索引，索引值就从 0 开始，我们可以根据索引值读取数据：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

myvar <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>a<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myvar<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果如下：</p>
<pre><code>2</code></pre><p>我们可以指定索引值，如下实例：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Runoob"</span><span class="token punctuation">,</span> <span class="token string">"Wiki"</span><span class="token punctuation">]</span>

myvar <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>a<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">,</span> <span class="token string">"z"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myvar<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果如下：</p>
<p><img src="/images/loading.gif" data-original="../images/language/32B49FA4-ED68-446A-9EBF-C52FCB6D0CD6.jpg" alt=""></p>
<p>根据索引值读取数据:</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Runoob"</span><span class="token punctuation">,</span> <span class="token string">"Wiki"</span><span class="token punctuation">]</span>

myvar <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>a<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">,</span> <span class="token string">"z"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myvar<span class="token punctuation">[</span><span class="token string">"y"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果如下：</p>
<pre><code>Runoob</code></pre><p>我们也可以使用 key/value 对象，类似字典来创建 Series：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

sites <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"Runoob"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"Wiki"</span><span class="token punctuation">}</span>

myvar <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>sites<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myvar<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果如下：</p>
<p><img src="/images/loading.gif" data-original="../images/language/C01F8A55-5D06-4FAD-BE34-A569A8B05E2C.jpg" alt=""></p>
<p>从上图可知，字典的 key 变成了索引值。</p>
<p>如果我们只需要字典中的一部分数据，只需要指定需要数据的索引即可，如下实例：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

sites <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"Runoob"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"Wiki"</span><span class="token punctuation">}</span>

myvar <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>sites<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myvar<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果如下：</p>
<p><img src="/images/loading.gif" data-original="../images/language/6CC2CFBA-3CC5-459D-8FE0-D89C1EE1AEB9.jpg" alt=""></p>
<p>设置 Series 名称参数：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

sites <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"Runoob"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"Wiki"</span><span class="token punctuation">}</span>

myvar <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>sites<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"RUNOOB-Series-TEST"</span> <span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myvar<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/images/loading.gif" data-original="../images/language/1FB6D419-06D7-4229-9148-1F4E79DE6ACF.jpg" alt=""></p>
<h1 id="Pandas-数据结构-DataFrame"><a href="#Pandas-数据结构-DataFrame" class="headerlink" title="Pandas 数据结构 - DataFrame"></a>Pandas 数据结构 - DataFrame</h1><p>DataFrame 是一个表格型的数据结构，它含有一组有序的列，每列可以是不同的值类型（数值、字符串、布尔型值）。DataFrame 既有行索引也有列索引，它可以被看做由 Series 组成的字典（共同用一个索引）。</p>
<p><img src="/images/loading.gif" data-original="../images/language/pandas-DataStructure.png" alt=""></p>
<p><img src="/images/loading.gif" data-original="../images/language/df-dp.png" alt=""></p>
<p>DataFrame 构造方法如下：</p>
<pre class="line-numbers language-python"><code class="language-python">pandas<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span> data<span class="token punctuation">,</span> index<span class="token punctuation">,</span> columns<span class="token punctuation">,</span> dtype<span class="token punctuation">,</span> copy<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>参数说明：</p>
<ul>
<li><strong>data</strong>：一组数据(ndarray、series, map, lists, dict 等类型)。</li>
<li><strong>index</strong>：索引值，或者可以称为行标签。</li>
<li><strong>columns</strong>：列标签，默认为 RangeIndex (0, 1, 2, …, n) 。</li>
<li><strong>dtype</strong>：数据类型。</li>
<li><strong>copy</strong>：拷贝数据，默认为 False。</li>
</ul>
<p>Pandas DataFrame 是一个二维的数组结构，类似二维数组。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Google'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'Runoob'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'Wiki'</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Site'</span><span class="token punctuation">,</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span>float<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果如下：</p>
<p><img src="/images/loading.gif" data-original="../images/language/BE773E8F-DEC2-4434-8630-91E660A1DFC0.jpg" alt=""></p>
<p>以下实例使用 ndarrays 创建，ndarray 的长度必须相同， 如果传递了 index，则索引的长度应等于数组的长度。如果没有传递索引，则默认情况下，索引将是range(n)，其中n是数组长度。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Site'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Google'</span><span class="token punctuation">,</span> <span class="token string">'Runoob'</span><span class="token punctuation">,</span> <span class="token string">'Wiki'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果如下：</p>
<p><img src="/images/loading.gif" data-original="../images/language/BE773E8F-DEC2-4434-8630-91E660A1DFC0-1629874139063416.jpg" alt=""></p>
<p>从以上输出结果可以知道， DataFrame 数据类型一个表格，包含 rows（行） 和 columns（列）：</p>
<p><img src="/images/loading.gif" data-original="../images/language/rows-cloumns.png" alt=""></p>
<p>还可以使用字典（key/value），其中字典的 key 为列名:</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">]</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token keyword">print</span> <span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre class="line-numbers language-python"><code class="language-python">   a   b     c
<span class="token number">0</span>  <span class="token number">1</span>   <span class="token number">2</span>   NaN
<span class="token number">1</span>  <span class="token number">5</span>  <span class="token number">10</span>  <span class="token number">20.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>没有对应的部分数据为 <strong>NaN</strong>。</p>
<p>Pandas 可以使用 <strong>loc</strong> 属性返回指定行的数据，如果没有设置索引，第一行索引为 <strong>0</strong>，第二行索引为 <strong>1</strong>，以此类推：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">"calories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">380</span><span class="token punctuation">,</span> <span class="token number">390</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"duration"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true"># 数据载入到 DataFrame 对象</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 返回第一行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 返回第二行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果如下：</p>
<pre class="line-numbers language-python"><code class="language-python">calories    <span class="token number">420</span>
duration     <span class="token number">50</span>
Name<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64
calories    <span class="token number">380</span>
duration     <span class="token number">40</span>
Name<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>注意：</strong>返回结果其实就是一个 Pandas Series 数据。</p>
<p>也可以返回多行数据，使用 <strong>[[ … ]]</strong> 格式，<strong>…</strong> 为各行的索引，以逗号隔开：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">"calories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">380</span><span class="token punctuation">,</span> <span class="token number">390</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"duration"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true"># 数据载入到 DataFrame 对象</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 返回第一行和第二行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre class="line-numbers language-python"><code class="language-python">   calories  duration
<span class="token number">0</span>       <span class="token number">420</span>        <span class="token number">50</span>
<span class="token number">1</span>       <span class="token number">380</span>        <span class="token number">40</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>注意：</strong>返回结果其实就是一个 Pandas DataFrame 数据。</p>
<p>我们可以指定索引值，如下实例：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">"calories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">380</span><span class="token punctuation">,</span> <span class="token number">390</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"duration"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"day1"</span><span class="token punctuation">,</span> <span class="token string">"day2"</span><span class="token punctuation">,</span> <span class="token string">"day3"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre class="line-numbers language-python"><code class="language-python">      calories  duration
day1       <span class="token number">420</span>        <span class="token number">50</span>
day2       <span class="token number">380</span>        <span class="token number">40</span>
day3       <span class="token number">390</span>        <span class="token number">45</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Pandas 可以使用 <strong>loc</strong> 属性返回指定索引对应到某一行：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">"calories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">380</span><span class="token punctuation">,</span> <span class="token number">390</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"duration"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"day1"</span><span class="token punctuation">,</span> <span class="token string">"day2"</span><span class="token punctuation">,</span> <span class="token string">"day3"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 指定索引</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">"day2"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre class="line-numbers language-python"><code class="language-python">calories    <span class="token number">380</span>
duration     <span class="token number">40</span>
Name<span class="token punctuation">:</span> day2<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h1 id="Pandas-CSV-文件"><a href="#Pandas-CSV-文件" class="headerlink" title="Pandas CSV 文件"></a>Pandas CSV 文件</h1><p>CSV（Comma-Separated Values，逗号分隔值，有时也称为字符分隔值，因为分隔字符也可以不是逗号），其文件以纯文本形式存储表格数据（数字和文本）。</p>
<p>CSV 是一种通用的、相对简单的文件格式，被用户、商业和科学广泛应用。</p>
<p>Pandas 可以很方便的处理 CSV 文件，本文以 <a href="https://static.runoob.com/download/nba.csv" target="_blank" rel="noopener">nba.csv</a> 为例，你可以<a href="https://static.runoob.com/download/nba.csv" target="_blank" rel="noopener">下载 nba.csv</a> 或<a href="https://static.runoob.com/download/nba.csv.txt" target="_blank" rel="noopener">打开 nba.csv</a> 查看。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'nba.csv'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>to_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>to_string()</strong> 用于返回 DataFrame 类型的数据，如果不使用该函数，则输出结果为数据的前面 5 行和末尾 5 行，中间部分以 <strong>…</strong> 代替。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'nba.csv'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre><code>              Name            Team  Number Position   Age Height  Weight            College     Salary
0    Avery Bradley  Boston Celtics     0.0       PG  25.0    6-2   180.0              Texas  7730337.0
1      Jae Crowder  Boston Celtics    99.0       SF  25.0    6-6   235.0          Marquette  6796117.0
2     John Holland  Boston Celtics    30.0       SG  27.0    6-5   205.0  Boston University        NaN
3      R.J. Hunter  Boston Celtics    28.0       SG  22.0    6-5   185.0      Georgia State  1148640.0
4    Jonas Jerebko  Boston Celtics     8.0       PF  29.0   6-10   231.0                NaN  5000000.0
..             ...             ...     ...      ...   ...    ...     ...                ...        ...
453   Shelvin Mack       Utah Jazz     8.0       PG  26.0    6-3   203.0             Butler  2433333.0
454      Raul Neto       Utah Jazz    25.0       PG  24.0    6-1   179.0                NaN   900000.0
455   Tibor Pleiss       Utah Jazz    21.0        C  26.0    7-3   256.0                NaN  2900000.0
456    Jeff Withey       Utah Jazz    24.0        C  26.0    7-0   231.0             Kansas   947276.0
457            NaN             NaN     NaN      NaN   NaN    NaN     NaN                NaN        NaN</code></pre><p>我们也可以使用 <strong>to_csv()</strong> 方法将 DataFrame 存储为 csv 文件：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment" spellcheck="true"># 三个字段 name, site, age</span>
nme <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"Runoob"</span><span class="token punctuation">,</span> <span class="token string">"Taobao"</span><span class="token punctuation">,</span> <span class="token string">"Wiki"</span><span class="token punctuation">]</span>
st <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"www.google.com"</span><span class="token punctuation">,</span> <span class="token string">"www.runoob.com"</span><span class="token punctuation">,</span> <span class="token string">"www.taobao.com"</span><span class="token punctuation">,</span> <span class="token string">"www.wikipedia.org"</span><span class="token punctuation">]</span>
ag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">]</span>

<span class="token comment" spellcheck="true"># 字典</span>
dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> nme<span class="token punctuation">,</span> <span class="token string">'site'</span><span class="token punctuation">:</span> st<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> ag<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>dict<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 保存 dataframe</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'site.csv'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>执行成功后，我们打开 site.csv 文件，显示结果如下：</p>
<p><img src="/images/loading.gif" data-original="../images/language/9758194A-0D8E-4C53-95A0-157C690614E6.jpg" alt=""></p>
<h2 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h2><h3 id="head"><a href="#head" class="headerlink" title="head()"></a>head()</h3><p><strong>head( n)</strong> 方法用于读取前面的 n 行，如果不填参数 n ，默认返回 5 行。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'nba.csv'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre><code>            Name            Team  Number Position   Age Height  Weight            College     Salary
0  Avery Bradley  Boston Celtics     0.0       PG  25.0    6-2   180.0              Texas  7730337.0
1    Jae Crowder  Boston Celtics    99.0       SF  25.0    6-6   235.0          Marquette  6796117.0
2   John Holland  Boston Celtics    30.0       SG  27.0    6-5   205.0  Boston University        NaN
3    R.J. Hunter  Boston Celtics    28.0       SG  22.0    6-5   185.0      Georgia State  1148640.0
4  Jonas Jerebko  Boston Celtics     8.0       PF  29.0   6-10   231.0                NaN  5000000.0</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'nba.csv'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre><code>            Name            Team  Number Position   Age Height  Weight            College      Salary
0  Avery Bradley  Boston Celtics     0.0       PG  25.0    6-2   180.0              Texas   7730337.0
1    Jae Crowder  Boston Celtics    99.0       SF  25.0    6-6   235.0          Marquette   6796117.0
2   John Holland  Boston Celtics    30.0       SG  27.0    6-5   205.0  Boston University         NaN
3    R.J. Hunter  Boston Celtics    28.0       SG  22.0    6-5   185.0      Georgia State   1148640.0
4  Jonas Jerebko  Boston Celtics     8.0       PF  29.0   6-10   231.0                NaN   5000000.0
5   Amir Johnson  Boston Celtics    90.0       PF  29.0    6-9   240.0                NaN  12000000.0
6  Jordan Mickey  Boston Celtics    55.0       PF  21.0    6-8   235.0                LSU   1170960.0
7   Kelly Olynyk  Boston Celtics    41.0        C  25.0    7-0   238.0            Gonzaga   2165160.0
8   Terry Rozier  Boston Celtics    12.0       PG  22.0    6-2   190.0         Louisville   1824360.0
9   Marcus Smart  Boston Celtics    36.0       PG  22.0    6-4   220.0     Oklahoma State   3431040.0</code></pre><h3 id="tail"><a href="#tail" class="headerlink" title="tail()"></a>tail()</h3><p><strong>tail( n )</strong> 方法用于读取尾部的 n 行，如果不填参数 n ，默认返回 5 行，空行各个字段的值返回 <strong>NaN</strong>。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'nba.csv'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre><code>             Name       Team  Number Position   Age Height  Weight College     Salary
453  Shelvin Mack  Utah Jazz     8.0       PG  26.0    6-3   203.0  Butler  2433333.0
454     Raul Neto  Utah Jazz    25.0       PG  24.0    6-1   179.0     NaN   900000.0
455  Tibor Pleiss  Utah Jazz    21.0        C  26.0    7-3   256.0     NaN  2900000.0
456   Jeff Withey  Utah Jazz    24.0        C  26.0    7-0   231.0  Kansas   947276.0
457           NaN        NaN     NaN      NaN   NaN    NaN     NaN     NaN        NaN</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'nba.csv'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre><code>               Name       Team  Number Position   Age Height  Weight   College      Salary
448  Gordon Hayward  Utah Jazz    20.0       SF  26.0    6-8   226.0    Butler  15409570.0
449     Rodney Hood  Utah Jazz     5.0       SG  23.0    6-8   206.0      Duke   1348440.0
450      Joe Ingles  Utah Jazz     2.0       SF  28.0    6-8   226.0       NaN   2050000.0
451   Chris Johnson  Utah Jazz    23.0       SF  26.0    6-6   206.0    Dayton    981348.0
452      Trey Lyles  Utah Jazz    41.0       PF  20.0   6-10   234.0  Kentucky   2239800.0
453    Shelvin Mack  Utah Jazz     8.0       PG  26.0    6-3   203.0    Butler   2433333.0
454       Raul Neto  Utah Jazz    25.0       PG  24.0    6-1   179.0       NaN    900000.0
455    Tibor Pleiss  Utah Jazz    21.0        C  26.0    7-3   256.0       NaN   2900000.0
456     Jeff Withey  Utah Jazz    24.0        C  26.0    7-0   231.0    Kansas    947276.0
457             NaN        NaN     NaN      NaN   NaN    NaN     NaN       NaN         NaN</code></pre><h3 id="info"><a href="#info" class="headerlink" title="info()"></a>info()</h3><p>info() 方法返回表格的一些基本信息：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'nba.csv'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出结果为：</p>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 458 entries, 0 to 457          # 行数，458 行，第一行编号为 0
Data columns (total 9 columns):            # 列数，9列
 #   Column    Non-Null Count  Dtype       # 各列的数据类型
---  ------    --------------  -----  
 0   Name      457 non-null    object 
 1   Team      457 non-null    object 
 2   Number    457 non-null    float64
 3   Position  457 non-null    object 
 4   Age       457 non-null    float64
 5   Height    457 non-null    object 
 6   Weight    457 non-null    float64
 7   College   373 non-null    object         # non-null，意思为非空的数据    
 8   Salary    446 non-null    float64
dtypes: float64(4), object(5)                 # 类型</code></pre><p>non-null 为非空数据，我们可以看到上面的信息中，总共 458 行，College 字段的空值最多。</p>
<h1 id="Pandas-JSON"><a href="#Pandas-JSON" class="headerlink" title="Pandas JSON"></a>Pandas JSON</h1><p>JSON（<strong>J</strong>ava<strong>S</strong>cript <strong>O</strong>bject <strong>N</strong>otation，JavaScript 对象表示法），是存储和交换文本信息的语法，类似 XML。</p>
<p>JSON 比 XML 更小、更快，更易解析.</p>
<p>Pandas 可以很方便的处理 JSON 数据，本文以 <a href="https://static.runoob.com/download/sites.json" target="_blank" rel="noopener">sites.json</a> 为例，内容如下：</p>
<pre><code>[
   {
   "id": "A001",
   "name": "菜鸟教程",
   "url": "www.runoob.com",
   "likes": 61
   },
   {
   "id": "A002",
   "name": "Google",
   "url": "www.google.com",
   "likes": 124
   },
   {
   "id": "A003",
   "name": "淘宝",
   "url": "www.taobao.com",
   "likes": 45
   }
]</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span><span class="token string">'sites.json'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>to_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>to_string()</strong> 用于返回 DataFrame 类型的数据，我们也可以直接处理 JSON 字符串。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"A001"</span><span class="token punctuation">,</span>
      <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"菜鸟教程"</span><span class="token punctuation">,</span>
      <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"www.runoob.com"</span><span class="token punctuation">,</span>
      <span class="token string">"likes"</span><span class="token punctuation">:</span> <span class="token number">61</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"A002"</span><span class="token punctuation">,</span>
      <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Google"</span><span class="token punctuation">,</span>
      <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"www.google.com"</span><span class="token punctuation">,</span>
      <span class="token string">"likes"</span><span class="token punctuation">:</span> <span class="token number">124</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"A003"</span><span class="token punctuation">,</span>
      <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"淘宝"</span><span class="token punctuation">,</span>
      <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"www.taobao.com"</span><span class="token punctuation">,</span>
      <span class="token string">"likes"</span><span class="token punctuation">:</span> <span class="token number">45</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上实例输出结果为：</p>
<pre><code>     id    name             url  likes
0  A001    菜鸟教程  www.runoob.com     61
1  A002  Google  www.google.com    124
2  A003      淘宝  www.taobao.com     45</code></pre><p>JSON 对象与 Python 字典具有相同的格式，所以我们可以直接将 Python 字典转化为 DataFrame 数据：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd


<span class="token comment" spellcheck="true"># 字典格式的 JSON                                                                                              </span>
s <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"col1"</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">"row1"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"row2"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"row3"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"col2"</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">"row1"</span><span class="token punctuation">:</span><span class="token string">"x"</span><span class="token punctuation">,</span><span class="token string">"row2"</span><span class="token punctuation">:</span><span class="token string">"y"</span><span class="token punctuation">,</span><span class="token string">"row3"</span><span class="token punctuation">:</span><span class="token string">"z"</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true"># 读取 JSON 转为 DataFrame                                                                                          </span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上实例输出结果为：</p>
<pre><code>      col1 col2
row1     1    x
row2     2    y
row3     3    z</code></pre><p>从 URL 中读取 JSON 数据：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

URL <span class="token operator">=</span> <span class="token string">'https://static.runoob.com/download/sites.json'</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span>URL<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上实例输出结果为：</p>
<pre><code>     id    name             url  likes
0  A001    菜鸟教程  www.runoob.com     61
1  A002  Google  www.google.com    124
2  A003      淘宝  www.taobao.com     45</code></pre><h3 id="内嵌的-JSON-数据"><a href="#内嵌的-JSON-数据" class="headerlink" title="内嵌的 JSON 数据"></a>内嵌的 JSON 数据</h3><p>假设有一组内嵌的 JSON 数据文件 <strong>nested_list.json</strong> ：</p>
<pre><code>{
    "school_name": "ABC primary school",
    "class": "Year 1",
    "students": [
    {
        "id": "A001",
        "name": "Tom",
        "math": 60,
        "physics": 66,
        "chemistry": 61
    },
    {
        "id": "A002",
        "name": "James",
        "math": 89,
        "physics": 76,
        "chemistry": 51
    },
    {
        "id": "A003",
        "name": "Jenny",
        "math": 79,
        "physics": 90,
        "chemistry": 78
    }]
}</code></pre><p>使用以下代码格式化完整内容：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span><span class="token string">'nested_list.json'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上实例输出结果为：</p>
<pre><code>          school_name   class                                           students
0  ABC primary school  Year 1  {'id': 'A001', 'name': 'Tom', 'math': 60, 'phy...
1  ABC primary school  Year 1  {'id': 'A002', 'name': 'James', 'math': 89, 'p...
2  ABC primary school  Year 1  {'id': 'A003', 'name': 'Jenny', 'math': 79, 'p...</code></pre><p>这时我们就需要使用到 <strong>json_normalize()</strong> 方法将内嵌的数据完整的解析出来：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> json

<span class="token comment" spellcheck="true"># 使用 Python JSON 模块载入数据</span>
<span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'nested_list.json'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 展平数据</span>
df_nested_list <span class="token operator">=</span> pd<span class="token punctuation">.</span>json_normalize<span class="token punctuation">(</span>data<span class="token punctuation">,</span> record_path <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'students'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_nested_list<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上实例输出结果为：</p>
<pre><code>     id   name  math  physics  chemistry
0  A001    Tom    60       66         61
1  A002  James    89       76         51
2  A003  Jenny    79       90         78</code></pre><p><strong>data = json.loads(f.read())</strong> 使用 Python JSON 模块载入数据。</p>
<p><strong>json_normalize()</strong> 使用了参数 <strong>record_path</strong> 并设置为 <strong>[‘students’]</strong> 用于展开内嵌的 JSON 数据 <strong>students</strong>。</p>
<p>显示结果还没有包含 school_name 和 class 元素，如果需要展示出来可以使用 meta 参数来显示这些元数据：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> json

<span class="token comment" spellcheck="true"># 使用 Python JSON 模块载入数据</span>
<span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'nested_list.json'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 展平数据</span>
df_nested_list <span class="token operator">=</span> pd<span class="token punctuation">.</span>json_normalize<span class="token punctuation">(</span>
    data<span class="token punctuation">,</span>
    record_path <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'students'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    meta<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'school_name'</span><span class="token punctuation">,</span> <span class="token string">'class'</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_nested_list<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上实例输出结果为：</p>
<pre><code>     id   name  math  physics  chemistry         school_name   class
0  A001    Tom    60       66         61  ABC primary school  Year 1
1  A002  James    89       76         51  ABC primary school  Year 1
2  A003  Jenny    79       90         78  ABC primary school  Year 1</code></pre><p>接下来，让我们尝试读取更复杂的 JSON 数据，该数据嵌套了列表和字典，数据文件 <strong>nested_mix.json</strong> 如下：</p>
<pre><code>{
    "school_name": "local primary school",
    "class": "Year 1",
    "info": {
      "president": "John Kasich",
      "address": "ABC road, London, UK",
      "contacts": {
        "email": "admin@e.com",
        "tel": "123456789"
      }
    },
    "students": [
    {
        "id": "A001",
        "name": "Tom",
        "math": 60,
        "physics": 66,
        "chemistry": 61
    },
    {
        "id": "A002",
        "name": "James",
        "math": 89,
        "physics": 76,
        "chemistry": 51
    },
    {
        "id": "A003",
        "name": "Jenny",
        "math": 79,
        "physics": 90,
        "chemistry": 78
    }]
}</code></pre><p>nested_mix.json 文件转换为 DataFrame：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> json

<span class="token comment" spellcheck="true"># 使用 Python JSON 模块载入数据</span>
<span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'nested_mix.json'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>json_normalize<span class="token punctuation">(</span>
    data<span class="token punctuation">,</span>
    record_path <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'students'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    meta<span class="token operator">=</span><span class="token punctuation">[</span>
        <span class="token string">'class'</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token string">'president'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token string">'contacts'</span><span class="token punctuation">,</span> <span class="token string">'tel'</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上实例输出结果为：</p>
<pre><code>     id   name  math  physics  chemistry   class info.president info.contacts.tel
0  A001    Tom    60       66         61  Year 1    John Kasich         123456789
1  A002  James    89       76         51  Year 1    John Kasich         123456789
2  A003  Jenny    79       90         78  Year 1    John Kasich         123456789</code></pre><h3 id="读取内嵌数据中的一组数据"><a href="#读取内嵌数据中的一组数据" class="headerlink" title="读取内嵌数据中的一组数据"></a>读取内嵌数据中的一组数据</h3><p>以下是实例文件 <strong>nested_deep.json</strong>，我们只读取内嵌中的 <strong>math</strong> 字段：</p>
<pre><code>{
    "school_name": "local primary school",
    "class": "Year 1",
    "students": [
    {
        "id": "A001",
        "name": "Tom",
        "grade": {
            "math": 60,
            "physics": 66,
            "chemistry": 61
        }

    },
    {
        "id": "A002",
        "name": "James",
        "grade": {
            "math": 89,
            "physics": 76,
            "chemistry": 51
        }

    },
    {
        "id": "A003",
        "name": "Jenny",
        "grade": {
            "math": 79,
            "physics": 90,
            "chemistry": 78
        }
    }]
}</code></pre><p>这里我们需要使用到 <strong>glom</strong> 模块来处理数据套嵌，<strong>glom</strong> 模块允许我们使用 <strong>.</strong> 来访问内嵌对象的属性。</p>
<p>第一次使用我们需要安装 glom：</p>
<pre><code>pip3 install glom</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> glom <span class="token keyword">import</span> glom

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span><span class="token string">'nested_deep.json'</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'students'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> row<span class="token punctuation">:</span> glom<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token string">'grade.math'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上实例输出结果为：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token number">0</span>    <span class="token number">60</span>
<span class="token number">1</span>    <span class="token number">89</span>
<span class="token number">2</span>    <span class="token number">79</span>
Name<span class="token punctuation">:</span> students<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h1><h2 id="一、生成数据表"><a href="#一、生成数据表" class="headerlink" title="一、生成数据表"></a>一、生成数据表</h2><p><strong>1、首先导入pandas库，一般都会用到numpy库，所以我们先导入备用：</strong></p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>2、导入CSV或者xlsx文件：</strong></p>
<pre class="line-numbers language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>‘name<span class="token punctuation">.</span>csv’<span class="token punctuation">,</span>header<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>‘name<span class="token punctuation">.</span>xlsx’<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>3、用pandas创建数据表：</strong></p>
<pre class="line-numbers language-python"><code class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"id"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">1003</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token number">1005</span><span class="token punctuation">,</span><span class="token number">1006</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
 <span class="token string">"date"</span><span class="token punctuation">:</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'20130102'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token string">"city"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Beijing '</span><span class="token punctuation">,</span> <span class="token string">'SH'</span><span class="token punctuation">,</span> <span class="token string">' guangzhou '</span><span class="token punctuation">,</span> <span class="token string">'Shenzhen'</span><span class="token punctuation">,</span> <span class="token string">'shanghai'</span><span class="token punctuation">,</span> <span class="token string">'BEIJING '</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token string">"age"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token string">"category"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'100-A'</span><span class="token punctuation">,</span><span class="token string">'100-B'</span><span class="token punctuation">,</span><span class="token string">'110-A'</span><span class="token punctuation">,</span><span class="token string">'110-C'</span><span class="token punctuation">,</span><span class="token string">'210-A'</span><span class="token punctuation">,</span><span class="token string">'130-F'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"price"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1200</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span><span class="token number">2133</span><span class="token punctuation">,</span><span class="token number">5433</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span><span class="token number">4432</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  columns <span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'date'</span><span class="token punctuation">,</span><span class="token string">'city'</span><span class="token punctuation">,</span><span class="token string">'category'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">,</span><span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="二、数据表信息查看"><a href="#二、数据表信息查看" class="headerlink" title="二、数据表信息查看"></a>二、数据表信息查看</h2><p><strong>1、维度查看：</strong></p>
<p>df.shape</p>
<p><strong>2、数据表基本信息（维度、列名称、数据格式、所占空间等）：</strong></p>
<p>df.info()</p>
<p><strong>3、每一列数据的格式：</strong></p>
<p>df.dtypes</p>
<p><strong>4、某一列格式：</strong></p>
<p>df[‘B’].dtype</p>
<p><strong>5、空值：</strong></p>
<p>df.isnull()</p>
<p><strong>6、查看某一列空值：</strong></p>
<p>df.isnull()</p>
<p><strong>7、查看某一列的唯一值：</strong></p>
<p>df[‘B’].unique()</p>
<p><strong>8、查看数据表的值：</strong></p>
<p>df.values</p>
<p><strong>9、查看列名称：</strong></p>
<p>df.columns</p>
<p><strong>10、查看前10行数据、后10行数据：</strong></p>
<pre class="line-numbers language-python"><code class="language-python">df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#默认前10行数据 </span>
df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#默认后10 行数据</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2 id="三、数据表清洗"><a href="#三、数据表清洗" class="headerlink" title="三、数据表清洗"></a>三、数据表清洗</h2><p><strong>1、用数字0填充空值：</strong></p>
<p>df.fillna(value=0)</p>
<p><strong>2、使用列prince的均值对NA进行填充：</strong></p>
<p>df[‘prince’].fillna(df[‘prince’].mean())</p>
<p><strong>3、清楚city字段的字符空格：</strong></p>
<p>df[‘city’]=df[‘city’].map(str.strip)</p>
<p><strong>4、大小写转换：</strong></p>
<p>df[‘city’]=df[‘city’].str.lower()</p>
<p><strong>5、更改数据格式：</strong></p>
<p>df[‘price’].astype(‘int’)</p>
<p><strong>6、更改列名称：</strong></p>
<p>df.rename(columns={‘category’: ‘category-size’})</p>
<p><strong>7、删除后出现的重复值：</strong></p>
<p>df[‘city’].drop_duplicates()</p>
<p><strong>8、删除先出现的重复值：</strong></p>
<p>df[‘city’].drop_duplicates(keep=’last’)</p>
<p><strong>9、数据替换：</strong></p>
<p>df[‘city’].replace(‘sh’, ‘shanghai’)</p>
<h2 id="四、数据预处理"><a href="#四、数据预处理" class="headerlink" title="四、数据预处理"></a>四、数据预处理</h2><pre class="line-numbers language-python"><code class="language-python">df1<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"id"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">1003</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token number">1005</span><span class="token punctuation">,</span><span class="token number">1006</span><span class="token punctuation">,</span><span class="token number">1007</span><span class="token punctuation">,</span><span class="token number">1008</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
<span class="token string">"gender"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'male'</span><span class="token punctuation">,</span><span class="token string">'female'</span><span class="token punctuation">,</span><span class="token string">'male'</span><span class="token punctuation">,</span><span class="token string">'female'</span><span class="token punctuation">,</span><span class="token string">'male'</span><span class="token punctuation">,</span><span class="token string">'female'</span><span class="token punctuation">,</span><span class="token string">'male'</span><span class="token punctuation">,</span><span class="token string">'female'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token string">"pay"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Y'</span><span class="token punctuation">,</span><span class="token string">'N'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">,</span><span class="token string">'N'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">,</span><span class="token string">'N'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token string">"m-point"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="1、数据表合并"><a href="#1、数据表合并" class="headerlink" title="1、数据表合并"></a>1、数据表合并</h4><p>1.1 merge</p>
<pre class="line-numbers language-python"><code class="language-python">df_inner<span class="token operator">=</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span>df1<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 匹配合并，交集</span>
df_left<span class="token operator">=</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span>df1<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#</span>
df_right<span class="token operator">=</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span>df1<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">)</span>
df_outer<span class="token operator">=</span>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df<span class="token punctuation">,</span>df1<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">#并集</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>1.2 append</p>
<pre class="line-numbers language-python"><code class="language-python">result <span class="token operator">=</span> df1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/loading.gif" data-original="../images/basic/1240-1627231668602870" alt=""></p>
<p>1.3 join</p>
<pre class="line-numbers language-python"><code class="language-python">result <span class="token operator">=</span> left<span class="token punctuation">.</span>join<span class="token punctuation">(</span>right<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'key'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/loading.gif" data-original="../images/basic/1240-1627231671478872" alt=""></p>
<p>1.4 concat</p>
<pre class="line-numbers language-python"><code class="language-python">pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>objs<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> join<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">,</span> join_axes<span class="token operator">=</span>None<span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
          keys<span class="token operator">=</span>None<span class="token punctuation">,</span> levels<span class="token operator">=</span>None<span class="token punctuation">,</span> names<span class="token operator">=</span>None<span class="token punctuation">,</span> verify_integrity<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
          copy<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>objs︰ 一个序列或系列、 综合或面板对象的映射。如果字典中传递，将作为键参数，使用排序的键，除非它传递，在这种情况下的值将会选择 （见下文）。任何没有任何反对将默默地被丢弃，除非他们都没有在这种情况下将引发 ValueError。 </li>
<li>axis: {0，1，…}，默认值为 0。要连接沿轴。 </li>
<li>join: {‘内部’、 ‘外’}，默认 ‘外’。如何处理其他 axis(es) 上的索引。联盟内、 外的交叉口。 </li>
<li>ignore_index︰ 布尔值、 默认 False。如果为 True，则不要串联轴上使用的索引值。由此产生的轴将标记 0，…，n-1。这是有用的如果你串联串联轴没有有意义的索引信息的对象。请注意在联接中仍然受到尊重的其他轴上的索引值。 </li>
<li>join_axes︰ 索引对象的列表。具体的指标，用于其他 n-1 轴而不是执行内部/外部设置逻辑。 </li>
<li>keys︰ 序列，默认为无。构建分层索引使用通过的键作为最外面的级别。如果多个级别获得通过，应包含元组。 </li>
<li>levels︰ 列表的序列，默认为无。具体水平 （唯一值） 用于构建多重。否则，他们将推断钥匙。 </li>
<li>names︰ 列表中，默认为无。由此产生的分层索引中的级的名称。 </li>
<li>verify_integrity︰ 布尔值、 默认 False。检查是否新的串联的轴包含重复项。这可以是相对于实际数据串联非常昂贵。<br>副本︰ 布尔值、 默认 True。如果为 False，请不要，不必要地复制数据。</li>
</ul>
<p>例子：</p>
<pre class="line-numbers language-python"><code class="language-python">frames <span class="token operator">=</span> <span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> df3<span class="token punctuation">]</span> 
result <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>frames<span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="/images/loading.gif" data-original="../images/basic/1240-1627231679346874" alt=""></p>
<h4 id="2、设置索引列"><a href="#2、设置索引列" class="headerlink" title="2、设置索引列"></a>2、设置索引列</h4><p>df_inner.set_index(‘id’)</p>
<h4 id="3、按照特定列的值排序："><a href="#3、按照特定列的值排序：" class="headerlink" title="3、按照特定列的值排序："></a>3、按照特定列的值排序：</h4><p>df_inner.sort_values(by=[‘age’])</p>
<h4 id="4、按照索引列排序："><a href="#4、按照索引列排序：" class="headerlink" title="4、按照索引列排序："></a>4、按照索引列排序：</h4><p>df_inner.sort_index()</p>
<h4 id="5、如果prince列的值-gt-3000，group列显示high，否则显示low："><a href="#5、如果prince列的值-gt-3000，group列显示high，否则显示low：" class="headerlink" title="5、如果prince列的值>3000，group列显示high，否则显示low："></a>5、如果prince列的值&gt;3000，group列显示high，否则显示low：</h4><p>df_inner[‘group’] = np.where(df_inner[‘price’] &gt; 3000,’high’,’low’)</p>
<h4 id="6、对复合多个条件的数据进行分组标记"><a href="#6、对复合多个条件的数据进行分组标记" class="headerlink" title="6、对复合多个条件的数据进行分组标记"></a>6、对复合多个条件的数据进行分组标记</h4><p>df_inner.loc[(df_inner[‘city’] == ‘beijing’) &amp; (df_inner[‘price’] &gt;= 4000), ‘sign’]=1</p>
<h4 id="7、对category字段的值依次进行分列，并创建数据表，索引值为df-inner的索引列，列名称为category和size"><a href="#7、对category字段的值依次进行分列，并创建数据表，索引值为df-inner的索引列，列名称为category和size" class="headerlink" title="7、对category字段的值依次进行分列，并创建数据表，索引值为df_inner的索引列，列名称为category和size"></a>7、对category字段的值依次进行分列，并创建数据表，索引值为df_inner的索引列，列名称为category和size</h4><p>pd.DataFrame((x.split(‘-‘) for x in df_inner[‘category’]),index=df_inner.index,columns=[‘category’,’size’]))</p>
<h4 id="8、将完成分裂后的数据表和原df-inner数据表进行匹配"><a href="#8、将完成分裂后的数据表和原df-inner数据表进行匹配" class="headerlink" title="8、将完成分裂后的数据表和原df_inner数据表进行匹配"></a>8、将完成分裂后的数据表和原df_inner数据表进行匹配</h4><p>df_inner=pd.merge(df_inner,split,right_index=True, left_index=True)</p>
<h2 id="五、数据提取"><a href="#五、数据提取" class="headerlink" title="五、数据提取"></a>五、数据提取</h2><p>主要用到的三个函数：loc,iloc和ix，loc函数按标签值进行提取，iloc按位置进行提取，ix可以同时按标签和位置进行提取。</p>
<p><strong>1、按索引提取单行的数值</strong></p>
<p>df_inner.loc[3]</p>
<p><strong>2、按索引提取区域行数值</strong></p>
<p>df_inner.iloc[0:5]</p>
<p><strong>3、重设索引</strong></p>
<p>df_inner.reset_index()</p>
<p><strong>4、设置日期为索引</strong></p>
<p>df_inner=df_inner.set_index(‘date’)</p>
<p><strong>5、提取4日之前的所有数据</strong></p>
<p>df_inner[:’2013-01-04’]</p>
<p><strong>6、使用iloc按位置区域提取数据</strong></p>
<p>df_inner.iloc[:3,:2] #冒号前后的数字不再是索引的标签名称，而是数据所在的位置，从0开始，前三行，前两列。</p>
<p><strong>7、适应iloc按位置单独提起数据</strong></p>
<p>df_inner.iloc[[0,2,5],[4,5]] #提取第0、2、5行，4、5列</p>
<p><strong>8、使用ix按索引标签和位置混合提取数据</strong></p>
<p>df_inner.ix[:’2013-01-03’,:4] #2013-01-03号之前，前四列数据</p>
<p><strong>9、判断city列的值是否为北京</strong></p>
<p>df_inner[‘city’].isin([‘beijing’])</p>
<p><strong>10、判断city列里是否包含beijing和shanghai，然后将符合条件的数据提取出来</strong></p>
<p>df_inner.loc[df_inner[‘city’].isin([‘beijing’,’shanghai’])]</p>
<p><strong>11、提取前三个字符，并生成数据表</strong></p>
<p>pd.DataFrame(category.str[:3])</p>
<h2 id="六、数据筛选"><a href="#六、数据筛选" class="headerlink" title="六、数据筛选"></a>六、数据筛选</h2><p>使用与、或、非三个条件配合大于、小于、等于对数据进行筛选，并进行计数和求和。</p>
<p><strong>1、使用“与”进行筛选</strong></p>
<p>df_inner.loc[(df_inner[‘age’] &gt; 25) &amp; (df_inner[‘city’] == ‘beijing’), [‘id’,’city’,’age’,’category’,’gender’]]</p>
<p><strong>2、使用“或”进行筛选</strong></p>
<p>df_inner.loc[(df_inner[‘age’] &gt; 25) | (df_inner[‘city’] == ‘beijing’), [‘id’,’city’,’age’,’category’,’gender’]].sort([‘age’])</p>
<p><strong>3、使用“非”条件进行筛选</strong></p>
<p>df_inner.loc[(df_inner[‘city’] != ‘beijing’), [‘id’,’city’,’age’,’category’,’gender’]].sort([‘id’])</p>
<p><strong>4、对筛选后的数据按city列进行计数</strong></p>
<p>df_inner.loc[(df_inner[‘city’] != ‘beijing’), [‘id’,’city’,’age’,’category’,’gender’]].sort([‘id’]).city.count()</p>
<p><strong>5、使用query函数进行筛选</strong></p>
<p>df_inner.query(‘city == [“beijing”, “shanghai”]’)</p>
<p><strong>6、对筛选后的结果按prince进行求和</strong></p>
<p>df_inner.query(‘city == [“beijing”, “shanghai”]’).price.sum()</p>
<h2 id="七、数据汇总"><a href="#七、数据汇总" class="headerlink" title="七、数据汇总"></a>七、数据汇总</h2><p>主要函数是groupby和pivote_table</p>
<p><strong>1、对所有的列进行计数汇总</strong></p>
<p>df_inner.groupby(‘city’).count()</p>
<p><strong>2、按城市对id字段进行计数</strong></p>
<p>df_inner.groupby(‘city’)[‘id’].count()</p>
<p><strong>3、对两个字段进行汇总计数</strong></p>
<p>df_inner.groupby([‘city’,’size’])[‘id’].count()</p>
<p><strong>4、对city字段进行汇总，并分别计算prince的合计和均值</strong></p>
<p>df_inner.groupby(‘city’)[‘price’].agg([len,np.sum, np.mean])</p>
<h2 id="八、数据统计"><a href="#八、数据统计" class="headerlink" title="八、数据统计"></a>八、数据统计</h2><p>数据采样，计算标准差，协方差和相关系数</p>
<p><strong>1、简单的数据采样</strong></p>
<p>df_inner.sample(n=3)</p>
<p><strong>2、手动设置采样权重</strong></p>
<pre><code>weights = [0, 0, 0, 0, 0.5, 0.5] 
df_inner.sample(n=2, weights=weights)</code></pre><p><strong>3、采样后不放回</strong></p>
<p>df_inner.sample(n=6, replace=False)</p>
<p><strong>4、采样后放回</strong></p>
<p>df_inner.sample(n=6, replace=True)</p>
<p><strong>5、 数据表描述性统计</strong></p>
<p>df_inner.describe().round(2).T #round函数设置显示小数位，T表示转置</p>
<p><strong>6、计算列的标准差</strong></p>
<p>df_inner[‘price’].std()</p>
<p><strong>7、计算两个字段间的协方差</strong></p>
<p>df_inner[‘price’].cov(df_inner[‘m-point’])</p>
<p><strong>8、数据表中所有字段间的协方差</strong></p>
<p>df_inner.cov()</p>
<p><strong>9、两个字段的相关性分析</strong></p>
<p>df_inner[‘price’].corr(df_inner[‘m-point’]) #相关系数在-1到1之间，接近1为正相关，接近-1为负相关，0为不相关</p>
<p><strong>10、数据表的相关性分析</strong></p>
<p>df_inner.corr()</p>
<h2 id="九、数据输出"><a href="#九、数据输出" class="headerlink" title="九、数据输出"></a>九、数据输出</h2><p>分析后的数据可以输出为xlsx格式和csv格式</p>
<p><strong>1、写入Excel</strong></p>
<p>df_inner.to_excel(‘excel_to_python.xlsx’, sheet_name=’bluewhale_cc’)</p>
<p><strong>2、写入到CSV</strong></p>
<p>df_inner.to_csv(‘excel_to_python.csv’)</p>
<h1 id="100-个-Pandas-函数汇总"><a href="#100-个-Pandas-函数汇总" class="headerlink" title="100 个 Pandas 函数汇总"></a>100 个 Pandas 函数汇总</h1><h2 id="统计汇总函数"><a href="#统计汇总函数" class="headerlink" title="统计汇总函数"></a><strong>统计汇总函数</strong></h2><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody><tr>
<td>min()</td>
<td>计算最小值</td>
</tr>
<tr>
<td>max()</td>
<td>计算最大值</td>
</tr>
<tr>
<td>sum()</td>
<td>求和</td>
</tr>
<tr>
<td>mean()</td>
<td>计算平均值</td>
</tr>
<tr>
<td>count()</td>
<td>计数（统计非缺失元素的个数）</td>
</tr>
<tr>
<td>size()</td>
<td>计数（统计所有元素的个数）</td>
</tr>
<tr>
<td>median()</td>
<td>计算中位数</td>
</tr>
<tr>
<td>var()</td>
<td>计算方差</td>
</tr>
<tr>
<td>std()</td>
<td>计算标准差</td>
</tr>
<tr>
<td>quantile()</td>
<td>计算任意分位数</td>
</tr>
<tr>
<td>cov()</td>
<td>计算协方差</td>
</tr>
<tr>
<td>corr()</td>
<td>计算相关系数</td>
</tr>
<tr>
<td>skew()</td>
<td>计算偏度</td>
</tr>
<tr>
<td>kurt()</td>
<td>计算峰度</td>
</tr>
<tr>
<td>mode()</td>
<td>计算众数</td>
</tr>
<tr>
<td>describe()</td>
<td>描述性统计（一次性返回多个统计结果）</td>
</tr>
<tr>
<td>groupby()</td>
<td>分组</td>
</tr>
<tr>
<td>aggregate()</td>
<td>聚合运算（可以自定义统计函数）</td>
</tr>
<tr>
<td>argmin()</td>
<td>寻找最小值所在位置</td>
</tr>
<tr>
<td>argmax()</td>
<td>寻找最大值所在位置</td>
</tr>
<tr>
<td>any()</td>
<td>等价于逻辑“或”</td>
</tr>
<tr>
<td>all()</td>
<td>等价于逻辑“与”</td>
</tr>
<tr>
<td>value_counts()</td>
<td>频次统计</td>
</tr>
<tr>
<td>cumsum()</td>
<td>运算累计和</td>
</tr>
<tr>
<td>cumprod()</td>
<td>运算累计积</td>
</tr>
<tr>
<td>pct­­_change()</td>
<td>运算比率（后一个元素与前一个元素的比率）</td>
</tr>
</tbody></table>
<h2 id="数据清洗函数"><a href="#数据清洗函数" class="headerlink" title="数据清洗函数"></a><strong>数据清洗函数</strong></h2><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody><tr>
<td>duplicated()</td>
<td>判断序列元素是否重复</td>
</tr>
<tr>
<td>drop_duplicates()</td>
<td>删除重复值</td>
</tr>
<tr>
<td>hasnans()</td>
<td>判断序列是否存在缺失（返回TRUE或FALSE）</td>
</tr>
<tr>
<td>isnull()</td>
<td>判断序列元素是否为缺失（返回与序列长度一样的bool值）</td>
</tr>
<tr>
<td>notnull()</td>
<td>判断序列元素是否不为缺失（返回与序列长度一样的bool值）</td>
</tr>
<tr>
<td>dropna()</td>
<td>删除缺失值</td>
</tr>
<tr>
<td>fillna()</td>
<td>缺失值填充</td>
</tr>
<tr>
<td>ffill()</td>
<td>前向后填充缺失值（使用缺失值的前一个元素填充）</td>
</tr>
<tr>
<td>bfill()</td>
<td>后向填充缺失值（使用缺失值的后一个元素填充）</td>
</tr>
<tr>
<td>dtypes()</td>
<td>检查数据类型</td>
</tr>
<tr>
<td>astype()</td>
<td>类型强制转换</td>
</tr>
<tr>
<td>pd.to_datetime</td>
<td>转日期时间型</td>
</tr>
<tr>
<td>factorize()</td>
<td>因子化转换</td>
</tr>
<tr>
<td>sample()</td>
<td>抽样</td>
</tr>
<tr>
<td>where()</td>
<td>基于条件判断的值替换</td>
</tr>
<tr>
<td>replace()</td>
<td>按值替换（不可使用正则）</td>
</tr>
<tr>
<td>str.replace()</td>
<td>按值替换（可使用正则）</td>
</tr>
<tr>
<td>str.split.str()</td>
<td>字符分隔</td>
</tr>
</tbody></table>
<h2 id="数据筛选函数"><a href="#数据筛选函数" class="headerlink" title="数据筛选函数"></a><strong>数据筛选函数</strong></h2><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody><tr>
<td>isin()</td>
<td>成员关系判断</td>
</tr>
<tr>
<td>between()</td>
<td>区间判断</td>
</tr>
<tr>
<td>loc()</td>
<td>条件判断（可使用在数据框中）</td>
</tr>
<tr>
<td>iloc()</td>
<td>索引判断（可使用在数据框中）</td>
</tr>
<tr>
<td>compress()</td>
<td>条件判断</td>
</tr>
<tr>
<td>nlargest()</td>
<td>搜寻最大的n个元素</td>
</tr>
<tr>
<td>nsmallest()</td>
<td>搜寻最小的n个元素</td>
</tr>
<tr>
<td>str.findall()</td>
<td>子串查询（可使用正则）</td>
</tr>
</tbody></table>
<h2 id="绘图与元素级运算函数"><a href="#绘图与元素级运算函数" class="headerlink" title="绘图与元素级运算函数"></a><strong>绘图与元素级运算函数</strong></h2><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody><tr>
<td>hist()</td>
<td>绘制直方图</td>
</tr>
<tr>
<td>plot()</td>
<td>可基于kind参数绘制更多图形（饼图，折线图，箱线图等）</td>
</tr>
<tr>
<td>map()</td>
<td>元素映射</td>
</tr>
<tr>
<td>apply()</td>
<td>基于自定义函数的元素级操作</td>
</tr>
</tbody></table>
<h2 id="时间序列函数"><a href="#时间序列函数" class="headerlink" title="时间序列函数"></a><strong>时间序列函数</strong></h2><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody><tr>
<td>dt.date()</td>
<td>抽取出日期值</td>
</tr>
<tr>
<td>dt.time()</td>
<td>抽取出时间（时分秒）</td>
</tr>
<tr>
<td>dt.year()</td>
<td>抽取出年</td>
</tr>
<tr>
<td>dt.mouth()</td>
<td>抽取出月</td>
</tr>
<tr>
<td>dt.day()</td>
<td>抽取出日</td>
</tr>
<tr>
<td>dt.hour()</td>
<td>抽取出时</td>
</tr>
<tr>
<td>dt.minute()</td>
<td>抽取出分钟</td>
</tr>
<tr>
<td>dt.second()</td>
<td>抽取出秒</td>
</tr>
<tr>
<td>dt.quarter()</td>
<td>抽取出季度</td>
</tr>
<tr>
<td>dt.weekday()</td>
<td>抽取出星期几（返回数值型）</td>
</tr>
<tr>
<td>dt.weekday_name()</td>
<td>抽取出星期几（返回字符型）</td>
</tr>
<tr>
<td>dt.week()</td>
<td>抽取出年中的第几周</td>
</tr>
<tr>
<td>dt.dayofyear()</td>
<td>抽取出年中的第几天</td>
</tr>
<tr>
<td>dt.daysinmonth()</td>
<td>抽取出月对应的最大天数</td>
</tr>
<tr>
<td>dt.is_month_start()</td>
<td>判断日期是否为当月的第一天</td>
</tr>
<tr>
<td>dt.is_month_end()</td>
<td>判断日期是否为当月的最后一天</td>
</tr>
<tr>
<td>dt.is_quarter_start()</td>
<td>判断日期是否为当季度的第一天</td>
</tr>
<tr>
<td>dt.is_quarter_end()</td>
<td>判断日期是否为当季度的最后一天</td>
</tr>
<tr>
<td>dt.is_year_start()</td>
<td>判断日期是否为当年的第一天</td>
</tr>
<tr>
<td>dt.is_year_end()</td>
<td>判断日期是否为当年的最后一天</td>
</tr>
<tr>
<td>dt.is_leap_year()</td>
<td>判断日期是否为闰年</td>
</tr>
</tbody></table>
<h2 id="其它函数"><a href="#其它函数" class="headerlink" title="其它函数"></a><strong>其它函数</strong></h2><table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody><tr>
<td>append()</td>
<td>序列元素的追加（需指定其他序列）</td>
</tr>
<tr>
<td>diff()</td>
<td>一阶差分</td>
</tr>
<tr>
<td>round()</td>
<td>元素的四舍五入</td>
</tr>
<tr>
<td>sort_values()</td>
<td>按值排序</td>
</tr>
<tr>
<td>sort_index()</td>
<td>按索引排序</td>
</tr>
<tr>
<td>to_dict()</td>
<td>转为字典</td>
</tr>
<tr>
<td>tolist()</td>
<td>转为列表</td>
</tr>
<tr>
<td>unique()</td>
<td>元素排重</td>
</tr>
</tbody></table>
<h1 id="90个Pandas案例"><a href="#90个Pandas案例" class="headerlink" title="90个Pandas案例"></a>90个Pandas案例</h1><h2 id="1如何使用列表和字典创建-Series"><a href="#1如何使用列表和字典创建-Series" class="headerlink" title="1如何使用列表和字典创建 Series"></a>1如何使用列表和字典创建 Series</h2><h3 id="使用列表创建-Series"><a href="#使用列表创建-Series" class="headerlink" title="使用列表创建 Series"></a>使用列表创建 Series</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

ser1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4.5</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>0    1.5
1    2.5
2    3.0
3    4.5
4    5.0
5    6.0
dtype: float64</code></pre><h3 id="使用-name-参数创建-Series"><a href="#使用-name-参数创建-Series" class="headerlink" title="使用 name 参数创建 Series"></a>使用 name 参数创建 Series</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

ser2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"India"</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"Germany"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"Countries"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>0      India
1     Canada
2    Germany
Name: Countries, dtype: object</code></pre><h3 id="使用简写的列表创建-Series"><a href="#使用简写的列表创建-Series" class="headerlink" title="使用简写的列表创建 Series"></a>使用简写的列表创建 Series</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

ser3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"A"</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser3<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>0    A
1    A
2    A
3    A
dtype: object</code></pre><h3 id="使用字典创建-Series"><a href="#使用字典创建-Series" class="headerlink" title="使用字典创建 Series"></a>使用字典创建 Series</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

ser4 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"India"</span><span class="token punctuation">:</span> <span class="token string">"New Delhi"</span><span class="token punctuation">,</span>
                  <span class="token string">"Japan"</span><span class="token punctuation">:</span> <span class="token string">"Tokyo"</span><span class="token punctuation">,</span>
                  <span class="token string">"UK"</span><span class="token punctuation">:</span> <span class="token string">"London"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser4<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>India    New Delhi
Japan        Tokyo
UK          London
dtype: object</code></pre><h2 id="2如何使用-Numpy-函数创建-Series"><a href="#2如何使用-Numpy-函数创建-Series" class="headerlink" title="2如何使用 Numpy 函数创建 Series"></a>2如何使用 Numpy 函数创建 Series</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

ser1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">)</span>

ser2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>0     1.00
1     3.25
2     5.50
3     7.75
4    10.00
dtype: float64
0   -1.694452
1   -1.570006
2    1.713794
3    0.338292
4    0.803511
dtype: float64</code></pre><h2 id="3如何获取-Series-的索引和值"><a href="#3如何获取-Series-的索引和值" class="headerlink" title="3如何获取 Series 的索引和值"></a>3如何获取 Series 的索引和值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

ser1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"India"</span><span class="token punctuation">:</span> <span class="token string">"New Delhi"</span><span class="token punctuation">,</span>
                  <span class="token string">"Japan"</span><span class="token punctuation">:</span> <span class="token string">"Tokyo"</span><span class="token punctuation">,</span>
                  <span class="token string">"UK"</span><span class="token punctuation">:</span> <span class="token string">"London"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>values<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>index<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>

ser2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser2<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser2<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>['New Delhi' 'Tokyo' 'London']
Index(['India', 'Japan', 'UK'], dtype='object')


RangeIndex(start=0, stop=5, step=1)
[ 0.66265478 -0.72222211  0.3608642   1.40955436  1.3096732 ]</code></pre><h2 id="4如何在创建-Series-时指定索引"><a href="#4如何在创建-Series-时指定索引" class="headerlink" title="4如何在创建 Series 时指定索引"></a>4如何在创建 Series 时指定索引</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"India"</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"Australia"</span><span class="token punctuation">,</span>
          <span class="token string">"Japan"</span><span class="token punctuation">,</span> <span class="token string">"Germany"</span><span class="token punctuation">,</span> <span class="token string">"France"</span><span class="token punctuation">]</span>

code <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"IND"</span><span class="token punctuation">,</span> <span class="token string">"CAN"</span><span class="token punctuation">,</span> <span class="token string">"AUS"</span><span class="token punctuation">,</span> <span class="token string">"JAP"</span><span class="token punctuation">,</span> <span class="token string">"GER"</span><span class="token punctuation">,</span> <span class="token string">"FRA"</span><span class="token punctuation">]</span>

ser1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>values<span class="token punctuation">,</span> index<span class="token operator">=</span>code<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>IND        India
CAN       Canada
AUS    Australia
JAP        Japan
GER      Germany
FRA       France
dtype: object</code></pre><h2 id="5如何获取-Series-的大小和形状"><a href="#5如何获取-Series-的大小和形状" class="headerlink" title="5如何获取 Series 的大小和形状"></a>5如何获取 Series 的大小和形状</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"India"</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"Australia"</span><span class="token punctuation">,</span>
          <span class="token string">"Japan"</span><span class="token punctuation">,</span> <span class="token string">"Germany"</span><span class="token punctuation">,</span> <span class="token string">"France"</span><span class="token punctuation">]</span>

code <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"IND"</span><span class="token punctuation">,</span> <span class="token string">"CAN"</span><span class="token punctuation">,</span> <span class="token string">"AUS"</span><span class="token punctuation">,</span> <span class="token string">"JAP"</span><span class="token punctuation">,</span> <span class="token string">"GER"</span><span class="token punctuation">,</span> <span class="token string">"FRA"</span><span class="token punctuation">]</span>

ser1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>values<span class="token punctuation">,</span> index<span class="token operator">=</span>code<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>ser1<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>6
(6,)
6</code></pre><h2 id="6如何获取-Series-开始或末尾几行数据"><a href="#6如何获取-Series-开始或末尾几行数据" class="headerlink" title="6如何获取 Series 开始或末尾几行数据"></a>6如何获取 Series 开始或末尾几行数据</h2><h3 id="Head"><a href="#Head" class="headerlink" title="Head()"></a>Head()</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"India"</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"Australia"</span><span class="token punctuation">,</span>
          <span class="token string">"Japan"</span><span class="token punctuation">,</span> <span class="token string">"Germany"</span><span class="token punctuation">,</span> <span class="token string">"France"</span><span class="token punctuation">]</span>

code <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"IND"</span><span class="token punctuation">,</span> <span class="token string">"CAN"</span><span class="token punctuation">,</span> <span class="token string">"AUS"</span><span class="token punctuation">,</span> <span class="token string">"JAP"</span><span class="token punctuation">,</span> <span class="token string">"GER"</span><span class="token punctuation">,</span> <span class="token string">"FRA"</span><span class="token punctuation">]</span>

ser1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>values<span class="token punctuation">,</span> index<span class="token operator">=</span>code<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-----Head()-----"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n\n-----Head(2)-----"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>-----Head()-----
IND        India
CAN       Canada
AUS    Australia
JAP        Japan
GER      Germany
dtype: object


-----Head(2)-----
IND     India
CAN    Canada
dtype: object</code></pre><h3 id="Tail"><a href="#Tail" class="headerlink" title="Tail()"></a>Tail()</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"India"</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"Australia"</span><span class="token punctuation">,</span>
          <span class="token string">"Japan"</span><span class="token punctuation">,</span> <span class="token string">"Germany"</span><span class="token punctuation">,</span> <span class="token string">"France"</span><span class="token punctuation">]</span>

code <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"IND"</span><span class="token punctuation">,</span> <span class="token string">"CAN"</span><span class="token punctuation">,</span> <span class="token string">"AUS"</span><span class="token punctuation">,</span> <span class="token string">"JAP"</span><span class="token punctuation">,</span> <span class="token string">"GER"</span><span class="token punctuation">,</span> <span class="token string">"FRA"</span><span class="token punctuation">]</span>

ser1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>values<span class="token punctuation">,</span> index<span class="token operator">=</span>code<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-----Tail()-----"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n\n-----Tail(2)-----"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>-----Tail()-----
CAN       Canada
AUS    Australia
JAP        Japan
GER      Germany
FRA       France
dtype: object


-----Tail(2)-----
GER    Germany
FRA     France
dtype: object</code></pre><h3 id="Take"><a href="#Take" class="headerlink" title="Take()"></a>Take()</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"India"</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"Australia"</span><span class="token punctuation">,</span>
          <span class="token string">"Japan"</span><span class="token punctuation">,</span> <span class="token string">"Germany"</span><span class="token punctuation">,</span> <span class="token string">"France"</span><span class="token punctuation">]</span>

code <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"IND"</span><span class="token punctuation">,</span> <span class="token string">"CAN"</span><span class="token punctuation">,</span> <span class="token string">"AUS"</span><span class="token punctuation">,</span> <span class="token string">"JAP"</span><span class="token punctuation">,</span> <span class="token string">"GER"</span><span class="token punctuation">,</span> <span class="token string">"FRA"</span><span class="token punctuation">]</span>

ser1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>values<span class="token punctuation">,</span> index<span class="token operator">=</span>code<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-----Take()-----"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser1<span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>-----Take()-----
AUS    Australia
GER      Germany
FRA       France
dtype: object</code></pre><h2 id="7使用切片获取-Series-子集"><a href="#7使用切片获取-Series-子集" class="headerlink" title="7使用切片获取 Series 子集"></a>7使用切片获取 Series 子集</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

num <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">000</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">900</span><span class="token punctuation">]</span>

idx <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token string">'H'</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token string">'J'</span><span class="token punctuation">]</span>

series <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>num<span class="token punctuation">,</span> index<span class="token operator">=</span>idx<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n [2:2] \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>series<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n [1:6:2] \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>series<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n [:6] \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>series<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n [4:] \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>series<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n [:4:2] \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>series<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n [4::2] \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>series<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n [::-1] \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>series<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output</p>
<pre><code> [2:2]

C    200
D    300
dtype: int64

 [1:6:2]

B    100
D    300
F    500
dtype: int64

 [:6]

A      0
B    100
C    200
D    300
E    400
F    500
dtype: int64

 [4:]

E    400
F    500
G    600
H    700
I    800
J    900
dtype: int64

 [:4:2]

A      0
C    200
dtype: int64

 [4::2]

E    400
G    600
I    800
dtype: int64

 [::-1]

J    900
I    800
H    700
G    600
F    500
E    400
D    300
C    200
B    100
A      0
dtype: int64</code></pre><h2 id="8如何创建-DataFrame"><a href="#8如何创建-DataFrame" class="headerlink" title="8如何创建 DataFrame"></a>8如何创建 DataFrame</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp00'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John Doe'</span><span class="token punctuation">,</span> <span class="token string">'William Spark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>   Age Date Of Join EmpCode           Name    Occupation
0   23   2018-01-25  Emp001       John Doe       Chemist
1   24   2018-01-26   Emp00  William Spark  Statistician</code></pre><h2 id="9如何设置-DataFrame-的索引和列信息"><a href="#9如何设置-DataFrame-的索引和列信息" class="headerlink" title="9如何设置 DataFrame 的索引和列信息"></a>9如何设置 DataFrame 的索引和列信息</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>
    data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John Doe'</span><span class="token punctuation">,</span> <span class="token string">'William Spark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'Occupation'</span><span class="token punctuation">,</span> <span class="token string">'Date Of Join'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output</p>
<pre><code>                 Name    Occupation Date Of Join  Age
Emp001       John Doe       Chemist   2018-01-25   23
Emp002  William Spark  Statistician   2018-01-26   24</code></pre><h2 id="10如何重命名-DataFrame-的列名称"><a href="#10如何重命名-DataFrame-的列名称" class="headerlink" title="10如何重命名 DataFrame 的列名称"></a>10如何重命名 DataFrame 的列名称</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp00'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John Doe'</span><span class="token punctuation">,</span> <span class="token string">'William Spark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

employees<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'EmpCode'</span><span class="token punctuation">,</span> <span class="token string">'EmpName'</span><span class="token punctuation">,</span> <span class="token string">'EmpOccupation'</span><span class="token punctuation">,</span> <span class="token string">'EmpDOJ'</span><span class="token punctuation">,</span> <span class="token string">'EmpAge'</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>   EmpCode     EmpName EmpOccupation         EmpDOJ        EmpAge
0       23  2018-01-25        Emp001       John Doe       Chemist
1       24  2018-01-26         Emp00  William Spark  Statistician</code></pre><h2 id="11如何根据-Pandas-列中的值从-DataFrame-中选择或过滤行"><a href="#11如何根据-Pandas-列中的值从-DataFrame-中选择或过滤行" class="headerlink" title="11如何根据 Pandas 列中的值从 DataFrame 中选择或过滤行"></a>11如何根据 Pandas 列中的值从 DataFrame 中选择或过滤行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nUse == operator\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>employees<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nUse &lt; operator\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>employees<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nUse != operator\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>employees<span class="token punctuation">[</span><span class="token string">'Occupation'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'Statistician'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nMultiple Conditions\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>employees<span class="token punctuation">[</span><span class="token string">'Occupation'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'Statistician'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>
                    <span class="token punctuation">(</span>employees<span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'John'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>Use == operator

   Age Date Of Join EmpCode  Name Occupation
0   23   2018-01-25  Emp001  John    Chemist

Use &lt; operator

   Age Date Of Join EmpCode   Name    Occupation
0   23   2018-01-25  Emp001   John       Chemist
1   24   2018-01-26  Emp002    Doe  Statistician
3   29   2018-02-26  Emp004  Spark  Statistician

Use != operator

   Age Date Of Join EmpCode  Name  Occupation
0   23   2018-01-25  Emp001  John     Chemist
4   40   2018-03-16  Emp005  Mark  Programmer

Multiple Conditions

   Age Date Of Join EmpCode  Name Occupation
0   23   2018-01-25  Emp001  John    Chemist
</code></pre><h2 id="12在-DataFrame-中使用“isin”过滤多行"><a href="#12在-DataFrame-中使用“isin”过滤多行" class="headerlink" title="12在 DataFrame 中使用“isin”过滤多行"></a>12在 DataFrame 中使用“isin”过滤多行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nUse isin operator\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>employees<span class="token punctuation">[</span><span class="token string">'Occupation'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span><span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nMultiple Conditions\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>employees<span class="token punctuation">[</span><span class="token string">'Occupation'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Chemist'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                    <span class="token punctuation">(</span>employees<span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'John'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>
                    <span class="token punctuation">(</span>employees<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>Use isin operator

   Age Date Of Join EmpCode  Name  Occupation
0   23   2018-01-25  Emp001  John     Chemist
4   40   2018-03-16  Emp005  Mark  Programmer

Multiple Conditions

   Age Date Of Join EmpCode  Name Occupation
0   23   2018-01-25  Emp001  John    Chemist</code></pre><h2 id="13迭代-DataFrame-的行和列"><a href="#13迭代-DataFrame-的行和列" class="headerlink" title="13迭代 DataFrame 的行和列"></a>13迭代 DataFrame 的行和列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n Example iterrows \n"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> col <span class="token keyword">in</span> employees<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>col<span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"--"</span><span class="token punctuation">,</span> col<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n Example itertuples \n"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> employees<span class="token punctuation">.</span>itertuples<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Pandas'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>getattr<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token string">"Name"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"--"</span><span class="token punctuation">,</span> getattr<span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token string">"Age"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code> Example iterrows

John -- 23
Doe -- 24
William -- 34
Spark -- 29
Mark -- 40

 Example itertuples

John -- 23
Doe -- 24
William -- 34
Spark -- 29
Mark -- 40</code></pre><h2 id="14如何通过名称或索引删除-DataFrame-的列"><a href="#14如何通过名称或索引删除-DataFrame-的列" class="headerlink" title="14如何通过名称或索引删除 DataFrame 的列"></a>14如何通过名称或索引删除 DataFrame 的列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n Drop Column by Name \n"</span><span class="token punctuation">)</span>
employees<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'Age'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n Drop Column by Index \n"</span><span class="token punctuation">)</span>
employees<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>employees<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>   Age Date Of Join EmpCode     Name    Occupation
0   23   2018-01-25  Emp001     John       Chemist
1   24   2018-01-26  Emp002      Doe  Statistician
2   34   2018-01-26  Emp003  William  Statistician
3   29   2018-02-26  Emp004    Spark  Statistician
4   40   2018-03-16  Emp005     Mark    Programmer

 Drop Column by Name

  Date Of Join EmpCode     Name    Occupation
0   2018-01-25  Emp001     John       Chemist
1   2018-01-26  Emp002      Doe  Statistician
2   2018-01-26  Emp003  William  Statistician
3   2018-02-26  Emp004    Spark  Statistician
4   2018-03-16  Emp005     Mark    Programmer

 Drop Column by Index

      Name    Occupation
0     John       Chemist
1      Doe  Statistician
2  William  Statistician
3    Spark  Statistician
4     Mark    Programmer</code></pre><h2 id="15向-DataFrame-中新增列"><a href="#15向-DataFrame-中新增列" class="headerlink" title="15向 DataFrame 中新增列"></a>15向 DataFrame 中新增列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

employees<span class="token punctuation">[</span><span class="token string">'City'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'Tokyo'</span><span class="token punctuation">,</span> <span class="token string">'Sydney'</span><span class="token punctuation">,</span> <span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'Toronto'</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>   Age Date Of Join EmpCode     Name    Occupation     City
0   23   2018-01-25  Emp001     John       Chemist   London
1   24   2018-01-26  Emp002      Doe  Statistician    Tokyo
2   34   2018-01-26  Emp003  William  Statistician   Sydney
3   29   2018-02-26  Emp004    Spark  Statistician   London
4   40   2018-03-16  Emp005     Mark    Programmer  Toronto</code></pre><h2 id="16如何从-DataFrame-中获取列标题列表"><a href="#16如何从-DataFrame-中获取列标题列表" class="headerlink" title="16如何从 DataFrame 中获取列标题列表"></a>16如何从 DataFrame 中获取列标题列表</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>list<span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>list<span class="token punctuation">(</span>employees<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>['Age', 'Date Of Join', 'EmpCode', 'Name', 'Occupation']
['Age', 'Date Of Join', 'EmpCode', 'Name', 'Occupation']
['Age', 'Date Of Join', 'EmpCode', 'Name', 'Occupation']</code></pre><h2 id="17如何随机生成-DataFrame"><a href="#17如何随机生成-DataFrame" class="headerlink" title="17如何随机生成 DataFrame"></a>17如何随机生成 DataFrame</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

df_random <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                         columns<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token string">'ABCDEF'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                         index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Row-{}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df_random<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>        A   B   C   D   E   F
Row-0  99  78  61  16  73   8
Row-1  62  27  30  80   7  76
Row-2  15  53  80  27  44  77
Row-3  75  65  47  30  84  86
Row-4  18   9  41  62   1  82
Row-5  16  78   5  58   0  80
Row-6   4  36  51  27  31   2
Row-7  68  38  83  19  18   7
Row-8  30  62  11  67  65  55
Row-9   3  91  78  27  29  33</code></pre><h2 id="18如何选择-DataFrame-的多个列"><a href="#18如何选择-DataFrame-的多个列" class="headerlink" title="18如何选择 DataFrame 的多个列"></a>18如何选择 DataFrame 的多个列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> employees<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'EmpCode'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>  EmpCode  Age     Name
0  Emp001   23     John
1  Emp002   24      Doe
2  Emp003   34  William
3  Emp004   29    Spark
4  Emp005   40     Mark</code></pre><h2 id="19如何将字典转换为-DataFrame"><a href="#19如何将字典转换为-DataFrame" class="headerlink" title="19如何将字典转换为 DataFrame"></a>19如何将字典转换为 DataFrame</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Blue'</span><span class="token punctuation">,</span> <span class="token string">'Green'</span><span class="token punctuation">,</span> <span class="token string">'Red'</span><span class="token punctuation">,</span> <span class="token string">'White'</span><span class="token punctuation">,</span> <span class="token string">'Gray'</span><span class="token punctuation">,</span> <span class="token string">'Black'</span><span class="token punctuation">,</span>
                             <span class="token string">'Red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Food'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Steak'</span><span class="token punctuation">,</span> <span class="token string">'Lamb'</span><span class="token punctuation">,</span> <span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Cheese'</span><span class="token punctuation">,</span>
                            <span class="token string">'Melon'</span><span class="token punctuation">,</span> <span class="token string">'Beans'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">1.8</span><span class="token punctuation">,</span> <span class="token number">9.5</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>{'Height': [165, 70, 120, 80, 180, 172, 150], 'Food': ['Steak', 'Lamb', 'Mango',
 'Apple', 'Cheese', 'Melon', 'Beans'], 'Age': [30, 20, 22, 40, 32, 28, 39], 'Sco
re': [4.6, 8.3, 9.0, 3.3, 1.8, 9.5, 2.2], 'Color': ['Blue', 'Green', 'Red', 'Whi
te', 'Gray', 'Black', 'Red'], 'State': ['NY', 'TX', 'FL', 'AL', 'AK', 'TX', 'TX'
]}
   Age  Color    Food  Height  Score State
0   30   Blue   Steak     165    4.6    NY
1   20  Green    Lamb      70    8.3    TX
2   22    Red   Mango     120    9.0    FL
3   40  White   Apple      80    3.3    AL
4   32   Gray  Cheese     180    1.8    AK
5   28  Black   Melon     172    9.5    TX
6   39    Red   Beans     150    2.2    TX</code></pre><h2 id="20使用-ioc-进行切片"><a href="#20使用-ioc-进行切片" class="headerlink" title="20使用 ioc 进行切片"></a>20使用 ioc 进行切片</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Blue'</span><span class="token punctuation">,</span> <span class="token string">'Green'</span><span class="token punctuation">,</span> <span class="token string">'Red'</span><span class="token punctuation">,</span> <span class="token string">'White'</span><span class="token punctuation">,</span> <span class="token string">'Gray'</span><span class="token punctuation">,</span> <span class="token string">'Black'</span><span class="token punctuation">,</span>
                             <span class="token string">'Red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Food'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Steak'</span><span class="token punctuation">,</span> <span class="token string">'Lamb'</span><span class="token punctuation">,</span> <span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Cheese'</span><span class="token punctuation">,</span>
                            <span class="token string">'Melon'</span><span class="token punctuation">,</span> <span class="token string">'Beans'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">1.8</span><span class="token punctuation">,</span> <span class="token number">9.5</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- Selecting a single row with .loc with a string -- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'Penelope'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- Selecting multiple rows with .loc with a list of strings -- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Cornelia'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- Selecting multiple rows with .loc with slice notation -- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'Aaron'</span><span class="token punctuation">:</span><span class="token string">'Dean'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code> -- Selecting a single row with .loc with a string --

Age          40
Color     White
Food      Apple
Height       80
Score       3.3
State        AL
Name: Penelope, dtype: object

 -- Selecting multiple rows with .loc with a list of strings --

          Age Color    Food  Height  Score State
Cornelia   39   Red   Beans     150    2.2    TX
Jane       30  Blue   Steak     165    4.6    NY
Dean       32  Gray  Cheese     180    1.8    AK

 -- Selecting multiple rows with .loc with slice notation --

          Age  Color    Food  Height  Score State
Aaron      22    Red   Mango     120    9.0    FL
Penelope   40  White   Apple      80    3.3    AL
Dean       32   Gray  Cheese     180    1.8    AK</code></pre><h2 id="21检查-DataFrame-中是否是空的"><a href="#21检查-DataFrame-中是否是空的" class="headerlink" title="21检查 DataFrame 中是否是空的"></a>21检查 DataFrame 中是否是空的</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> df<span class="token punctuation">.</span>empty<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'DataFrame is empty!'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>DataFrame is empty!</code></pre><h2 id="22在创建-DataFrame-时指定索引和列名称"><a href="#22在创建-DataFrame-时指定索引和列名称" class="headerlink" title="22在创建 DataFrame 时指定索引和列名称"></a>22在创建 DataFrame 时指定索引和列名称</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"India"</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"Australia"</span><span class="token punctuation">,</span>
          <span class="token string">"Japan"</span><span class="token punctuation">,</span> <span class="token string">"Germany"</span><span class="token punctuation">,</span> <span class="token string">"France"</span><span class="token punctuation">]</span>

code <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"IND"</span><span class="token punctuation">,</span> <span class="token string">"CAN"</span><span class="token punctuation">,</span> <span class="token string">"AUS"</span><span class="token punctuation">,</span> <span class="token string">"JAP"</span><span class="token punctuation">,</span> <span class="token string">"GER"</span><span class="token punctuation">,</span> <span class="token string">"FRA"</span><span class="token punctuation">]</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>values<span class="token punctuation">,</span> index<span class="token operator">=</span>code<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Country'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>       Country
IND      India
CAN     Canada
AUS  Australia
JAP      Japan
GER    Germany
FRA     France</code></pre><h2 id="23使用-iloc-进行切片"><a href="#23使用-iloc-进行切片" class="headerlink" title="23使用 iloc 进行切片"></a>23使用 iloc 进行切片</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Blue'</span><span class="token punctuation">,</span> <span class="token string">'Green'</span><span class="token punctuation">,</span> <span class="token string">'Red'</span><span class="token punctuation">,</span> <span class="token string">'White'</span><span class="token punctuation">,</span> <span class="token string">'Gray'</span><span class="token punctuation">,</span> <span class="token string">'Black'</span><span class="token punctuation">,</span>
                             <span class="token string">'Red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Food'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Steak'</span><span class="token punctuation">,</span> <span class="token string">'Lamb'</span><span class="token punctuation">,</span> <span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Cheese'</span><span class="token punctuation">,</span>
                            <span class="token string">'Melon'</span><span class="token punctuation">,</span> <span class="token string">'Beans'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">1.8</span><span class="token punctuation">,</span> <span class="token number">9.5</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- Selecting a single row with .iloc with an integer -- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- Selecting multiple rows with .iloc with a list of integers -- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- Selecting multiple rows with .iloc with slice notation -- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code> -- Selecting a single row with .iloc with an integer --

Age           32
Color       Gray
Food      Cheese
Height       180
Score        1.8
State         AK
Name: Dean, dtype: object

 -- Selecting multiple rows with .iloc with a list of integers --

           Age  Color   Food  Height  Score State
Aaron       22    Red  Mango     120    9.0    FL
Christina   28  Black  Melon     172    9.5    TX

 -- Selecting multiple rows with .iloc with slice notation --

          Age  Color   Food  Height  Score State
Jane       30   Blue  Steak     165    4.6    NY
Penelope   40  White  Apple      80    3.3    AL</code></pre><h2 id="24iloc-和-loc-的区别"><a href="#24iloc-和-loc-的区别" class="headerlink" title="24iloc 和 loc 的区别"></a>24iloc 和 loc 的区别</h2><ul>
<li>loc 索引器还可以进行布尔选择，例如，如果我们想查找 Age 小于 30 的所有行并仅返回 Color 和 Height 列，我们可以执行以下操作。我们可以用 iloc 复制它，但我们不能将它传递给一个布尔系列，必须将布尔系列转换为 numpy 数组</li>
<li>loc 从索引中获取具有特定标签的行（或列）</li>
<li>iloc 在索引中的特定位置获取行（或列）（因此它只需要整数）</li>
</ul>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Blue'</span><span class="token punctuation">,</span> <span class="token string">'Green'</span><span class="token punctuation">,</span> <span class="token string">'Red'</span><span class="token punctuation">,</span> <span class="token string">'White'</span><span class="token punctuation">,</span> <span class="token string">'Gray'</span><span class="token punctuation">,</span> <span class="token string">'Black'</span><span class="token punctuation">,</span>
                             <span class="token string">'Red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Food'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Steak'</span><span class="token punctuation">,</span> <span class="token string">'Lamb'</span><span class="token punctuation">,</span> <span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Cheese'</span><span class="token punctuation">,</span>
                            <span class="token string">'Melon'</span><span class="token punctuation">,</span> <span class="token string">'Beans'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">1.8</span><span class="token punctuation">,</span> <span class="token number">9.5</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- loc -- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'Height'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- iloc -- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code> -- loc --

           Color  Height
Nick       Green      70
Aaron        Red     120
Christina  Black     172

 -- iloc --

           Color  Height
Nick       Green      70
Aaron        Red     120
Christina  Black     172</code></pre><h2 id="25使用时间索引创建空-DataFrame"><a href="#25使用时间索引创建空-DataFrame" class="headerlink" title="25使用时间索引创建空 DataFrame"></a>25使用时间索引创建空 DataFrame</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

todays_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span>
index <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>todays_date<span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'D'</span><span class="token punctuation">)</span>

columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>index<span class="token operator">=</span>index<span class="token punctuation">,</span> columns<span class="token operator">=</span>columns<span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>            A  B  C
2018-09-30  0  0  0
2018-10-01  0  0  0
2018-10-02  0  0  0
2018-10-03  0  0  0
2018-10-04  0  0  0
2018-10-05  0  0  0
2018-10-06  0  0  0
2018-10-07  0  0  0
2018-10-08  0  0  0
2018-10-09  0  0  0</code></pre><h2 id="26如何改变-DataFrame-列的排序"><a href="#26如何改变-DataFrame-列的排序" class="headerlink" title="26如何改变 DataFrame 列的排序"></a>26如何改变 DataFrame 列的排序</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Blue'</span><span class="token punctuation">,</span> <span class="token string">'Green'</span><span class="token punctuation">,</span> <span class="token string">'Red'</span><span class="token punctuation">,</span> <span class="token string">'White'</span><span class="token punctuation">,</span> <span class="token string">'Gray'</span><span class="token punctuation">,</span> <span class="token string">'Black'</span><span class="token punctuation">,</span>
                             <span class="token string">'Red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Food'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Steak'</span><span class="token punctuation">,</span> <span class="token string">'Lamb'</span><span class="token punctuation">,</span> <span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Cheese'</span><span class="token punctuation">,</span>
                            <span class="token string">'Melon'</span><span class="token punctuation">,</span> <span class="token string">'Beans'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">1.8</span><span class="token punctuation">,</span> <span class="token number">9.5</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- Change order using columns -- \n"</span><span class="token punctuation">)</span>
new_order <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
df <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">[</span>new_order<span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -- Change order using reindex -- \n"</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'State'</span><span class="token punctuation">,</span> <span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">,</span> <span class="token string">'Food'</span><span class="token punctuation">,</span> <span class="token string">'Score'</span><span class="token punctuation">,</span> <span class="token string">'Height'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code> -- Change order using columns --

           Height    Food  Color  Score State  Age
Jane          165   Steak   Blue    4.6    NY   30
Nick           70    Lamb  Green    8.3    TX   20
Aaron         120   Mango    Red    9.0    FL   22
Penelope       80   Apple  White    3.3    AL   40
Dean          180  Cheese   Gray    1.8    AK   32
Christina     172   Melon  Black    9.5    TX   28
Cornelia      150   Beans    Red    2.2    TX   39

 -- Change order using reindex --

          State  Color  Age    Food  Score  Height
Jane         NY   Blue   30   Steak    4.6     165
Nick         TX  Green   20    Lamb    8.3      70
Aaron        FL    Red   22   Mango    9.0     120
Penelope     AL  White   40   Apple    3.3      80
Dean         AK   Gray   32  Cheese    1.8     180
Christina    TX  Black   28   Melon    9.5     172
Cornelia     TX    Red   39   Beans    2.2     150</code></pre><h2 id="27检查-DataFrame-列的数据类型"><a href="#27检查-DataFrame-列的数据类型" class="headerlink" title="27检查 DataFrame 列的数据类型"></a>27检查 DataFrame 列的数据类型</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Blue'</span><span class="token punctuation">,</span> <span class="token string">'Green'</span><span class="token punctuation">,</span> <span class="token string">'Red'</span><span class="token punctuation">,</span> <span class="token string">'White'</span><span class="token punctuation">,</span> <span class="token string">'Gray'</span><span class="token punctuation">,</span> <span class="token string">'Black'</span><span class="token punctuation">,</span>
                             <span class="token string">'Red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Food'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Steak'</span><span class="token punctuation">,</span> <span class="token string">'Lamb'</span><span class="token punctuation">,</span> <span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Cheese'</span><span class="token punctuation">,</span>
                            <span class="token string">'Melon'</span><span class="token punctuation">,</span> <span class="token string">'Beans'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">1.8</span><span class="token punctuation">,</span> <span class="token number">9.5</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>Age         int64
Color      object
Food       object
Height      int64
Score     float64
State      object
dtype: object</code></pre><h2 id="28更改-DataFrame-指定列的数据类型"><a href="#28更改-DataFrame-指定列的数据类型" class="headerlink" title="28更改 DataFrame 指定列的数据类型"></a>28更改 DataFrame 指定列的数据类型</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Blue'</span><span class="token punctuation">,</span> <span class="token string">'Green'</span><span class="token punctuation">,</span> <span class="token string">'Red'</span><span class="token punctuation">,</span> <span class="token string">'White'</span><span class="token punctuation">,</span> <span class="token string">'Gray'</span><span class="token punctuation">,</span> <span class="token string">'Black'</span><span class="token punctuation">,</span>
                             <span class="token string">'Red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Food'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Steak'</span><span class="token punctuation">,</span> <span class="token string">'Lamb'</span><span class="token punctuation">,</span> <span class="token string">'Mango'</span><span class="token punctuation">,</span> <span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Cheese'</span><span class="token punctuation">,</span>
                            <span class="token string">'Melon'</span><span class="token punctuation">,</span> <span class="token string">'Beans'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">1.8</span><span class="token punctuation">,</span> <span class="token number">9.5</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>str<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>Age         int64
Color      object
Food       object
Height      int64
Score     float64
State      object
dtype: object
Age        object
Color      object
Food       object
Height      int64
Score     float64
State      object
dtype: object</code></pre><h2 id="29如何将列的数据类型转换为-DateTime-类型"><a href="#29如何将列的数据类型转换为-DateTime-类型" class="headerlink" title="29如何将列的数据类型转换为 DateTime 类型"></a>29如何将列的数据类型转换为 DateTime 类型</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOFBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1349720105</span><span class="token punctuation">,</span> <span class="token number">1349806505</span><span class="token punctuation">,</span> <span class="token number">1349892905</span><span class="token punctuation">,</span>
                                   <span class="token number">1349979305</span><span class="token punctuation">,</span> <span class="token number">1350065705</span><span class="token punctuation">,</span> <span class="token number">1349792905</span><span class="token punctuation">,</span>
                                   <span class="token number">1349730105</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------------Before---------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'DateOFBirth'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'DateOFBirth'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------------After----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------------Before---------------

DateOFBirth     int64
State          object
dtype: object
           DateOFBirth State
Jane        1349720105    NY
Nick        1349806505    TX
Aaron       1349892905    FL
Penelope    1349979305    AL
Dean        1350065705    AK
Christina   1349792905    TX
Cornelia    1349730105    TX

----------------After----------------

DateOFBirth    datetime64[ns]
State                  object
dtype: object
                  DateOFBirth State
Jane      2012-10-08 18:15:05    NY
Nick      2012-10-09 18:15:05    TX
Aaron     2012-10-10 18:15:05    FL
Penelope  2012-10-11 18:15:05    AL
Dean      2012-10-12 18:15:05    AK
Christina 2012-10-09 14:28:25    TX
Cornelia  2012-10-08 21:01:45    TX</code></pre><h2 id="30将-DataFrame-列从-floats-转为-ints"><a href="#30将-DataFrame-列从-floats-转为-ints" class="headerlink" title="30将 DataFrame 列从 floats 转为 ints"></a>30将 DataFrame 列从 floats 转为 ints</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DailyExp'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">75.7</span><span class="token punctuation">,</span> <span class="token number">56.69</span><span class="token punctuation">,</span> <span class="token number">55.69</span><span class="token punctuation">,</span> <span class="token number">96.5</span><span class="token punctuation">,</span> <span class="token number">84.9</span><span class="token punctuation">,</span> <span class="token number">110.5</span><span class="token punctuation">,</span>
                                <span class="token number">58.9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------------Before---------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'DailyExp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'DailyExp'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>int<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------------After----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------------Before---------------

DailyExp    float64
State        object
dtype: object
           DailyExp State
Jane          75.70    NY
Nick          56.69    TX
Aaron         55.69    FL
Penelope      96.50    AL
Dean          84.90    AK
Christina    110.50    TX
Cornelia      58.90    TX

----------------After----------------

DailyExp     int32
State       object
dtype: object
           DailyExp State
Jane             75    NY
Nick             56    TX
Aaron            55    FL
Penelope         96    AL
Dean             84    AK
Christina       110    TX
Cornelia         58    TX</code></pre><h2 id="31如何把-dates-列转换为-DateTime-类型"><a href="#31如何把-dates-列转换为-DateTime-类型" class="headerlink" title="31如何把 dates 列转换为 DateTime 类型"></a>31如何把 dates 列转换为 DateTime 类型</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1986-11-11'</span><span class="token punctuation">,</span> <span class="token string">'1999-05-12'</span><span class="token punctuation">,</span> <span class="token string">'1976-01-01'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1986-06-01'</span><span class="token punctuation">,</span> <span class="token string">'1983-06-04'</span><span class="token punctuation">,</span> <span class="token string">'1990-03-07'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1999-07-09'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                   
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------------Before---------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'datetime64'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------------After----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------------Before---------------

DateOfBirth    object
State          object
dtype: object

----------------After----------------

DateOfBirth    datetime64[ns]
State                  object
dtype: object</code></pre><h2 id="32两个-DataFrame-相加"><a href="#32两个-DataFrame-相加" class="headerlink" title="32两个 DataFrame 相加"></a>32两个 DataFrame 相加</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span>
                                                             <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                   index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Gray'</span><span class="token punctuation">,</span> <span class="token string">'Black'</span><span class="token punctuation">,</span> <span class="token string">'Red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token string">'Food'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Cheese'</span><span class="token punctuation">,</span> <span class="token string">'Melon'</span><span class="token punctuation">,</span> <span class="token string">'Beans'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1.8</span><span class="token punctuation">,</span> <span class="token number">9.5</span><span class="token punctuation">,</span> <span class="token number">2.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                   index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Dean'</span><span class="token punctuation">,</span> <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df3 <span class="token operator">=</span> df1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> sort<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>           Age  Color    Food  Height  Score State
Jane        30    NaN     NaN   165.0    4.6    NY
Nick        20    NaN     NaN    70.0    8.3    TX
Aaron       22    NaN     NaN   120.0    9.0    FL
Penelope    40    NaN     NaN    80.0    3.3    AL
Dean        32   Gray  Cheese     NaN    1.8    AK
Christina   28  Black   Melon     NaN    9.5    TX
Cornelia    39    Red   Beans     NaN    2.2    TX</code></pre><h2 id="33在-DataFrame-末尾添加额外的行"><a href="#33在-DataFrame-末尾添加额外的行" class="headerlink" title="33在 DataFrame 末尾添加额外的行"></a>33在 DataFrame 末尾添加额外的行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ BEFORE ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span>

employees<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>len<span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">,</span> <span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'Emp006'</span><span class="token punctuation">,</span> <span class="token string">'Sunny'</span><span class="token punctuation">,</span>
                                 <span class="token string">'Programmer'</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ AFTER ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------------ BEFORE ----------------

   Age Date Of Join EmpCode     Name    Occupation
0   23   2018-01-25  Emp001     John       Chemist
1   24   2018-01-26  Emp002      Doe  Statistician
2   34   2018-01-26  Emp003  William  Statistician
3   29   2018-02-26  Emp004    Spark  Statistician
4   40   2018-03-16  Emp005     Mark    Programmer

------------ AFTER ----------------

   Age Date Of Join EmpCode     Name    Occupation
0   23   2018-01-25  Emp001     John       Chemist
1   24   2018-01-26  Emp002      Doe  Statistician
2   34   2018-01-26  Emp003  William  Statistician
3   29   2018-02-26  Emp004    Spark  Statistician
4   40   2018-03-16  Emp005     Mark    Programmer
5   45   2018-01-25  Emp006    Sunny    Programmer</code></pre><h2 id="34为指定索引添加新行"><a href="#34为指定索引添加新行" class="headerlink" title="34为指定索引添加新行"></a>34为指定索引添加新行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>
    data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John Doe'</span><span class="token punctuation">,</span> <span class="token string">'William Spark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'Occupation'</span><span class="token punctuation">,</span> <span class="token string">'Date Of Join'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ BEFORE ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span>

employees<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'Emp003'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Sunny'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ AFTER ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------------ BEFORE ----------------

                 Name    Occupation Date Of Join  Age
Emp001       John Doe       Chemist   2018-01-25   23
Emp002  William Spark  Statistician   2018-01-26   24

------------ AFTER ----------------

                 Name    Occupation Date Of Join  Age
Emp001       John Doe       Chemist   2018-01-25   23
Emp002  William Spark  Statistician   2018-01-26   24
Emp003          Sunny    Programmer   2018-01-25   45</code></pre><h2 id="35如何使用-for-循环添加行"><a href="#35如何使用-for-循环添加行" class="headerlink" title="35如何使用 for 循环添加行"></a>35如何使用 for 循环添加行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Zip'</span><span class="token punctuation">]</span>
lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
zip <span class="token operator">=</span> <span class="token number">32100</span>

<span class="token keyword">for</span> a <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    lst<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>zip<span class="token punctuation">]</span><span class="token punctuation">)</span>
    zip <span class="token operator">=</span> zip <span class="token operator">+</span> <span class="token number">1</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>lst<span class="token punctuation">,</span> columns<span class="token operator">=</span>cols<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>     Zip
0  32100
1  32101
2  32102
3  32103
4  32104
5  32105
6  32106
7  32107
8  32108
9  32109</code></pre><h2 id="36在-DataFrame-顶部添加一行"><a href="#36在-DataFrame-顶部添加一行" class="headerlink" title="36在 DataFrame 顶部添加一行"></a>36在 DataFrame 顶部添加一行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ BEFORE ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># New line</span>
line <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token string">'Emp001'</span><span class="token punctuation">,</span>
                     <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span> <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token string">'Chemist'</span>
                     <span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># Concatenate two dataframe</span>
employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>line<span class="token punctuation">,</span>employees<span class="token punctuation">.</span>ix<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ AFTER ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------------ BEFORE ----------------

   Age Date Of Join EmpCode     Name    Occupation
0   23   2018-01-25  Emp002     John       Chemist
1   24   2018-01-26  Emp003      Doe  Statistician
2   34   2018-01-26  Emp004  William  Statistician

------------ AFTER ----------------

   Age Date Of Join EmpCode     Name    Occupation
0   45   2018-02-26  Emp001     Dean       Chemist
1   23   2018-01-25  Emp002     John       Chemist
2   24   2018-01-26  Emp003      Doe  Statistician
3   34   2018-01-26  Emp004  William  Statistician</code></pre><h2 id="37如何向-DataFrame-中动态添加行"><a href="#37如何向-DataFrame-中动态添加行" class="headerlink" title="37如何向 DataFrame 中动态添加行"></a>37如何向 DataFrame 中动态添加行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Rocky'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">23</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Sunny'</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>    Name  Age
1  Rocky   23
2  Sunny  NaN</code></pre><h2 id="38在任意位置插入行"><a href="#38在任意位置插入行" class="headerlink" title="38在任意位置插入行"></a>38在任意位置插入行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Rocky'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">21</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Sunny'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">22</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Mark'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">25</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Taylor'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">28</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ BEFORE ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

line <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"Name"</span><span class="token punctuation">:</span> <span class="token string">"Jack"</span><span class="token punctuation">,</span> <span class="token string">"Age"</span><span class="token punctuation">:</span> <span class="token number">24</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> df<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ AFTER ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------------ BEFORE ----------------

     Name Age
1   Rocky  21
2   Sunny  22
3    Mark  25
4  Taylor  28

------------ AFTER ----------------

     Name Age
0   Rocky  21
1   Sunny  22
2    Jack  24
3    Mark  25
4  Taylor  28</code></pre><h2 id="39使用时间戳索引向-DataFrame-中添加行"><a href="#39使用时间戳索引向-DataFrame-中添加行" class="headerlink" title="39使用时间戳索引向 DataFrame 中添加行"></a>39使用时间戳索引向 DataFrame 中添加行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'2014-05-01 18:47:05'</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Rocky'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'2014-05-01 18:47:05'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">21</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'2014-05-02 18:47:05'</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Sunny'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'2014-05-02 18:47:05'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">22</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'2014-05-03 18:47:05'</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Mark'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'2014-05-03 18:47:05'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">25</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ BEFORE ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

line <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">"2014-05-01 18:50:05"</span><span class="token punctuation">,</span> format<span class="token operator">=</span><span class="token string">"%Y-%m-%d %H:%M:%S"</span><span class="token punctuation">)</span>
new_row <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Bunny'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span>line<span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df<span class="token punctuation">,</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>new_row<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ AFTER ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------------ BEFORE ----------------

                      Name Age
2014-05-01 18:47:05  Rocky  21
2014-05-02 18:47:05  Sunny  22
2014-05-03 18:47:05   Mark  25

------------ AFTER ----------------

                      Name Age
2014-05-01 18:47:05  Rocky  21
2014-05-02 18:47:05  Sunny  22
2014-05-03 18:47:05   Mark  25
2014-05-01 18:50:05  Bunny  26</code></pre><h2 id="40为不同的行填充缺失值"><a href="#40为不同的行填充缺失值" class="headerlink" title="40为不同的行填充缺失值"></a>40为不同的行填充缺失值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span>
b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">}</span>

df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>a<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>b<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df1<span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df2<span class="token punctuation">)</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>      A   B     C     D
0  10.0  20   0.0   0.0
1   0.0  30  40.0  50.0</code></pre><h2 id="41append-concat-和-combine-first-示例"><a href="#41append-concat-和-combine-first-示例" class="headerlink" title="41append, concat 和 combine_first 示例"></a>41append, concat 和 combine_first 示例</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span>
b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">}</span>

df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>a<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>b<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

d1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
d1 <span class="token operator">=</span> d1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df1<span class="token punctuation">)</span>
d1 <span class="token operator">=</span> d1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df2<span class="token punctuation">)</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ append ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d1<span class="token punctuation">)</span>

d2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ concat ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d2<span class="token punctuation">)</span>

d3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
d3 <span class="token operator">=</span> d3<span class="token punctuation">.</span>combine_first<span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span class="token punctuation">.</span>combine_first<span class="token punctuation">(</span>df2<span class="token punctuation">)</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------------ combine_first ----------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d3<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------------ append ----------------

      A   B     C     D
0  10.0  20   0.0   0.0
1   0.0  30  40.0  50.0

------------ concat ----------------

      A   B     C     D
0  10.0  20   0.0   0.0
1   0.0  30  40.0  50.0

------------ combine_first ----------------

      A     B     C     D
0  10.0  20.0   0.0   0.0
1   0.0  30.0  40.0  50.0</code></pre><h2 id="42获取行和列的平均值"><a href="#42获取行和列的平均值" class="headerlink" title="42获取行和列的平均值"></a>42获取行和列的平均值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'Mean Basket'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'Mean Fruit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>                Apple  Orange  Banana       Pear  Mean Basket
Basket1     10.000000    20.0    30.0  40.000000         25.0
Basket2      7.000000    14.0    21.0  28.000000         17.5
Basket3      5.000000     5.0     0.0   0.000000          2.5
Mean Fruit   7.333333    13.0    17.0  22.666667         15.0</code></pre><h2 id="43计算行和列的总和"><a href="#43计算行和列的总和" class="headerlink" title="43计算行和列的总和"></a>43计算行和列的总和</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'Sum Basket'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'Sum Fruit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>           Apple  Orange  Banana  Pear  Sum Basket
Basket1       10      20      30    40         100
Basket2        7      14      21    28          70
Basket3        5       5       0     0          10
Sum Fruit     22      39      51    68         180</code></pre><h2 id="44连接两列"><a href="#44连接两列" class="headerlink" title="44连接两列"></a>44连接两列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Rocky'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">21</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Sunny'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">22</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Mark'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">25</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Taylor'</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">28</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n------------ BEFORE ----------------\n'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'Employee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>map<span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' - '</span> <span class="token operator">+</span> df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>map<span class="token punctuation">(</span>str<span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Employee'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n------------ AFTER ----------------\n'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------------ BEFORE ----------------

     Name Age
1   Rocky  21
2   Sunny  22
3    Mark  25
4  Taylor  28

------------ AFTER ----------------

      Employee
1   Rocky - 21
2   Sunny - 22
3    Mark - 25
4  Taylor - 28</code></pre><h2 id="45过滤包含某字符串的行"><a href="#45过滤包含某字符串的行" class="headerlink" title="45过滤包含某字符串的行"></a>45过滤包含某字符串的行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1986-11-11'</span><span class="token punctuation">,</span> <span class="token string">'1999-05-12'</span><span class="token punctuation">,</span> <span class="token string">'1976-01-01'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1986-06-01'</span><span class="token punctuation">,</span> <span class="token string">'1983-06-04'</span><span class="token punctuation">,</span> <span class="token string">'1990-03-07'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1999-07-09'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n---- Filter with State contains TX ----\n"</span><span class="token punctuation">)</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'State'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">"TX"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>          DateOfBirth State
Jane       1986-11-11    NY
Nick       1999-05-12    TX
Aaron      1976-01-01    FL
Penelope   1986-06-01    AL
Dean       1983-06-04    AK
Christina  1990-03-07    TX
Cornelia   1999-07-09    TX

---- Filter with State contains TX ----

          DateOfBirth State
Nick       1999-05-12    TX
Christina  1990-03-07    TX
Cornelia   1999-07-09    TX</code></pre><h2 id="46过滤索引中包含某字符串的行"><a href="#46过滤索引中包含某字符串的行" class="headerlink" title="46过滤索引中包含某字符串的行"></a>46过滤索引中包含某字符串的行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1986-11-11'</span><span class="token punctuation">,</span> <span class="token string">'1999-05-12'</span><span class="token punctuation">,</span> <span class="token string">'1976-01-01'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1986-06-01'</span><span class="token punctuation">,</span> <span class="token string">'1983-06-04'</span><span class="token punctuation">,</span> <span class="token string">'1990-03-07'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1999-07-09'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Pane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Frane'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n---- Filter Index contains ane ----\n"</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>index <span class="token operator">=</span> df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">)</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'ane'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>          DateOfBirth State
Jane       1986-11-11    NY
Pane       1999-05-12    TX
Aaron      1976-01-01    FL
Penelope   1986-06-01    AL
Frane      1983-06-04    AK
Christina  1990-03-07    TX
Cornelia   1999-07-09    TX

---- Filter Index contains ane ----

      DateOfBirth State
Jane   1986-11-11    NY
Pane   1999-05-12    TX
Frane  1983-06-04    AK</code></pre><h2 id="47使用-AND-运算符过滤包含特定字符串值的行"><a href="#47使用-AND-运算符过滤包含特定字符串值的行" class="headerlink" title="47使用 AND 运算符过滤包含特定字符串值的行"></a>47使用 AND 运算符过滤包含特定字符串值的行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1986-11-11'</span><span class="token punctuation">,</span> <span class="token string">'1999-05-12'</span><span class="token punctuation">,</span> <span class="token string">'1976-01-01'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1986-06-01'</span><span class="token punctuation">,</span> <span class="token string">'1983-06-04'</span><span class="token punctuation">,</span> <span class="token string">'1990-03-07'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1999-07-09'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Pane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Frane'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n---- Filter DataFrame using &amp; ----\n"</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>index <span class="token operator">=</span> df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">)</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'ane'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> df<span class="token punctuation">[</span><span class="token string">'State'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">"TX"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>          DateOfBirth State
Jane       1986-11-11    NY
Pane       1999-05-12    TX
Aaron      1976-01-01    FL
Penelope   1986-06-01    AL
Frane      1983-06-04    AK
Christina  1990-03-07    TX
Cornelia   1999-07-09    TX

---- Filter DataFrame using &amp; ----

     DateOfBirth State
Pane  1999-05-12    TX</code></pre><h2 id="48查找包含某字符串的所有行"><a href="#48查找包含某字符串的所有行" class="headerlink" title="48查找包含某字符串的所有行"></a>48查找包含某字符串的所有行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1986-11-11'</span><span class="token punctuation">,</span> <span class="token string">'1999-05-12'</span><span class="token punctuation">,</span> <span class="token string">'1976-01-01'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1986-06-01'</span><span class="token punctuation">,</span> <span class="token string">'1983-06-04'</span><span class="token punctuation">,</span> <span class="token string">'1990-03-07'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1999-07-09'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Pane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Frane'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n---- Filter DataFrame using &amp; ----\n"</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>index <span class="token operator">=</span> df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">)</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'ane'</span><span class="token punctuation">)</span> <span class="token operator">|</span> df<span class="token punctuation">[</span><span class="token string">'State'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">"TX"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>          DateOfBirth State
Jane       1986-11-11    NY
Pane       1999-05-12    TX
Aaron      1976-01-01    FL
Penelope   1986-06-01    AL
Frane      1983-06-04    AK
Christina  1990-03-07    TX
Cornelia   1999-07-09    TX

---- Filter DataFrame using &amp; ----

          DateOfBirth State
Jane       1986-11-11    NY
Pane       1999-05-12    TX
Frane      1983-06-04    AK
Christina  1990-03-07    TX
Cornelia   1999-07-09    TX</code></pre><h2 id="49如果行中的值包含字符串，则创建与字符串相等的另一列"><a href="#49如果行中的值包含字符串，则创建与字符串相等的另一列" class="headerlink" title="49如果行中的值包含字符串，则创建与字符串相等的另一列"></a>49如果行中的值包含字符串，则创建与字符串相等的另一列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Accountant'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'Department'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>df<span class="token punctuation">.</span>Occupation<span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">"Chemist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Science"</span><span class="token punctuation">,</span>
                               pd<span class="token punctuation">.</span>np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>df<span class="token punctuation">.</span>Occupation<span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">"Statistician"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Economics"</span><span class="token punctuation">,</span>
                               pd<span class="token punctuation">.</span>np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>df<span class="token punctuation">.</span>Occupation<span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">"Programmer"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Computer"</span><span class="token punctuation">,</span> <span class="token string">"General"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>   Age Date Of Join EmpCode     Name    Occupation Department
0   23   2018-01-25  Emp001     John       Chemist    Science
1   24   2018-01-26  Emp002      Doe    Accountant    General
2   34   2018-01-26  Emp003  William  Statistician  Economics
3   29   2018-02-26  Emp004    Spark  Statistician  Economics
4   40   2018-03-16  Emp005     Mark    Programmer   Computer</code></pre><h2 id="50计算-pandas-group-中每组的行数"><a href="#50计算-pandas-group-中每组的行数" class="headerlink" title="50计算 pandas group 中每组的行数"></a>50计算 pandas group 中每组的行数</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Rice'</span><span class="token punctuation">,</span> <span class="token string">'Oil'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket4'</span><span class="token punctuation">,</span> <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n ----------------------------- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Rice'</span><span class="token punctuation">,</span> <span class="token string">'Oil'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>
      groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'mean'</span><span class="token punctuation">,</span> <span class="token string">'count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>         Apple  Orange  Rice  Oil
Basket1     10      20    30   40
Basket2      7      14    21   28
Basket3      5       5     0    0
Basket4      6       6     6    6
Basket5      8       8     8    8
Basket6      5       5     0    0

 -----------------------------

      Orange       Rice        Oil
        mean count mean count mean count
Apple
5          5     2    0     2    0     2
6          6     1    6     1    6     1
7         14     1   21     1   28     1
8          8     1    8     1    8     1
10        20     1   30     1   40     1</code></pre><h2 id="51检查字符串是否在-DataFrme-中"><a href="#51检查字符串是否在-DataFrme-中" class="headerlink" title="51检查字符串是否在 DataFrme 中"></a>51检查字符串是否在 DataFrme 中</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1986-11-11'</span><span class="token punctuation">,</span> <span class="token string">'1999-05-12'</span><span class="token punctuation">,</span> <span class="token string">'1976-01-01'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1986-06-01'</span><span class="token punctuation">,</span> <span class="token string">'1983-06-04'</span><span class="token punctuation">,</span> <span class="token string">'1990-03-07'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1999-07-09'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Pane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Frane'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> df<span class="token punctuation">[</span><span class="token string">'State'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>str<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'TX'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>any<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"TX is there"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>TX is there</code></pre><h2 id="52从-DataFrame-列中获取唯一行值"><a href="#52从-DataFrame-列中获取唯一行值" class="headerlink" title="52从 DataFrame 列中获取唯一行值"></a>52从 DataFrame 列中获取唯一行值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------------\n"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"State"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>          State
Jane         NY
Nick         TX
Aaron        FL
Penelope     AL
Dean         AK
Christina    TX
Cornelia     TX

----------------

['NY' 'TX' 'FL' 'AL' 'AK']</code></pre><h2 id="53计算-DataFrame-列的不同值"><a href="#53计算-DataFrame-列的不同值" class="headerlink" title="53计算 DataFrame 列的不同值"></a>53计算 DataFrame 列的不同值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">124</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                   index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Jaane'</span><span class="token punctuation">,</span> <span class="token string">'Nicky'</span><span class="token punctuation">,</span> <span class="token string">'Armour'</span><span class="token punctuation">,</span> <span class="token string">'Ponting'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>Age<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>20    3
30    2
25    1
22    1
40    1
Name: Age, dtype: int64</code></pre><h2 id="54删除具有重复索引的行"><a href="#54删除具有重复索引的行" class="headerlink" title="54删除具有重复索引的行"></a>54删除具有重复索引的行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">124</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Jaane'</span><span class="token punctuation">,</span> <span class="token string">'Nicky'</span><span class="token punctuation">,</span>
                         <span class="token string">'Armour'</span><span class="token punctuation">,</span> <span class="token string">'Ponting'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -------- Duplicate Rows ----------- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">,</span>
                                       keep<span class="token operator">=</span><span class="token string">'first'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n ------- Unique Rows ------------ \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code> -------- Duplicate Rows -----------

          Age  Height  Score State
Jane       30     165    4.6    NY
Jane       30     165    4.6    NY
Aaron      22     120    9.0    FL
Penelope   40      80    3.3    AL
Jaane      20     162    4.0    NY
Nicky      30      72    8.0    TX
Armour     20     124    9.0    FL
Ponting    25      81    3.0    AL

 ------- Unique Rows ------------

          Age  Height  Score State
index
Jane       30     165    4.6    NY
Aaron      22     120    9.0    FL
Penelope   40      80    3.3    AL
Jaane      20     162    4.0    NY
Nicky      30      72    8.0    TX
Armour     20     124    9.0    FL
Ponting    25      81    3.0    AL</code></pre><h2 id="55删除某些列具有重复值的行"><a href="#55删除某些列具有重复值的行" class="headerlink" title="55删除某些列具有重复值的行"></a>55删除某些列具有重复值的行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Jaane'</span><span class="token punctuation">,</span> <span class="token string">'Nicky'</span><span class="token punctuation">,</span>
                         <span class="token string">'Armour'</span><span class="token punctuation">,</span> <span class="token string">'Ponting'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n -------- Duplicate Rows ----------- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">,</span><span class="token string">'Height'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                                       keep<span class="token operator">=</span><span class="token string">'first'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n ------- Unique Rows ------------ \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code> -------- Duplicate Rows -----------

          Age  Height  Score State
Jane       30     120    4.6    NY
Jane       40     162    4.6    NY
Aaron      30     120    9.0    FL
Penelope   40     120    3.3    AL
Jaane      30     120    4.0    NY
Nicky      30      72    8.0    TX
Armour     20     120    9.0    FL
Ponting    25      81    3.0    AL

 ------- Unique Rows ------------

          Age  Height  Score State
index
Jane       30     120    4.6    NY
Jane       40     162    4.6    NY
Penelope   40     120    3.3    AL
Nicky      30      72    8.0    TX
Armour     20     120    9.0    FL
Ponting    25      81    3.0    AL</code></pre><h2 id="56从-DataFrame-单元格中获取值"><a href="#56从-DataFrame-单元格中获取值" class="headerlink" title="56从 DataFrame 单元格中获取值"></a>56从 DataFrame 单元格中获取值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Jaane'</span><span class="token punctuation">,</span> <span class="token string">'Nicky'</span><span class="token punctuation">,</span>
                         <span class="token string">'Armour'</span><span class="token punctuation">,</span> <span class="token string">'Ponting'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'Nicky'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>30</code></pre><h2 id="57使用-DataFrame-中的条件索引获取单元格上的标量值"><a href="#57使用-DataFrame-中的条件索引获取单元格上的标量值" class="headerlink" title="57使用 DataFrame 中的条件索引获取单元格上的标量值"></a>57使用 DataFrame 中的条件索引获取单元格上的标量值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Score'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">4.6</span><span class="token punctuation">,</span> <span class="token number">9.0</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Jaane'</span><span class="token punctuation">,</span> <span class="token string">'Nicky'</span><span class="token punctuation">,</span>
                         <span class="token string">'Armour'</span><span class="token punctuation">,</span> <span class="token string">'Ponting'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nGet Height where Age is 20"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'Height'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nGet State where Age is 30"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'State'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>Get Height where Age is 20
120

Get State where Age is 30
NY</code></pre><h2 id="58设置-DataFrame-的特定单元格值"><a href="#58设置-DataFrame-的特定单元格值" class="headerlink" title="58设置 DataFrame 的特定单元格值"></a>58设置 DataFrame 的特定单元格值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Jaane'</span><span class="token punctuation">,</span> <span class="token string">'Nicky'</span><span class="token punctuation">,</span>
                         <span class="token string">'Armour'</span><span class="token punctuation">,</span> <span class="token string">'Ponting'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------------Before------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">90</span>
df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">91</span>
df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">92</span>
df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">93</span>
df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">99</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------------After------------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>--------------Before------------

          Age  Height
Jane       30     120
Jane       40     162
Aaron      30     120
Penelope   40     120
Jaane      30     120
Nicky      30      72
Armour     20     120
Ponting    25      81

--------------After------------

          Age  Height
Jane       90      91
Jane       40      92
Aaron      30      93
Penelope   40     120
Jaane      30     120
Nicky      30      72
Armour     20     120
Ponting    25      99</code></pre><h2 id="59从-DataFrame-行获取单元格值"><a href="#59从-DataFrame-行获取单元格值" class="headerlink" title="59从 DataFrame 行获取单元格值"></a>59从 DataFrame 行获取单元格值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'Height'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Jaane'</span><span class="token punctuation">,</span> <span class="token string">'Nicky'</span><span class="token punctuation">,</span>
                         <span class="token string">'Armour'</span><span class="token punctuation">,</span> <span class="token string">'Ponting'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>Age <span class="token operator">==</span> <span class="token number">30</span><span class="token punctuation">,</span><span class="token string">'Height'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>[120, 120, 120, 72]</code></pre><h2 id="60用字典替换-DataFrame-列中的值"><a href="#60用字典替换-DataFrame-列中的值" class="headerlink" title="60用字典替换 DataFrame 列中的值"></a>60用字典替换 DataFrame 列中的值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"NY"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"TX"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"FL"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"AL"</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"AK"</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"State"</span><span class="token punctuation">:</span> dict<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>          State
Jane         NY
Nick         TX
Aaron        FL
Penelope     AL
Dean         AK
Christina    TX
Cornelia     TX



           State
Jane           1
Nick           2
Aaron          3
Penelope       4
Dean           5
Christina      2
Cornelia       2</code></pre><h2 id="61统计基于某一列的一列的数值"><a href="#61统计基于某一列的一列的数值" class="headerlink" title="61统计基于某一列的一列的数值"></a>61统计基于某一列的一列的数值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1986-11-11'</span><span class="token punctuation">,</span> <span class="token string">'1999-05-12'</span><span class="token punctuation">,</span> <span class="token string">'1976-01-01'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1986-06-01'</span><span class="token punctuation">,</span> <span class="token string">'1983-06-04'</span><span class="token punctuation">,</span> <span class="token string">'1990-03-07'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1999-07-09'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                   
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Nick'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Dean'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'State'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>DateOfBirth<span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>State
AK    1
AL    1
FL    1
NY    1
TX    3
Name: DateOfBirth, dtype: int64</code></pre><h2 id="62处理-DataFrame-中的缺失值"><a href="#62处理-DataFrame-中的缺失值" class="headerlink" title="62处理 DataFrame 中的缺失值"></a>62处理 DataFrame 中的缺失值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------- DataFrame ---------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------- Use of isnull() ---------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------- Use of notnull() ---------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>--------- DataFrame ---------

         Apple  Orange  Banana  Pear
Basket1     10    20.0    30.0  40.0
Basket2      7    14.0    21.0  28.0
Basket3      5     NaN     NaN   NaN

--------- Use of isnull() ---------

         Apple  Orange  Banana   Pear
Basket1  False   False   False  False
Basket2  False   False   False  False
Basket3  False    True    True   True

--------- Use of notnull() ---------

         Apple  Orange  Banana   Pear
Basket1   True    True    True   True
Basket2   True    True    True   True
Basket3   True   False   False  False</code></pre><h2 id="63删除包含任何缺失数据的行"><a href="#63删除包含任何缺失数据的行" class="headerlink" title="63删除包含任何缺失数据的行"></a>63删除包含任何缺失数据的行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------- DataFrame ---------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------- Use of dropna() ---------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>--------- DataFrame ---------

         Apple  Orange  Banana  Pear
Basket1     10    20.0    30.0  40.0
Basket2      7    14.0    21.0  28.0
Basket3      5     NaN     NaN   NaN

--------- Use of dropna() ---------

         Apple  Orange  Banana  Pear
Basket1     10    20.0    30.0  40.0
Basket2      7    14.0    21.0  28.0</code></pre><h2 id="64删除-DataFrame-中缺失数据的列"><a href="#64删除-DataFrame-中缺失数据的列" class="headerlink" title="64删除 DataFrame 中缺失数据的列"></a>64删除 DataFrame 中缺失数据的列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------- DataFrame ---------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------- Drop Columns) ---------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>--------- DataFrame ---------

         Apple  Orange  Banana  Pear
Basket1     10    20.0    30.0  40.0
Basket2      7    14.0    21.0  28.0
Basket3      5     NaN     NaN   NaN

--------- Drop Columns) ---------

         Apple
Basket1     10
Basket2      7
Basket3      5</code></pre><h2 id="65按降序对索引值进行排序"><a href="#65按降序对索引值进行排序" class="headerlink" title="65按降序对索引值进行排序"></a>65按降序对索引值进行排序</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1986-11-11'</span><span class="token punctuation">,</span> <span class="token string">'1999-05-12'</span><span class="token punctuation">,</span> <span class="token string">'1976-01-01'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1986-06-01'</span><span class="token punctuation">,</span> <span class="token string">'1983-06-04'</span><span class="token punctuation">,</span> <span class="token string">'1990-03-07'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1999-07-09'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Pane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Frane'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>          DateOfBirth State
Penelope   1986-06-01    AL
Pane       1999-05-12    TX
Jane       1986-11-11    NY
Frane      1983-06-04    AK
Cornelia   1999-07-09    TX
Christina  1990-03-07    TX
Aaron      1976-01-01    FL</code></pre><h2 id="66按降序对列进行排序"><a href="#66按降序对列进行排序" class="headerlink" title="66按降序对列进行排序"></a>66按降序对列进行排序</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>     Occupation     Name EmpCode Date Of Join  Age
0       Chemist     John  Emp001   2018-01-25   23
1  Statistician      Doe  Emp002   2018-01-26   24
2  Statistician  William  Emp003   2018-01-26   34
3  Statistician    Spark  Emp004   2018-02-26   29
4    Programmer     Mark  Emp005   2018-03-16   40</code></pre><h2 id="67使用-rank-方法查找-DataFrame-中元素的排名"><a href="#67使用-rank-方法查找-DataFrame-中元素的排名" class="headerlink" title="67使用 rank 方法查找 DataFrame 中元素的排名"></a>67使用 rank 方法查找 DataFrame 中元素的排名</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------- DataFrame Values--------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n--------- DataFrame Values by Rank--------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>--------- DataFrame Values--------

         Apple  Orange  Banana  Pear
Basket1     10      20      30    40
Basket2      7      14      21    28
Basket3      5       5       0     0

--------- DataFrame Values by Rank--------

         Apple  Orange  Banana  Pear
Basket1    3.0     3.0     3.0   3.0
Basket2    2.0     2.0     2.0   2.0
Basket3    1.0     1.0     1.0   1.0</code></pre><h2 id="68在多列上设置索引"><a href="#68在多列上设置索引" class="headerlink" title="68在多列上设置索引"></a>68在多列上设置索引</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

employees <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'EmpCode'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Emp001'</span><span class="token punctuation">,</span> <span class="token string">'Emp002'</span><span class="token punctuation">,</span> <span class="token string">'Emp003'</span><span class="token punctuation">,</span> <span class="token string">'Emp004'</span><span class="token punctuation">,</span> <span class="token string">'Emp005'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Doe'</span><span class="token punctuation">,</span> <span class="token string">'William'</span><span class="token punctuation">,</span> <span class="token string">'Spark'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Occupation'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Chemist'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Statistician'</span><span class="token punctuation">,</span>
                   <span class="token string">'Statistician'</span><span class="token punctuation">,</span> <span class="token string">'Programmer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Date Of Join'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2018-01-25'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-01-26'</span><span class="token punctuation">,</span> <span class="token string">'2018-02-26'</span><span class="token punctuation">,</span>
                     <span class="token string">'2018-03-16'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n --------- Before Index ----------- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n --------- Multiple Indexing ----------- \n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>employees<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Occupation'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>                 Date Of Join EmpCode     Name
Occupation   Age
Chemist      23    2018-01-25  Emp001     John
Statistician 24    2018-01-26  Emp002      Doe
             34    2018-01-26  Emp003  William
             29    2018-02-26  Emp004    Spark
Programmer   40    2018-03-16  Emp005     Mark</code></pre><h2 id="69确定-DataFrame-的周期索引和列"><a href="#69确定-DataFrame-的周期索引和列" class="headerlink" title="69确定 DataFrame 的周期索引和列"></a>69确定 DataFrame 的周期索引和列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"India"</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"Australia"</span><span class="token punctuation">,</span>
          <span class="token string">"Japan"</span><span class="token punctuation">,</span> <span class="token string">"Germany"</span><span class="token punctuation">,</span> <span class="token string">"France"</span><span class="token punctuation">]</span>

pidx <span class="token operator">=</span> pd<span class="token punctuation">.</span>period_range<span class="token punctuation">(</span><span class="token string">'2015-01-01'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>values<span class="token punctuation">,</span> index<span class="token operator">=</span>pidx<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Country'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>              Country
2015-01-01      India
2015-01-02     Canada
2015-01-03  Australia
2015-01-04      Japan
2015-01-05    Germany
2015-01-06     France</code></pre><h2 id="70导入-CSV-指定特定索引"><a href="#70导入-CSV-指定特定索引" class="headerlink" title="70导入 CSV 指定特定索引"></a>70导入 CSV 指定特定索引</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'test.csv'</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">"DateTime"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>             Wheat    Rice     Oil
DateTime
10/10/2016  10.500  12.500  16.500
10/11/2016  11.250  12.750  17.150
10/12/2016  10.000  13.150  15.500
10/13/2016  12.000  14.500  16.100
10/14/2016  13.000  14.825  15.600
10/15/2016  13.075  15.465  15.315
10/16/2016  13.650  16.105  15.030
10/17/2016  14.225  16.745  14.745
10/18/2016  14.800  17.385  14.460
10/19/2016  15.375  18.025  14.175</code></pre><h2 id="71将-DataFrame-写入-csv"><a href="#71将-DataFrame-写入-csv" class="headerlink" title="71将 DataFrame 写入 csv"></a>71将 DataFrame 写入 csv</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'DateOfBirth'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1986-11-11'</span><span class="token punctuation">,</span> <span class="token string">'1999-05-12'</span><span class="token punctuation">,</span> <span class="token string">'1976-01-01'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1986-06-01'</span><span class="token punctuation">,</span> <span class="token string">'1983-06-04'</span><span class="token punctuation">,</span> <span class="token string">'1990-03-07'</span><span class="token punctuation">,</span>
                                   <span class="token string">'1999-07-09'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token string">'State'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'NY'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'FL'</span><span class="token punctuation">,</span> <span class="token string">'AL'</span><span class="token punctuation">,</span> <span class="token string">'AK'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">,</span> <span class="token string">'TX'</span><span class="token punctuation">]</span>
                   <span class="token punctuation">}</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Pane'</span><span class="token punctuation">,</span> <span class="token string">'Aaron'</span><span class="token punctuation">,</span> <span class="token string">'Penelope'</span><span class="token punctuation">,</span> <span class="token string">'Frane'</span><span class="token punctuation">,</span>
                         <span class="token string">'Christina'</span><span class="token punctuation">,</span> <span class="token string">'Cornelia'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'test.csv'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>检查本地文件</code></pre><h2 id="72使用-Pandas-读取-csv-文件的特定列"><a href="#72使用-Pandas-读取-csv-文件的特定列" class="headerlink" title="72使用 Pandas 读取 csv 文件的特定列"></a>72使用 Pandas 读取 csv 文件的特定列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"test.csv"</span><span class="token punctuation">,</span> usecols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Wheat'</span><span class="token punctuation">,</span><span class="token string">'Oil'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="73Pandas-获取-CSV-列的列表"><a href="#73Pandas-获取-CSV-列的列表" class="headerlink" title="73Pandas 获取 CSV 列的列表"></a>73Pandas 获取 CSV 列的列表</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

cols <span class="token operator">=</span> list<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"test.csv"</span><span class="token punctuation">,</span> nrows <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cols<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>['DateTime', 'Wheat', 'Rice', 'Oil']</code></pre><h2 id="74找到列值最大的行"><a href="#74找到列值最大的行" class="headerlink" title="74找到列值最大的行"></a>74找到列值最大的行</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>Apple     55
Orange    15
Banana     8
Pear      12
Name: Basket3, dtype: int64</code></pre><h2 id="75使用查询方法进行复杂条件选择"><a href="#75使用查询方法进行复杂条件选择" class="headerlink" title="75使用查询方法进行复杂条件选择"></a>75使用查询方法进行复杂条件选择</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n ----------- Filter data using query method ------------- \n"</span><span class="token punctuation">)</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span>df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">'Apple > 50 &amp; Orange &lt;= 15 &amp; Banana &lt; 15 &amp; Pear == 12'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>         Apple  Orange  Banana  Pear
Basket1     10      20      30    40
Basket2      7      14      21    28
Basket3     55      15       8    12

 ----------- Filter data using query method -------------

         Apple  Orange  Banana  Pear
Basket3     55      15       8    12</code></pre><h2 id="76检查-Pandas-中是否存在列"><a href="#76检查-Pandas-中是否存在列" class="headerlink" title="76检查 Pandas 中是否存在列"></a>76检查 Pandas 中是否存在列</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token string">'Apple'</span> <span class="token keyword">in</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Yes"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No"</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> set<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span><span class="token string">'Orange'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>issubset<span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Yes"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="77为特定列从-DataFrame-中查找-n-smallest-和-n-largest-值"><a href="#77为特定列从-DataFrame-中查找-n-smallest-和-n-largest-值" class="headerlink" title="77为特定列从 DataFrame 中查找 n-smallest 和 n-largest 值"></a>77为特定列从 DataFrame 中查找 n-smallest 和 n-largest 值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- nsmallest -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>nsmallest<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- nlargest -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>nlargest<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------- nsmallest -----------

         Apple  Orange  Banana  Pear
Basket6      5       4       9     2
Basket2      7      14      21    28

----------- nlargest -----------

         Apple  Orange  Banana  Pear
Basket3     55      15       8    12
Basket4     15      14       1     8</code></pre><h2 id="78从-DataFrame-中查找所有列的最小值和最大值"><a href="#78从-DataFrame-中查找所有列的最小值和最大值" class="headerlink" title="78从 DataFrame 中查找所有列的最小值和最大值"></a>78从 DataFrame 中查找所有列的最小值和最大值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Minimum -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Maximum -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------- Minimum -----------

Apple     5
Orange    1
Banana    1
Pear      2
dtype: int64

----------- Maximum -----------

Apple     55
Orange    20
Banana    30
Pear      40
dtype: int64</code></pre><h2 id="79在-DataFrame-中找到最小值和最大值所在的索引位置"><a href="#79在-DataFrame-中找到最小值和最大值所在的索引位置" class="headerlink" title="79在 DataFrame 中找到最小值和最大值所在的索引位置"></a>79在 DataFrame 中找到最小值和最大值所在的索引位置</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Minimum -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>idxmin<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Maximum -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------- Minimum -----------

Apple     Basket6
Orange    Basket5
Banana    Basket4
Pear      Basket6
dtype: object

----------- Maximum -----------

Apple     Basket3
Orange    Basket1
Banana    Basket1
Pear      Basket1
dtype: object</code></pre><h2 id="80计算-DataFrame-Columns-的累积乘积和累积总和"><a href="#80计算-DataFrame-Columns-的累积乘积和累积总和" class="headerlink" title="80计算 DataFrame Columns 的累积乘积和累积总和"></a>80计算 DataFrame Columns 的累积乘积和累积总和</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Cumulative Product -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cumprod<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Cumulative Sum -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------- Cumulative Product -----------

           Apple  Orange  Banana     Pear
Basket1       10      20      30       40
Basket2       70     280     630     1120
Basket3     3850    4200    5040    13440
Basket4    57750   58800    5040   107520
Basket5   404250   58800    5040   860160
Basket6  2021250  235200   45360  1720320

----------- Cumulative Sum -----------

         Apple  Orange  Banana  Pear
Basket1     10      20      30    40
Basket2     17      34      51    68
Basket3     72      49      59    80
Basket4     87      63      60    88
Basket5     94      64      61    96
Basket6     99      68      70    98</code></pre><h2 id="81汇总统计"><a href="#81汇总统计" class="headerlink" title="81汇总统计"></a>81汇总统计</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Describe DataFrame -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Describe Column -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------- Describe DataFrame -----------

           Apple     Orange     Banana       Pear
count   6.000000   6.000000   6.000000   6.000000
mean   16.500000  11.333333  11.666667  16.333333
std    19.180719   7.257180  11.587349  14.555640
min     5.000000   1.000000   1.000000   2.000000
25%     7.000000   6.500000   2.750000   8.000000
50%     8.500000  14.000000   8.500000  10.000000
75%    13.750000  14.750000  18.000000  24.000000
max    55.000000  20.000000  30.000000  40.000000

----------- Describe Column -----------

           Apple
count   6.000000
mean   16.500000
std    19.180719
min     5.000000
25%     7.000000
50%     8.500000
75%    13.750000
max    55.000000</code></pre><h2 id="82查找-DataFrame-的均值、中值和众数"><a href="#82查找-DataFrame-的均值、中值和众数" class="headerlink" title="82查找 DataFrame 的均值、中值和众数"></a>82查找 DataFrame 的均值、中值和众数</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Calculate Mean -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Calculate Median -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Calculate Mode -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------- Calculate Mean -----------

Apple     16.500000
Orange    11.333333
Banana    11.666667
Pear      16.333333
dtype: float64

----------- Calculate Median -----------

Apple      8.5
Orange    14.0
Banana     8.5
Pear      10.0
dtype: float64

----------- Calculate Mode -----------

   Apple  Orange  Banana  Pear
0      7      14       1     8</code></pre><h2 id="83测量-DataFrame-列的方差和标准偏差"><a href="#83测量-DataFrame-列的方差和标准偏差" class="headerlink" title="83测量 DataFrame 列的方差和标准偏差"></a>83测量 DataFrame 列的方差和标准偏差</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Calculate Mean -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Calculate Median -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Calculate Mode -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------- Measure Variance -----------

Apple     367.900000
Orange     52.666667
Banana    134.266667
Pear      211.866667
dtype: float64

----------- Standard Deviation -----------

Apple     19.180719
Orange     7.257180
Banana    11.587349
Pear      14.555640
dtype: float64</code></pre><h2 id="84计算-DataFrame-列之间的协方差"><a href="#84计算-DataFrame-列之间的协方差" class="headerlink" title="84计算 DataFrame 列之间的协方差"></a>84计算 DataFrame 列之间的协方差</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Calculating Covariance -----------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>cov<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----------- Between 2 columns -----------\n"</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># Covariance of Apple vs Orange</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>Apple<span class="token punctuation">.</span>cov<span class="token punctuation">(</span>df<span class="token punctuation">.</span>Orange<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>----------- Calculating Covariance -----------

        Apple     Orange      Banana        Pear
Apple   367.9  47.600000  -40.200000  -35.000000
Orange   47.6  52.666667   54.333333   77.866667
Banana  -40.2  54.333333  134.266667  154.933333
Pear    -35.0  77.866667  154.933333  211.866667

----------- Between 2 columns -----------

47.60000000000001</code></pre><h2 id="85计算-Pandas-中两个-DataFrame-对象之间的相关性"><a href="#85计算-Pandas-中两个-DataFrame-对象之间的相关性" class="headerlink" title="85计算 Pandas 中两个 DataFrame 对象之间的相关性"></a>85计算 Pandas 中两个 DataFrame 对象之间的相关性</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ Calculating Correlation of one DataFrame Columns -----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n----- Calculating correlation between two DataFrame -------\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df2<span class="token punctuation">.</span>corrwith<span class="token punctuation">(</span>other<span class="token operator">=</span>df1<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------ Calculating Correlation of one DataFrame Columns -----

           Apple    Orange    Banana      Pear
Apple   1.000000  0.341959 -0.180874 -0.125364
Orange  0.341959  1.000000  0.646122  0.737144
Banana -0.180874  0.646122  1.000000  0.918606
Pear   -0.125364  0.737144  0.918606  1.000000

----- Calculating correlation between two DataFrame -------

Apple     0.678775
Orange    0.354993
Banana    0.920872
Pear      0.076919
dtype: float64</code></pre><h2 id="86计算-DataFrame-列的每个单元格的百分比变化"><a href="#86计算-DataFrame-列的每个单元格的百分比变化" class="headerlink" title="86计算 DataFrame 列的每个单元格的百分比变化"></a>86计算 DataFrame 列的每个单元格的百分比变化</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ Percent change at each cell of a Column -----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ Percent change at each cell of a DataFrame -----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------ Percent change at each cell of a Column -----

            Apple
Basket1       NaN
Basket2 -0.300000
Basket3  6.857143

------ Percent change at each cell of a DataFrame -----

            Apple    Orange    Banana      Pear
Basket1       NaN       NaN       NaN       NaN
Basket2 -0.300000 -0.300000 -0.300000 -0.300000
Basket3  6.857143  0.071429 -0.619048 -0.571429
Basket4 -0.727273 -0.066667 -0.875000 -0.333333
Basket5 -0.533333 -0.928571  0.000000  0.000000</code></pre><h2 id="87在-Pandas-中向前和向后填充-DataFrame-列的缺失值"><a href="#87在-Pandas-中向前和向后填充-DataFrame-列的缺失值" class="headerlink" title="87在 Pandas 中向前和向后填充 DataFrame 列的缺失值"></a>87在 Pandas 中向前和向后填充 DataFrame 列的缺失值</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ DataFrame with NaN -----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ DataFrame with Forward Filling -----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>ffill<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ DataFrame with Forward Filling -----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>bfill<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------ DataFrame with NaN -----

         Apple  Orange  Banana  Pear
Basket1   10.0    30.0    40.0   NaN
Basket2    NaN     NaN     NaN   NaN
Basket3   15.0     8.0    12.0   NaN
Basket4   15.0    14.0     1.0   8.0
Basket5    7.0     8.0     NaN   NaN
Basket6    5.0     4.0     1.0   NaN

------ DataFrame with Forward Filling -----

         Apple  Orange  Banana  Pear
Basket1   10.0    30.0    40.0   NaN
Basket2   10.0    30.0    40.0   NaN
Basket3   15.0     8.0    12.0   NaN
Basket4   15.0    14.0     1.0   8.0
Basket5    7.0     8.0     1.0   8.0
Basket6    5.0     4.0     1.0   8.0

------ DataFrame with Forward Filling -----

         Apple  Orange  Banana  Pear
Basket1   10.0    30.0    40.0   8.0
Basket2   15.0     8.0    12.0   8.0
Basket3   15.0     8.0    12.0   8.0
Basket4   15.0    14.0     1.0   8.0
Basket5    7.0     8.0     1.0   NaN
Basket6    5.0     4.0     1.0   NaN</code></pre><h2 id="88在-Pandas-中使用非分层索引使用-Stacking"><a href="#88在-Pandas-中使用非分层索引使用-Stacking" class="headerlink" title="88在 Pandas 中使用非分层索引使用 Stacking"></a>88在 Pandas 中使用非分层索引使用 Stacking</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ DataFrame-----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ Stacking DataFrame -----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>stack<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------ DataFrame-----

         Apple  Orange  Banana  Pear
Basket1   10.0    30.0    40.0   NaN
Basket2    NaN     NaN     NaN   NaN
Basket3   15.0     8.0    12.0   NaN
Basket4   15.0    14.0     1.0   8.0
Basket5    7.0     8.0     NaN   NaN
Basket6    5.0     4.0     1.0   NaN

------ Stacking DataFrame -----

Basket1  Apple     10.0
         Orange    30.0
         Banana    40.0
Basket3  Apple     15.0
         Orange     8.0
         Banana    12.0
Basket4  Apple     15.0
         Orange    14.0
         Banana     1.0
         Pear       8.0
Basket5  Apple      7.0
         Orange     8.0
Basket6  Apple      5.0
         Orange     4.0
         Banana     1.0
dtype: float64</code></pre><h2 id="89使用分层索引对-Pandas-进行拆分"><a href="#89使用分层索引对-Pandas-进行拆分" class="headerlink" title="89使用分层索引对 Pandas 进行拆分"></a>89使用分层索引对 Pandas 进行拆分</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Apple'</span><span class="token punctuation">,</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> <span class="token string">'Banana'</span><span class="token punctuation">,</span> <span class="token string">'Pear'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Basket1'</span><span class="token punctuation">,</span> <span class="token string">'Basket2'</span><span class="token punctuation">,</span> <span class="token string">'Basket3'</span><span class="token punctuation">,</span> <span class="token string">'Basket4'</span><span class="token punctuation">,</span>
                         <span class="token string">'Basket5'</span><span class="token punctuation">,</span> <span class="token string">'Basket6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ DataFrame-----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n------ Unstacking DataFrame -----\n"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Output:</p>
<pre><code>------ DataFrame-----

         Apple  Orange  Banana  Pear
Basket1   10.0    30.0    40.0   NaN
Basket2    NaN     NaN     NaN   NaN
Basket3   15.0     8.0    12.0   NaN
Basket4   15.0    14.0     1.0   8.0
Basket5    7.0     8.0     NaN   NaN
Basket6    5.0     4.0     1.0   NaN

------ Unstacking DataFrame -----

Apple   Basket1    10.0
        Basket2     NaN
        Basket3    15.0
        Basket4    15.0
        Basket5     7.0
        Basket6     5.0
Orange  Basket1    30.0
        Basket2     NaN
        Basket3     8.0
        Basket4    14.0
        Basket5     8.0
        Basket6     4.0
Banana  Basket1    40.0
        Basket2     NaN
        Basket3    12.0
        Basket4     1.0
        Basket5     NaN
        Basket6     1.0
Pear    Basket1     NaN
        Basket2     NaN
        Basket3     NaN
        Basket4     8.0
        Basket5     NaN
        Basket6     NaN
dtype: float64</code></pre><h2 id="90Pandas-获取-HTML-页面上-table-数据"><a href="#90Pandas-获取-HTML-页面上-table-数据" class="headerlink" title="90Pandas 获取 HTML 页面上 table 数据"></a>90Pandas 获取 HTML 页面上 table 数据</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://jackhcc.github.io" rel="external nofollow noreferrer">杰克成</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://jackhcc.github.io/posts/blog-python05.html">https://jackhcc.github.io/posts/blog-python05.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://jackhcc.github.io" target="_blank">杰克成</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Pandas/">
                                    <span class="chip bg-color">Pandas</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/reward/aliqr.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/reward/wxqr.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '3821a0bbb773038a51fc',
        clientSecret: '4b30b507d67ec5497ec0e77f43f80cb3e0d7dd3a',
        repo: 'JackHCC.github.io',
        owner: 'JackHCC',
        admin: "JackHCC",
        id: '2020-03-05T21-00-10',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/posts/blog-python06.html">
                    <div class="card-image">
                        
                        
                        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/featureimages/13.jpg" class="responsive-img" alt="Python-GUI图像化开发PyQt5">
                        
                        <span class="card-title">Python-GUI图像化开发PyQt5</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            PyQt5库相关使用指南
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-03-06
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Python/" class="post-category">
                                    Python
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/PyQt/">
                        <span class="chip bg-color">PyQt</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/blog-python04.html">
                    <div class="card-image">
                        
                        
                        <img src="/images/loading.gif" data-original="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/medias/featureimages/11.jpg" class="responsive-img" alt="Python-Numpy详解">
                        
                        <span class="card-title">Python-Numpy详解</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Numpy库相关计算与使用指南
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-03-04
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Python/" class="post-category">
                                    Python
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Numpy/">
                        <span class="chip bg-color">Numpy</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('4'),
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <footer class="page-footer bg-color">
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2020</span>
            <a href="https://jackhcc.github.io" target="_blank">杰克成</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">3591.2k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2020";
                    var startMonth = "2";
                    var startDate = "27";
                    var startHour = "6";
                    var startMinute = "30";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/JackHCC" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:jackcc0701@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>



    <a href="https://www.facebook.com/profile.php?id=100046343443643" class="tooltipped" target="_blank" data-tooltip="关注我的Facebook: https://www.facebook.com/profile.php?id=100046343443643" data-position="top" data-delay="50">
        <i class="fab fa-facebook-f"></i>
    </a>



    <a href="https://twitter.com/JackChe66021834" class="tooltipped" target="_blank" data-tooltip="关注我的Twitter: https://twitter.com/JackChe66021834" data-position="top" data-delay="50">
        <i class="fab fa-twitter"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2508074836" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2508074836" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>



    <a href="https://weibo.com/u/6885584679" class="tooltipped" target="_blank" data-tooltip="关注我的微博: https://weibo.com/u/6885584679" data-position="top" data-delay="50">
        <i class="fab fa-weibo"></i>
    </a>



    <a href="https://www.zhihu.com/people/8f8482f01f0d6a04e844efe32e0f0710" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/8f8482f01f0d6a04e844efe32e0f0710" data-position="top" data-delay="50">
        <i class="fab fa-zhihu1">知</i>
    </a>



</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/js/matery.js"></script>

    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas>
    <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
    <script type="text/javascript" src="/js/fireworks.js"></script>

    <script type="text/javascript">
        //只在桌面版网页启用特效
        var windowWidth = $(window).width();
        if (windowWidth > 768) {
            document.write('<script type="text/javascript" src="/js/sakura.js"><\/script>'); }
    </script>

    <!-- weather -->
	<script type="text/javascript">
	WIDGET = {FID: 'TToslpmkVO'}
	</script>
	<script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"></script>


    <!-- Global site tag (gtag.js) - Google Analytics -->


    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

    
    
    <script async src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/others/busuanzi.pure.mini.js"></script>
    

    
        <script src="//code.tidio.co/kqhlkxviiccyoa0czpfpu4ijuey9hfre.js"></script>
        <script> 
            $(document).ready(function () {
                setInterval(change_Tidio, 50);  
                function change_Tidio() { 
                    var tidio=$("#tidio-chat iframe");
                    if(tidio.css("display")=="block"&& $(window).width()>977 ){
                        document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" &&$(window).width()>977)>0? "-40px" : ($("div.toc-title").length&&$(window).width()>977)>0?"85px":"20px";   
                        document.getElementById("tidio-chat-iframe").style.right="-15px";   
                        document.getElementById("tidio-chat-iframe").style.height=parseInt(tidio.css("height"))>=520?"520px":tidio.css("height");
                        document.getElementById("tidio-chat-iframe").style.zIndex="997";
                    } 
                    else if(tidio.css("display")=="block"&&$(window).width()>601 &&$(window).width()<992 ){
                        document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" && 601< $(window).width()<992)>0? "-40px":"20px" ;   
                        document.getElementById("tidio-chat-iframe").style.right="-15px"; 
                        document.getElementById("tidio-chat-iframe").style.zIndex="997";
                    }
                    else if(tidio.css("display")=="block"&&$(window).width()<601 && parseInt(tidio.css("height"))<230){
                        document.getElementById("tidio-chat-iframe").style.bottom= ($("div#backTop.top-scroll").css("display")=="none" && $(window).width()<601)>0? "-10px":"45px" ;   
                        document.getElementById("tidio-chat-iframe").style.zIndex="997";
                    }
                    if( tidio.css("display")=="block"&&$(window).width()<601 && parseInt(tidio.css("height"))>=230){
                        document.getElementById("tidio-chat-iframe").style.zIndex="998";
                    }
                } 
            }); 
        </script>
    

    

    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/background/canvas-nest.js"></script>
    

    

    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/background/ribbon-dynamic.js" async="async"></script>
    
    
    
    <script src="https://cdn.jsdelivr.net/gh/JackHCC/JackHCC.github.io/libs/instantpage/instantpage.js" type="module"></script>
    

        <script src="//cdn.jsdelivr.net/npm/js-base64/base64.min.js"></script>
        <script>
        $('a').each(function() {
          const $this = $(this);
          const href = $this.attr('href');
          if (href && href.match('^((http|https|thunder|qqdl|ed2k|Flashget|qbrowser|ftp|rtsp|mms)://)')) {
            const strs = href.split('/');
            if (strs.length >= 3) {
                const host = strs[2];
                if (host !== 'your_domain' || window.location.host) {
                    $this.attr('href', '/go.html?u='+Base64.encode(href)+'').attr('rel', 'external nofollow noopener noreferrer');
                    if (true) {
                        $this.attr('target', '_blank');
                    }
                }
            }
          }
        });
        </script><script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)t=c[r],0<=(n=t.getBoundingClientRect()).bottom&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this);</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script></body>

</html>

